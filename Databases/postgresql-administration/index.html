
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Practical technical guides on Linux, DNS, Git, databases, and development">
      
      
        <meta name="author" content="Ryan Robson">
      
      
        <link rel="canonical" href="https://ringo380.github.io/guides/Databases/postgresql-administration/">
      
      
        <link rel="prev" href="../postgresql-fundamentals/">
      
      
        <link rel="next" href="../postgresql-advanced/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>PostgreSQL Administration - The Runbook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/interactive.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/lightbox.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-56L2QXTFGR"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-56L2QXTFGR",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-56L2QXTFGR",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
  
<meta property="og:type" content="website" />
<meta property="og:title" content="PostgreSQL Administration - The Runbook" />
<meta property="og:description" content="Practical technical guides on Linux, DNS, Git, databases, and development" />
<meta property="og:image" content="https://ringo380.github.io/guides/assets/images/social/Databases/postgresql-administration.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:url" content="https://ringo380.github.io/guides/Databases/postgresql-administration/" />
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content="PostgreSQL Administration - The Runbook" />
<meta property="twitter:description" content="Practical technical guides on Linux, DNS, Git, databases, and development" />
<meta property="twitter:image" content="https://ringo380.github.io/guides/assets/images/social/Databases/postgresql-administration.png" />
</head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#postgresql-administration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="The Runbook" class="md-header__button md-logo" aria-label="The Runbook" data-md-component="logo">
      
  <img src="../../assets/images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Runbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PostgreSQL Administration
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ringo380/guides" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ringo380/guides
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Linux%20Essentials/" class="md-tabs__link">
          
  
  
    
  
  Linux Essentials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../DNS%20Administration/" class="md-tabs__link">
          
  
  
    
  
  DNS Administration

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Git/" class="md-tabs__link">
          
  
  
    
  
  Git

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Databases

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Dev%20Zero/Perl/" class="md-tabs__link">
          
  
  
    
  
  Dev Zero

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="The Runbook" class="md-nav__button md-logo" aria-label="The Runbook" data-md-component="logo">
      
  <img src="../../assets/images/logo.svg" alt="logo">

    </a>
    The Runbook
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ringo380/guides" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ringo380/guides
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Linux%20Essentials/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Linux Essentials
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linux Essentials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/shell-basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Shell Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/streams-and-redirection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streams and Redirection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/text-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Text Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/finding-files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Finding Files
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/file-permissions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File Permissions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/job-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Job Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/scripting-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scripting Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/disk-and-filesystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Disk and Filesystem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Networking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/system-information/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Information
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/archiving-and-compression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Archiving and Compression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/best-practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Best Practices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../DNS%20Administration/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    DNS Administration
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    DNS Administration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dns-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/zone-files-and-records/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zone Files and Records
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dns-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Tools and Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/bind/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BIND
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/nsd-and-unbound/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NSD and Unbound
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/powerdns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PowerDNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dnssec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNSSEC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dns-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Architecture and Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Git/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Git
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Git
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/three-trees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Three Trees
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/commits-and-history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Commits and History
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/branches-and-merging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Branches and Merging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/remote-repositories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Remote Repositories
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/rewriting-history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rewriting History
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/stashing-and-worktree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stashing and the Worktree
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/configuring-git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring Git
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/object-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Object Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/refs-reflog-dag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Refs, the Reflog, and the DAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/transfer-protocols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transfer Protocols
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/collaboration-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collaboration Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/platforms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Platforms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/hooks-and-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hooks and Automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/monorepos-and-scaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monorepos and Scaling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/troubleshooting-and-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting and Recovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Databases
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Databases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql-essentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL Essentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Design & Modeling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-installation-and-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Installation & Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-administration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Administration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Performance & Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-replication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Replication & HA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Administration
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Administration
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#roles-and-privileges" class="md-nav__link">
    <span class="md-ellipsis">
      
        Roles and Privileges
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Roles and Privileges">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-roles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Roles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-and-revoke" class="md-nav__link">
    <span class="md-ellipsis">
      
        GRANT and REVOKE
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role-membership-and-inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Role Membership and Inheritance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#row-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Row-Level Security
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablespace-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tablespace Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tablespace Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-tablespaces" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Tablespaces
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-tablespaces" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using Tablespaces
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-tablespace-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monitoring Tablespace Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vacuum-and-analyze" class="md-nav__link">
    <span class="md-ellipsis">
      
        VACUUM and ANALYZE
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VACUUM and ANALYZE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-vacuum-exists" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why VACUUM Exists
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vacuum-vs-vacuum-full" class="md-nav__link">
    <span class="md-ellipsis">
      
        VACUUM vs VACUUM FULL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyze" class="md-nav__link">
    <span class="md-ellipsis">
      
        ANALYZE
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autovacuum-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Autovacuum Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-dead-tuples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monitoring Dead Tuples
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pg_stat_-monitoring-views" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_* Monitoring Views
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pg_stat_* Monitoring Views">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pg_stat_activity" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_activity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_stat_user_tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_user_tables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_stat_user_indexes" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_user_indexes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_stat_bgwriter" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_bgwriter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_stat_replication" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_replication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extensions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extensions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extensions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing Extensions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_stat_statements" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_statements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pgcrypto" class="md-nav__link">
    <span class="md-ellipsis">
      
        pgcrypto
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgis" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostGIS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_trgm" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_trgm
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wal-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        WAL Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WAL Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-wal-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How WAL Works
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wal_level-settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        wal_level Settings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wal-archiving" class="md-nav__link">
    <span class="md-ellipsis">
      
        WAL Archiving
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wal-directory-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        WAL Directory Management
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wal-and-replication-slots" class="md-nav__link">
    <span class="md-ellipsis">
      
        WAL and Replication Slots
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#putting-it-together-diagnosing-bloat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Putting It Together: Diagnosing Bloat
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Further Reading
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Advanced Features
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nosql-concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NoSQL Concepts & Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mongodb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MongoDB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backup-and-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backup & Recovery Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaling-and-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scaling & Architecture Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../innodb-recovery-pdrt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    InnoDB Recovery with PDRT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Dev Zero
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Dev Zero
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Dev%20Zero/Perl/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Perl
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Perl
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/perl_dev0_introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/scalars-strings-numbers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scalars, Strings, and Numbers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/arrays-hashes-lists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Arrays, Hashes, and Lists
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/control-flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Control Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/regular-expressions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regular Expressions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/subroutines-references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Subroutines and References
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/file-io-and-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File I/O and System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/modules-and-cpan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modules and CPAN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/object-oriented-perl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Object-Oriented Perl
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/error-handling-debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Handling and Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/text-processing-oneliners/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Text Processing and One-Liners
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/networking-daemons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Networking and Daemons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/web-frameworks-apis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web Frameworks and APIs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/perl_developer_roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Developer Roadmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#roles-and-privileges" class="md-nav__link">
    <span class="md-ellipsis">
      
        Roles and Privileges
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Roles and Privileges">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-roles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Roles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grant-and-revoke" class="md-nav__link">
    <span class="md-ellipsis">
      
        GRANT and REVOKE
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#role-membership-and-inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Role Membership and Inheritance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#row-level-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        Row-Level Security
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablespace-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tablespace Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tablespace Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-tablespaces" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating Tablespaces
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-tablespaces" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using Tablespaces
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-tablespace-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monitoring Tablespace Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vacuum-and-analyze" class="md-nav__link">
    <span class="md-ellipsis">
      
        VACUUM and ANALYZE
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VACUUM and ANALYZE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-vacuum-exists" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why VACUUM Exists
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vacuum-vs-vacuum-full" class="md-nav__link">
    <span class="md-ellipsis">
      
        VACUUM vs VACUUM FULL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyze" class="md-nav__link">
    <span class="md-ellipsis">
      
        ANALYZE
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autovacuum-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Autovacuum Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-dead-tuples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monitoring Dead Tuples
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pg_stat_-monitoring-views" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_* Monitoring Views
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pg_stat_* Monitoring Views">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pg_stat_activity" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_activity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_stat_user_tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_user_tables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_stat_user_indexes" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_user_indexes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_stat_bgwriter" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_bgwriter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_stat_replication" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_replication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extensions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extensions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extensions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installing-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing Extensions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_stat_statements" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_stat_statements
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pgcrypto" class="md-nav__link">
    <span class="md-ellipsis">
      
        pgcrypto
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgis" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostGIS
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pg_trgm" class="md-nav__link">
    <span class="md-ellipsis">
      
        pg_trgm
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wal-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        WAL Management
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WAL Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-wal-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        How WAL Works
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wal_level-settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        wal_level Settings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wal-archiving" class="md-nav__link">
    <span class="md-ellipsis">
      
        WAL Archiving
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wal-directory-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        WAL Directory Management
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wal-and-replication-slots" class="md-nav__link">
    <span class="md-ellipsis">
      
        WAL and Replication Slots
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#putting-it-together-diagnosing-bloat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Putting It Together: Diagnosing Bloat
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Further Reading
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/ringo380/guides/edit/main/Databases/postgresql-administration.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="postgresql-administration">PostgreSQL Administration<a class="headerlink" href="#postgresql-administration" title="Permanent link">&para;</a></h1>
<p>PostgreSQL gives you more control over your database than almost any other RDBMS - but that control comes with responsibilities. You need to understand how roles and privileges work, how to manage the storage layer with tablespaces, why dead tuples accumulate and how VACUUM reclaims them, what the <code>pg_stat_*</code> views are telling you, which extensions are worth installing, and how WAL keeps your data safe through crashes. This guide covers the daily administration tasks that keep a PostgreSQL instance running well in production.</p>
<hr />
<h2 id="roles-and-privileges">Roles and Privileges<a class="headerlink" href="#roles-and-privileges" title="Permanent link">&para;</a></h2>
<p>PostgreSQL has a single concept for both users and groups: the <strong>role</strong>. A role can own database objects, hold privileges, and contain other roles as members. There is no separate <code>CREATE USER</code> and <code>CREATE GROUP</code> - those commands exist for convenience, but they all create roles under the hood.</p>
<h3 id="creating-roles">Creating Roles<a class="headerlink" href="#creating-roles" title="Permanent link">&para;</a></h3>
<p>Use <code>CREATE ROLE</code> to define a new role:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1">-- A role that can log in (equivalent to CREATE USER)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">app_user</span><span class="w"> </span><span class="n">LOGIN</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">&#39;strong_password_here&#39;</span><span class="p">;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1">-- A role that cannot log in (used as a group)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">readonly</span><span class="w"> </span><span class="n">NOLOGIN</span><span class="p">;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1">-- A role with specific attributes</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">admin_user</span><span class="w"> </span><span class="n">LOGIN</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">&#39;another_password&#39;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">    </span><span class="k">CREATEDB</span><span class="w"> </span><span class="n">CREATEROLE</span><span class="w"> </span><span class="k">VALID</span><span class="w"> </span><span class="k">UNTIL</span><span class="w"> </span><span class="s1">&#39;2027-01-01&#39;</span><span class="p">;</span>
</span></code></pre></div>
<p>The key attributes you control at creation time:</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LOGIN</code> / <code>NOLOGIN</code></td>
<td>Whether the role can connect to the database</td>
</tr>
<tr>
<td><code>SUPERUSER</code></td>
<td>Bypasses all permission checks (use sparingly)</td>
</tr>
<tr>
<td><code>CREATEDB</code></td>
<td>Can create new databases</td>
</tr>
<tr>
<td><code>CREATEROLE</code></td>
<td>Can create, alter, and drop other roles</td>
</tr>
<tr>
<td><code>REPLICATION</code></td>
<td>Can initiate streaming replication</td>
</tr>
<tr>
<td><code>PASSWORD</code></td>
<td>Sets the authentication password</td>
</tr>
<tr>
<td><code>VALID UNTIL</code></td>
<td>Password expiration timestamp</td>
</tr>
<tr>
<td><code>CONNECTION LIMIT</code></td>
<td>Maximum concurrent connections for this role</td>
</tr>
</tbody>
</table>
<p><code>CREATE USER</code> is an alias for <code>CREATE ROLE ... LOGIN</code>. <code>CREATE GROUP</code> is an alias for <code>CREATE ROLE ... NOLOGIN</code>. Use whichever reads more clearly in context.</p>
<h3 id="grant-and-revoke">GRANT and REVOKE<a class="headerlink" href="#grant-and-revoke" title="Permanent link">&para;</a></h3>
<p>Privileges in PostgreSQL are granted at the database, schema, and object level. The <code>GRANT</code> and <code>REVOKE</code> statements control access:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1">-- Database-level: allow connecting</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">CONNECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">myapp</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_user</span><span class="p">;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1">-- Schema-level: allow using objects in the schema</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">USAGE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_user</span><span class="p">;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c1">-- Table-level: specific operations</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_user</span><span class="p">;</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">admin_user</span><span class="p">;</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="c1">-- All tables in a schema at once</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">readonly</span><span class="p">;</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="c1">-- Set default privileges for future tables</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">    </span><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">readonly</span><span class="p">;</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="c1">-- Revoke access</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="k">REVOKE</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">app_user</span><span class="p">;</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Default privileges only affect future objects</p>
<p><code>ALTER DEFAULT PRIVILEGES</code> applies to objects created after the statement runs. Existing tables are unaffected. When setting up a read-only role, you need both <code>GRANT SELECT ON ALL TABLES</code> for current tables and <code>ALTER DEFAULT PRIVILEGES</code> for tables created later.</p>
</div>
<h3 id="role-membership-and-inheritance">Role Membership and Inheritance<a class="headerlink" href="#role-membership-and-inheritance" title="Permanent link">&para;</a></h3>
<p>Roles can be members of other roles, forming a group structure. When a role <strong>inherits</strong> from another, it automatically gains that role's privileges:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">-- Create a group role</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">analysts</span><span class="w"> </span><span class="n">NOLOGIN</span><span class="p">;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">analysts</span><span class="p">;</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1">-- Add members</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="k">GRANT</span><span class="w"> </span><span class="n">analysts</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">alice</span><span class="p">;</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="k">GRANT</span><span class="w"> </span><span class="n">analysts</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">bob</span><span class="p">;</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c1">-- alice and bob now inherit SELECT on all public tables</span>
</span></code></pre></div>
<p>By default, member roles inherit privileges from their parent role. You can control this with <code>INHERIT</code> and <code>NOINHERIT</code>:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">-- This role must explicitly SET ROLE to gain privileges</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="n">NOLOGIN</span><span class="w"> </span><span class="n">NOINHERIT</span><span class="p">;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="k">GRANT</span><span class="w"> </span><span class="n">admin_role</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="k">operator</span><span class="p">;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c1">-- The user must switch role context to use admin_role privileges</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="k">SET</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">admin_role</span><span class="p">;</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c1">-- ... do admin work ...</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="k">RESET</span><span class="w"> </span><span class="k">ROLE</span><span class="p">;</span>
</span></code></pre></div>
<p><code>NOINHERIT</code> is useful when you want a user to consciously activate elevated privileges rather than having them always active - similar to <code>sudo</code> on Linux.</p>
<h3 id="row-level-security">Row-Level Security<a class="headerlink" href="#row-level-security" title="Permanent link">&para;</a></h3>
<p><strong>Row-level security</strong> (RLS) lets you control which rows a user can see or modify at the table level, not just which tables they can access. This is powerful for multi-tenant applications where all tenants share a table but should only see their own data.</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">-- Step 1: Enable RLS on the table</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="n">ENABLE</span><span class="w"> </span><span class="k">ROW</span><span class="w"> </span><span class="k">LEVEL</span><span class="w"> </span><span class="k">SECURITY</span><span class="p">;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1">-- Step 2: Create policies</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">POLICY</span><span class="w"> </span><span class="n">tenant_isolation</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">orders</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="p">(</span><span class="n">tenant_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current_setting</span><span class="p">(</span><span class="s1">&#39;app.current_tenant&#39;</span><span class="p">)::</span><span class="nb">int</span><span class="p">);</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="c1">-- Step 3: Users now only see rows matching the policy</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="c1">-- The application sets the tenant context per connection:</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="k">SET</span><span class="w"> </span><span class="n">app</span><span class="p">.</span><span class="n">current_tenant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;42&#39;</span><span class="p">;</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">orders</span><span class="p">;</span><span class="w">  </span><span class="c1">-- Only returns rows where tenant_id = 42</span>
</span></code></pre></div>
<p>You can create separate policies for different operations:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">-- Users can see their own data</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">POLICY</span><span class="w"> </span><span class="n">select_own</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">orders</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="k">FOR</span><span class="w"> </span><span class="k">SELECT</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="p">(</span><span class="n">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">current_user</span><span class="p">);</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="c1">-- Users can only insert rows attributed to themselves</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">POLICY</span><span class="w"> </span><span class="n">insert_own</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">orders</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="k">FOR</span><span class="w"> </span><span class="k">INSERT</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">    </span><span class="k">WITH</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">current_user</span><span class="p">);</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="c1">-- Users can update their own rows, but cannot change the user_id</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">POLICY</span><span class="w"> </span><span class="n">update_own</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">orders</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">    </span><span class="k">FOR</span><span class="w"> </span><span class="k">UPDATE</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="p">(</span><span class="n">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">current_user</span><span class="p">)</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">    </span><span class="k">WITH</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">current_user</span><span class="p">);</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Table owners bypass RLS by default</p>
<p>The table owner and superusers are not subject to row-level security policies. If you want the owner to also be restricted, run <code>ALTER TABLE orders FORCE ROW LEVEL SECURITY</code>. This is important for testing - you may not notice broken policies if you're testing as the table owner.</p>
</div>
<div class="interactive-quiz" data-config="{&quot;question&quot;: &quot;You create a role with NOINHERIT and grant it membership in an admin group. What happens when the role connects?&quot;, &quot;type&quot;: &quot;multiple-choice&quot;, &quot;options&quot;: [{&quot;text&quot;: &quot;The role automatically has all admin group privileges&quot;, &quot;feedback&quot;: &quot;With NOINHERIT, the role does not automatically receive the parent role&#39;s privileges. It must explicitly SET ROLE to activate them.&quot;}, {&quot;text&quot;: &quot;The connection is rejected because NOINHERIT roles cannot log in&quot;, &quot;feedback&quot;: &quot;NOINHERIT has nothing to do with login ability. LOGIN/NOLOGIN controls whether a role can connect. NOINHERIT controls whether inherited privileges are automatically active.&quot;}, {&quot;text&quot;: &quot;The role must use SET ROLE to activate the admin group&#39;s privileges&quot;, &quot;correct&quot;: true, &quot;feedback&quot;: &quot;Correct. NOINHERIT means the role&#39;s granted memberships are available but not automatically active. The user must explicitly SET ROLE admin_group to gain those privileges, then RESET ROLE when done. This is a deliberate security pattern.&quot;}, {&quot;text&quot;: &quot;The role has admin privileges only for SELECT statements&quot;, &quot;feedback&quot;: &quot;NOINHERIT is all-or-nothing for a given role membership. It does not filter by statement type. The role either has the full set of inherited privileges (after SET ROLE) or none of them.&quot;}]}"><noscript><p><strong>You create a role with NOINHERIT and grant it membership in an admin group. What happens when the role connects?</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="tablespace-management">Tablespace Management<a class="headerlink" href="#tablespace-management" title="Permanent link">&para;</a></h2>
<p>A <strong>tablespace</strong> defines a physical location on the filesystem where PostgreSQL stores data files. By default, PostgreSQL uses two tablespaces:</p>
<ul>
<li><strong><code>pg_default</code></strong> - stores user data (under <code>base/</code> in the data directory)</li>
<li><strong><code>pg_global</code></strong> - stores cluster-wide system catalogs (under <code>global/</code> in the data directory)</li>
</ul>
<h3 id="creating-tablespaces">Creating Tablespaces<a class="headerlink" href="#creating-tablespaces" title="Permanent link">&para;</a></h3>
<p>You can create additional tablespaces to place data on different storage devices - for example, putting frequently accessed indexes on fast SSDs while keeping large archival tables on slower, cheaper disks:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1">-- The directory must exist and be owned by the postgres OS user</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="c1">-- On the OS: mkdir -p /mnt/ssd/pgdata &amp;&amp; chown postgres:postgres /mnt/ssd/pgdata</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">fast_storage</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="k">OWNER</span><span class="w"> </span><span class="n">postgres</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;/mnt/ssd/pgdata&#39;</span><span class="p">;</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">archive_storage</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">    </span><span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;/mnt/hdd/pgdata&#39;</span><span class="p">;</span>
</span></code></pre></div>
<h3 id="using-tablespaces">Using Tablespaces<a class="headerlink" href="#using-tablespaces" title="Permanent link">&para;</a></h3>
<p>Assign tablespaces when creating objects or move existing objects:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1">-- Create a table in a specific tablespace</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">recent_events</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="n">bigserial</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="n">event_type</span><span class="w"> </span><span class="nb">text</span><span class="p">,</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="n">timestamptz</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">now</span><span class="p">()</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="p">)</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">fast_storage</span><span class="p">;</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="c1">-- Create an index in a specific tablespace</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_events_created</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">recent_events</span><span class="w"> </span><span class="p">(</span><span class="n">created_at</span><span class="p">)</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">fast_storage</span><span class="p">;</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="c1">-- Move an existing table to a different tablespace</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">old_logs</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">archive_storage</span><span class="p">;</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="c1">-- Set the default tablespace for a database</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">myapp</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">default_tablespace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;fast_storage&#39;</span><span class="p">;</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Moving tables locks them</p>
<p><code>ALTER TABLE ... SET TABLESPACE</code> acquires an <code>ACCESS EXCLUSIVE</code> lock. The table is completely unavailable during the move. For large tables, this can take a long time. Plan tablespace moves during maintenance windows, or use logical replication to migrate data with minimal downtime.</p>
</div>
<h3 id="monitoring-tablespace-usage">Monitoring Tablespace Usage<a class="headerlink" href="#monitoring-tablespace-usage" title="Permanent link">&para;</a></h3>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1">-- List all tablespaces with size</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">spcname</span><span class="p">,</span><span class="w"> </span><span class="n">pg_size_pretty</span><span class="p">(</span><span class="n">pg_tablespace_size</span><span class="p">(</span><span class="n">spcname</span><span class="p">))</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_tablespace</span><span class="p">;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="c1">-- See which tablespace each table uses</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">tablename</span><span class="p">,</span><span class="w"> </span><span class="n">tablespace</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_tables</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">schemaname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;public&#39;</span><span class="p">;</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="c1">-- NULL tablespace means pg_default</span>
</span></code></pre></div>
<hr />
<h2 id="vacuum-and-analyze">VACUUM and ANALYZE<a class="headerlink" href="#vacuum-and-analyze" title="Permanent link">&para;</a></h2>
<p>If there is one PostgreSQL administration concept you must understand, it is <strong>VACUUM</strong>. PostgreSQL's <strong>multi-version concurrency control</strong> (MVCC) system never overwrites data in place. When you update a row, PostgreSQL creates a new version and marks the old one as "dead." When you delete a row, PostgreSQL marks it as dead but does not remove it. These <strong>dead tuples</strong> accumulate over time and waste disk space, slow down sequential scans, and cause <strong>table bloat</strong>.</p>
<h3 id="why-vacuum-exists">Why VACUUM Exists<a class="headerlink" href="#why-vacuum-exists" title="Permanent link">&para;</a></h3>
<p>Consider what happens without VACUUM:</p>
<ol>
<li>You update 1 million rows in a table</li>
<li>PostgreSQL creates 1 million new row versions</li>
<li>The old 1 million versions are still on disk, marked as dead</li>
<li>Sequential scans now read 2 million row versions even though only 1 million are live</li>
<li>Indexes still point to both live and dead versions</li>
<li>The table has doubled in size on disk</li>
</ol>
<p>VACUUM reclaims the space occupied by dead tuples, making it available for reuse by future inserts and updates within the same table.</p>
<h3 id="vacuum-vs-vacuum-full">VACUUM vs VACUUM FULL<a class="headerlink" href="#vacuum-vs-vacuum-full" title="Permanent link">&para;</a></h3>
<p>PostgreSQL offers two flavors:</p>
<table>
<thead>
<tr>
<th></th>
<th><code>VACUUM</code></th>
<th><code>VACUUM FULL</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Locking</strong></td>
<td>Runs alongside reads and writes</td>
<td>Locks the table exclusively</td>
</tr>
<tr>
<td><strong>Space reclamation</strong></td>
<td>Marks dead tuple space as reusable within the table</td>
<td>Rewrites the entire table, releasing space to the OS</td>
</tr>
<tr>
<td><strong>Speed</strong></td>
<td>Fast, designed to run frequently</td>
<td>Slow, especially on large tables</td>
</tr>
<tr>
<td><strong>When to use</strong></td>
<td>Regular maintenance (autovacuum does this)</td>
<td>Only when a table has extreme bloat and you need to shrink the file on disk</td>
</tr>
<tr>
<td><strong>Downtime</strong></td>
<td>None</td>
<td>Table is unavailable for the duration</td>
</tr>
</tbody>
</table>
<p>In practice, you should almost never need <code>VACUUM FULL</code>. Regular <code>VACUUM</code> keeps dead tuple space recyclable. <code>VACUUM FULL</code> is a last resort for tables that grew extremely large due to a bulk operation and you need the disk space back.</p>
<h3 id="analyze">ANALYZE<a class="headerlink" href="#analyze" title="Permanent link">&para;</a></h3>
<p><code>ANALYZE</code> collects statistics about the distribution of data in a table's columns. The <strong>query planner</strong> uses these statistics to choose efficient execution plans - deciding whether to use an index scan, sequential scan, hash join, or merge join.</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">-- Analyze a specific table</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">ANALYZE</span><span class="w"> </span><span class="n">orders</span><span class="p">;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c1">-- Analyze specific columns</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="k">ANALYZE</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="p">(</span><span class="n">customer_id</span><span class="p">,</span><span class="w"> </span><span class="n">created_at</span><span class="p">);</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="c1">-- VACUUM and ANALYZE together</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="k">VACUUM</span><span class="w"> </span><span class="k">ANALYZE</span><span class="w"> </span><span class="n">orders</span><span class="p">;</span>
</span></code></pre></div>
<p>Stale statistics lead to bad query plans. If you load a large batch of data or significantly change the data distribution, running <code>ANALYZE</code> immediately afterward helps the planner make good decisions.</p>
<h3 id="autovacuum-configuration">Autovacuum Configuration<a class="headerlink" href="#autovacuum-configuration" title="Permanent link">&para;</a></h3>
<p>PostgreSQL runs <strong>autovacuum</strong> as a background process that automatically triggers <code>VACUUM</code> and <code>ANALYZE</code> when tables accumulate enough changes. The key configuration parameters in <code>postgresql.conf</code>:</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># Master switch (leave this on)</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="na">autovacuum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">on</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c1"># How often the autovacuum launcher checks for work (seconds)</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="na">autovacuum_naptime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">60</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="c1"># VACUUM triggers when dead tuples exceed:</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c1">#   autovacuum_vacuum_threshold + (autovacuum_vacuum_scale_factor * table rows)</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="na">autovacuum_vacuum_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">50</span><span class="w">        </span><span class="c1"># base number of dead tuples</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="na">autovacuum_vacuum_scale_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.2</span><span class="w">    </span><span class="c1"># fraction of table size</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="c1"># ANALYZE triggers when changed tuples exceed:</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="c1">#   autovacuum_analyze_threshold + (autovacuum_analyze_scale_factor * table rows)</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="na">autovacuum_analyze_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">50</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="na">autovacuum_analyze_scale_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0.1</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="c1"># Maximum number of concurrent autovacuum workers</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="na">autovacuum_max_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">3</span>
</span></code></pre></div>
<p>With the defaults, a table with 10,000 rows triggers autovacuum when it accumulates more than 50 + (0.2 * 10,000) = 2,050 dead tuples. For a table with 10 million rows, the threshold is 50 + (0.2 * 10,000,000) = 2,000,050 dead tuples - which means a lot of bloat accumulates before autovacuum kicks in.</p>
<p>For large, heavily-updated tables, you often need per-table overrides:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1">-- More aggressive autovacuum for a high-traffic table</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="n">autovacuum_vacuum_scale_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="p">,</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="n">autovacuum_analyze_scale_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">005</span><span class="p">,</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="n">autovacuum_vacuum_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="p">);</span>
</span></code></pre></div>
<h3 id="monitoring-dead-tuples">Monitoring Dead Tuples<a class="headerlink" href="#monitoring-dead-tuples" title="Permanent link">&para;</a></h3>
<p>The <code>pg_stat_user_tables</code> view tells you how well autovacuum is keeping up:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">SELECT</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">    </span><span class="n">schemaname</span><span class="p">,</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="n">relname</span><span class="p">,</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">    </span><span class="n">n_live_tup</span><span class="p">,</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="n">n_dead_tup</span><span class="p">,</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">    </span><span class="n">round</span><span class="p">(</span><span class="n">n_dead_tup</span><span class="p">::</span><span class="nb">numeric</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">NULLIF</span><span class="p">(</span><span class="n">n_live_tup</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dead_pct</span><span class="p">,</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="n">last_vacuum</span><span class="p">,</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span><span class="n">last_autovacuum</span><span class="p">,</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">    </span><span class="n">last_analyze</span><span class="p">,</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">    </span><span class="n">last_autoanalyze</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_user_tables</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">n_dead_tup</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span></code></pre></div>
<p>If <code>n_dead_tup</code> is consistently high and <code>last_autovacuum</code> is far in the past, autovacuum may be falling behind. Common causes: too few <code>autovacuum_max_workers</code>, thresholds set too high, or long-running transactions holding back the <strong>oldest transaction horizon</strong> (preventing VACUUM from reclaiming tuples that might still be visible to them).</p>
<div class="interactive-quiz" data-config="{&quot;question&quot;: &quot;A table has 5 million rows and the autovacuum_vacuum_scale_factor is set to the default 0.2. Approximately how many dead tuples must accumulate before autovacuum triggers a VACUUM?&quot;, &quot;type&quot;: &quot;multiple-choice&quot;, &quot;options&quot;: [{&quot;text&quot;: &quot;50 dead tuples&quot;, &quot;feedback&quot;: &quot;50 is the autovacuum_vacuum_threshold (the base), but the formula also adds (scale_factor * table_rows). The full threshold is 50 + (0.2 * 5,000,000) = 1,000,050.&quot;}, {&quot;text&quot;: &quot;About 1 million dead tuples&quot;, &quot;correct&quot;: true, &quot;feedback&quot;: &quot;Correct. The formula is threshold + (scale_factor * rows) = 50 + (0.2 * 5,000,000) = 1,000,050. For large tables, the default scale factor means significant bloat accumulates before autovacuum triggers. Production systems often lower the scale factor for high-traffic tables.&quot;}, {&quot;text&quot;: &quot;About 100,000 dead tuples&quot;, &quot;feedback&quot;: &quot;That would correspond to a scale factor of 0.02, not the default 0.2. The actual threshold is 50 + (0.2 * 5,000,000) = 1,000,050.&quot;}, {&quot;text&quot;: &quot;VACUUM triggers after every 1,000 DELETE or UPDATE operations&quot;, &quot;feedback&quot;: &quot;Autovacuum does not trigger based on the number of operations. It triggers based on the count of dead tuples exceeding the calculated threshold. The formula is threshold + (scale_factor * table_rows).&quot;}]}"><noscript><p><strong>A table has 5 million rows and the autovacuum_vacuum_scale_factor is set to the default 0.2. Approximately how many dead tuples must accumulate before autovacuum triggers a VACUUM?</strong> (requires JavaScript)</p></noscript></div>
<div class="admonition warning"><p>Invalid interactive component configuration (terminal)</p></div>
<hr />
<h2 id="pg_stat_-monitoring-views">pg_stat_* Monitoring Views<a class="headerlink" href="#pg_stat_-monitoring-views" title="Permanent link">&para;</a></h2>
<p>PostgreSQL provides a rich set of <strong>statistics views</strong> prefixed with <code>pg_stat_</code> that give you visibility into what the database is doing. These views are your primary tool for understanding performance, diagnosing problems, and capacity planning.</p>
<h3 id="pg_stat_activity">pg_stat_activity<a class="headerlink" href="#pg_stat_activity" title="Permanent link">&para;</a></h3>
<p>The <code>pg_stat_activity</code> view shows one row per active server process - every connection, what it is doing, and how long it has been doing it:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1">-- Active queries right now</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="k">SELECT</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">    </span><span class="n">pid</span><span class="p">,</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">    </span><span class="n">usename</span><span class="p">,</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="n">datname</span><span class="p">,</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="k">state</span><span class="p">,</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span><span class="n">wait_event_type</span><span class="p">,</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">    </span><span class="n">wait_event</span><span class="p">,</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">    </span><span class="n">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">query_start</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">query_duration</span><span class="p">,</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">    </span><span class="k">left</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">query_preview</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_activity</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="k">WHERE</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">&#39;idle&#39;</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">query_start</span><span class="p">;</span>
</span></code></pre></div>
<p>Key columns:</p>
<table>
<thead>
<tr>
<th>Column</th>
<th>What it tells you</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>state</code></td>
<td><code>active</code>, <code>idle</code>, <code>idle in transaction</code>, <code>fastpath function call</code></td>
</tr>
<tr>
<td><code>wait_event_type</code></td>
<td>Why the process is waiting: <code>Lock</code>, <code>IO</code>, <code>LWLock</code>, <code>BufferPin</code>, etc.</td>
</tr>
<tr>
<td><code>wait_event</code></td>
<td>Specific wait: <code>relation</code>, <code>transactionid</code>, <code>DataFileRead</code>, etc.</td>
</tr>
<tr>
<td><code>query_start</code></td>
<td>When the current query began executing</td>
</tr>
<tr>
<td><code>xact_start</code></td>
<td>When the current transaction started (important for long transactions)</td>
</tr>
<tr>
<td><code>backend_type</code></td>
<td><code>client backend</code>, <code>autovacuum worker</code>, <code>walwriter</code>, etc.</td>
</tr>
</tbody>
</table>
<p>Watch for <code>idle in transaction</code> connections - they hold locks and prevent VACUUM from reclaiming dead tuples. If <code>xact_start</code> is far in the past for an <code>idle in transaction</code> session, that connection is a problem.</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1">-- Find long-running transactions blocking VACUUM</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="k">SELECT</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="n">pid</span><span class="p">,</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="n">usename</span><span class="p">,</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="k">state</span><span class="p">,</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">    </span><span class="n">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xact_start</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">transaction_age</span><span class="p">,</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">    </span><span class="k">left</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">last_query</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_activity</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="k">WHERE</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;idle in transaction&#39;</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">now</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xact_start</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="s1">&#39;5 minutes&#39;</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">xact_start</span><span class="p">;</span>
</span></code></pre></div>
<h3 id="pg_stat_user_tables">pg_stat_user_tables<a class="headerlink" href="#pg_stat_user_tables" title="Permanent link">&para;</a></h3>
<p>This view provides per-table I/O and maintenance statistics:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">SELECT</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span><span class="n">relname</span><span class="p">,</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span><span class="n">seq_scan</span><span class="p">,</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span><span class="n">seq_tup_read</span><span class="p">,</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">    </span><span class="n">idx_scan</span><span class="p">,</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span><span class="n">idx_tup_fetch</span><span class="p">,</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="n">n_tup_ins</span><span class="p">,</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">    </span><span class="n">n_tup_upd</span><span class="p">,</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">    </span><span class="n">n_tup_del</span><span class="p">,</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">    </span><span class="n">n_dead_tup</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_user_tables</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">seq_scan</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span></code></pre></div>
<p>A table with high <code>seq_scan</code> counts and many rows probably needs an index. Compare <code>seq_scan</code> to <code>idx_scan</code> - if sequential scans dominate on a large table, the planner is not finding useful indexes for common queries.</p>
<h3 id="pg_stat_user_indexes">pg_stat_user_indexes<a class="headerlink" href="#pg_stat_user_indexes" title="Permanent link">&para;</a></h3>
<p>Shows how much each index is actually used:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1">-- Find unused indexes (candidates for removal)</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="k">SELECT</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span><span class="n">schemaname</span><span class="p">,</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="n">relname</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">table_name</span><span class="p">,</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span><span class="n">indexrelname</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">index_name</span><span class="p">,</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">    </span><span class="n">idx_scan</span><span class="p">,</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">    </span><span class="n">pg_size_pretty</span><span class="p">(</span><span class="n">pg_relation_size</span><span class="p">(</span><span class="n">indexrelid</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">index_size</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_user_indexes</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">idx_scan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">pg_relation_size</span><span class="p">(</span><span class="n">indexrelid</span><span class="p">)</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</span></code></pre></div>
<p>Unused indexes waste disk space and slow down writes (every INSERT, UPDATE, and DELETE must update all indexes). Periodically auditing for zero-scan indexes and dropping them is a valuable maintenance task.</p>
<h3 id="pg_stat_bgwriter">pg_stat_bgwriter<a class="headerlink" href="#pg_stat_bgwriter" title="Permanent link">&para;</a></h3>
<p>The <strong>background writer</strong> and <strong>checkpointer</strong> flush dirty buffers to disk. This view shows how that work is distributed:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">SELECT</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">    </span><span class="n">checkpoints_timed</span><span class="p">,</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">    </span><span class="n">checkpoints_req</span><span class="p">,</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">    </span><span class="n">buffers_checkpoint</span><span class="p">,</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">    </span><span class="n">buffers_clean</span><span class="p">,</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">    </span><span class="n">buffers_backend</span><span class="p">,</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">    </span><span class="n">buffers_alloc</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_bgwriter</span><span class="p">;</span>
</span></code></pre></div>
<p>If <code>buffers_backend</code> is high relative to <code>buffers_checkpoint</code> and <code>buffers_clean</code>, client processes are being forced to write dirty pages themselves instead of the background writer handling it. This indicates the background writer cannot keep up and you may need to tune <code>bgwriter_lru_maxpages</code> or <code>bgwriter_lru_multiplier</code>.</p>
<p>If <code>checkpoints_req</code> is high relative to <code>checkpoints_timed</code>, checkpoints are being forced by WAL volume rather than happening on schedule. Increase <code>max_wal_size</code> to reduce forced checkpoints.</p>
<h3 id="pg_stat_replication">pg_stat_replication<a class="headerlink" href="#pg_stat_replication" title="Permanent link">&para;</a></h3>
<p>When running streaming replication, this view shows the state of each standby:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">SELECT</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span><span class="n">client_addr</span><span class="p">,</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span><span class="k">state</span><span class="p">,</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">    </span><span class="n">sent_lsn</span><span class="p">,</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">    </span><span class="n">write_lsn</span><span class="p">,</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">    </span><span class="n">flush_lsn</span><span class="p">,</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">    </span><span class="n">replay_lsn</span><span class="p">,</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">    </span><span class="n">sent_lsn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">replay_lsn</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">replay_lag_bytes</span><span class="p">,</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">    </span><span class="n">write_lag</span><span class="p">,</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">    </span><span class="n">flush_lag</span><span class="p">,</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">    </span><span class="n">replay_lag</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_replication</span><span class="p">;</span>
</span></code></pre></div>
<p>The lag columns (<code>write_lag</code>, <code>flush_lag</code>, <code>replay_lag</code>) show time-based lag at each stage. If <code>replay_lag</code> is growing, the standby is falling behind - often due to heavy write load, slow standby disk, or a long-running query on the standby blocking replay.</p>
<div class="interactive-quiz" data-config="{&quot;question&quot;: &quot;You notice a table with 2 million rows has 45,000 sequential scans and only 120 index scans in pg_stat_user_tables. What does this most likely indicate?&quot;, &quot;type&quot;: &quot;multiple-choice&quot;, &quot;options&quot;: [{&quot;text&quot;: &quot;The table&#39;s indexes are corrupt and need to be rebuilt&quot;, &quot;feedback&quot;: &quot;Corrupt indexes would cause errors, not a preference for sequential scans. The planner avoids indexes when it estimates they are not beneficial for the query, or when no suitable index exists.&quot;}, {&quot;text&quot;: &quot;The queries hitting this table would benefit from better indexing&quot;, &quot;correct&quot;: true, &quot;feedback&quot;: &quot;Correct. A large table with overwhelmingly sequential scans suggests the planner cannot find useful indexes for the queries being run. Either the right indexes do not exist, or the existing indexes do not match the query predicates. Review the slow query log or pg_stat_statements to identify the queries, then create appropriate indexes.&quot;}, {&quot;text&quot;: &quot;Sequential scans are always faster than index scans on this table&quot;, &quot;feedback&quot;: &quot;Sequential scans can be faster for small tables or queries that return most of the table&#39;s rows. But for a 2-million-row table, 45,000 sequential scans almost certainly include selective queries that would benefit from indexes.&quot;}, {&quot;text&quot;: &quot;Autovacuum is not running frequently enough&quot;, &quot;feedback&quot;: &quot;Autovacuum affects dead tuple cleanup and statistics freshness, not the ratio of sequential to index scans. The scan ratio indicates a missing or unsuitable index.&quot;}]}"><noscript><p><strong>You notice a table with 2 million rows has 45,000 sequential scans and only 120 index scans in pg_stat_user_tables. What does this most likely indicate?</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="extensions">Extensions<a class="headerlink" href="#extensions" title="Permanent link">&para;</a></h2>
<p>One of PostgreSQL's greatest strengths is its <strong>extension</strong> system. Extensions add data types, functions, operators, index methods, and more - all without modifying the core server. PostgreSQL ships with a set of <strong>contrib</strong> extensions, and hundreds more are available from the community.</p>
<h3 id="installing-extensions">Installing Extensions<a class="headerlink" href="#installing-extensions" title="Permanent link">&para;</a></h3>
<p>Extensions must first be available on the filesystem (installed as shared libraries), then loaded into a specific database:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1">-- See what&#39;s available</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">default_version</span><span class="p">,</span><span class="w"> </span><span class="k">comment</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_available_extensions</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="c1">-- Install an extension</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">pg_stat_statements</span><span class="p">;</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="c1">-- Check installed extensions</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">extname</span><span class="p">,</span><span class="w"> </span><span class="n">extversion</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_extension</span><span class="p">;</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="c1">-- Update an extension to a new version</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="k">ALTER</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">pg_stat_statements</span><span class="w"> </span><span class="k">UPDATE</span><span class="p">;</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="c1">-- Remove an extension</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="k">DROP</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">pg_stat_statements</span><span class="p">;</span>
</span></code></pre></div>
<h3 id="pg_stat_statements">pg_stat_statements<a class="headerlink" href="#pg_stat_statements" title="Permanent link">&para;</a></h3>
<p><a href="https://www.postgresql.org/docs/current/pgstatstatements.html"><strong>pg_stat_statements</strong></a> tracks execution statistics for every SQL statement executed by the server. It is the single most valuable extension for performance analysis.</p>
<p>To enable it, add to <code>postgresql.conf</code>:</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="na">shared_preload_libraries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;pg_stat_statements&#39;</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="na">pg_stat_statements.track</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">all</span>
</span></code></pre></div>
<p>Then restart PostgreSQL and create the extension:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">pg_stat_statements</span><span class="p">;</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c1">-- Top 10 queries by total execution time</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="k">SELECT</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">    </span><span class="k">left</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="w"> </span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">query</span><span class="p">,</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">    </span><span class="n">calls</span><span class="p">,</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">    </span><span class="n">round</span><span class="p">(</span><span class="n">total_exec_time</span><span class="p">::</span><span class="nb">numeric</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_ms</span><span class="p">,</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">    </span><span class="n">round</span><span class="p">(</span><span class="n">mean_exec_time</span><span class="p">::</span><span class="nb">numeric</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">avg_ms</span><span class="p">,</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">    </span><span class="k">rows</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_statements</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">total_exec_time</span><span class="w"> </span><span class="k">DESC</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="c1">-- Reset statistics</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">pg_stat_statements_reset</span><span class="p">();</span>
</span></code></pre></div>
<p>This tells you which queries consume the most time in aggregate - not just the slowest individual query, but the ones that are called thousands of times and add up. A query that takes 2 ms but runs 500,000 times per day (1,000 seconds total) matters more than one that takes 5 seconds but runs once.</p>
<h3 id="pgcrypto">pgcrypto<a class="headerlink" href="#pgcrypto" title="Permanent link">&para;</a></h3>
<p><a href="https://www.postgresql.org/docs/current/pgcrypto.html"><strong>pgcrypto</strong></a> provides cryptographic functions directly in SQL - hashing, encryption, and random data generation:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">pgcrypto</span><span class="p">;</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="c1">-- Hash a password with bcrypt (blowfish)</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">crypt</span><span class="p">(</span><span class="s1">&#39;user_password&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">gen_salt</span><span class="p">(</span><span class="s1">&#39;bf&#39;</span><span class="p">));</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="c1">-- Verify a password</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="k">SELECT</span><span class="w"> </span><span class="p">(</span><span class="n">stored_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crypt</span><span class="p">(</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">stored_hash</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">password_valid</span><span class="p">;</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="c1">-- Generate random bytes</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">gen_random_bytes</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="c1">-- Generate a random UUID (also available via gen_random_uuid() in PG 13+)</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">gen_random_uuid</span><span class="p">();</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="c1">-- Symmetric encryption</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">pgp_sym_encrypt</span><span class="p">(</span><span class="s1">&#39;sensitive data&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;encryption_key&#39;</span><span class="p">);</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">pgp_sym_decrypt</span><span class="p">(</span><span class="n">encrypted_column</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;encryption_key&#39;</span><span class="p">);</span>
</span></code></pre></div>
<h3 id="postgis">PostGIS<a class="headerlink" href="#postgis" title="Permanent link">&para;</a></h3>
<p><a href="https://postgis.net/"><strong>PostGIS</strong></a> adds geospatial data types, indexes, and functions - turning PostgreSQL into a full geographic information system. It is one of the most capable open-source geospatial databases available:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">postgis</span><span class="p">;</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="c1">-- Store a point (longitude, latitude in WGS 84)</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">serial</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">text</span><span class="p">,</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">    </span><span class="n">geom</span><span class="w"> </span><span class="n">geometry</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span><span class="w"> </span><span class="mi">4326</span><span class="p">)</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="p">);</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">locations</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="p">)</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Office&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ST_SetSRID</span><span class="p">(</span><span class="n">ST_MakePoint</span><span class="p">(</span><span class="o">-</span><span class="mi">73</span><span class="p">.</span><span class="mi">9857</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">7484</span><span class="p">),</span><span class="w"> </span><span class="mi">4326</span><span class="p">));</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="c1">-- Find locations within 5 km of a point</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">ST_Distance</span><span class="p">(</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">    </span><span class="n">geom</span><span class="p">::</span><span class="n">geography</span><span class="p">,</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">    </span><span class="n">ST_SetSRID</span><span class="p">(</span><span class="n">ST_MakePoint</span><span class="p">(</span><span class="o">-</span><span class="mi">73</span><span class="p">.</span><span class="mi">9851</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">7580</span><span class="p">),</span><span class="w"> </span><span class="mi">4326</span><span class="p">)::</span><span class="n">geography</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">distance_meters</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="k">FROM</span><span class="w"> </span><span class="n">locations</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">ST_DWithin</span><span class="p">(</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">    </span><span class="n">geom</span><span class="p">::</span><span class="n">geography</span><span class="p">,</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">    </span><span class="n">ST_SetSRID</span><span class="p">(</span><span class="n">ST_MakePoint</span><span class="p">(</span><span class="o">-</span><span class="mi">73</span><span class="p">.</span><span class="mi">9851</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">7580</span><span class="p">),</span><span class="w"> </span><span class="mi">4326</span><span class="p">)::</span><span class="n">geography</span><span class="p">,</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="w">    </span><span class="mi">5000</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="p">);</span>
</span></code></pre></div>
<h3 id="pg_trgm">pg_trgm<a class="headerlink" href="#pg_trgm" title="Permanent link">&para;</a></h3>
<p><a href="https://www.postgresql.org/docs/current/pgtrgm.html"><strong>pg_trgm</strong></a> provides trigram-based text similarity functions and index support. It is excellent for fuzzy text matching, "did you mean?" features, and typo-tolerant searches:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">pg_trgm</span><span class="p">;</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c1">-- Similarity score (0 to 1)</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">similarity</span><span class="p">(</span><span class="s1">&#39;PostgreSQL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PostgerSQL&#39;</span><span class="p">);</span><span class="w">  </span><span class="c1">-- ~0.6</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="c1">-- Find similar product names</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">similarity</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PostgreSQ&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sim</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="k">FROM</span><span class="w"> </span><span class="n">products</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">similarity</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PostgreSQ&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">sim</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="c1">-- Create a GIN index for fast trigram searches</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_products_name_trgm</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">gin</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="n">gin_trgm_ops</span><span class="p">);</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="c1">-- Use LIKE/ILIKE with trigram index acceleration</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">products</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">ILIKE</span><span class="w"> </span><span class="s1">&#39;%postgres%&#39;</span><span class="p">;</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Combine pg_trgm with full-text search</p>
<p>Use <code>pg_trgm</code> for fuzzy matching on short strings (names, titles) and PostgreSQL's built-in full-text search (<code>tsvector</code>/<code>tsquery</code>) for document-length content. They complement each other well - trigrams catch typos and abbreviations that full-text search misses.</p>
</div>
<div class="interactive-command-builder" data-config="{&quot;title&quot;: &quot;PostgreSQL Admin Command Builder&quot;, &quot;description&quot;: &quot;Build common psql administration commands for database maintenance and monitoring.&quot;, &quot;base&quot;: &quot;psql&quot;, &quot;groups&quot;: [{&quot;name&quot;: &quot;Connection&quot;, &quot;options&quot;: [{&quot;flag&quot;: &quot;-U postgres&quot;, &quot;description&quot;: &quot;Connect as the postgres superuser&quot;}, {&quot;flag&quot;: &quot;-d myapp&quot;, &quot;description&quot;: &quot;Connect to the myapp database&quot;}, {&quot;flag&quot;: &quot;-h localhost&quot;, &quot;description&quot;: &quot;Connect to localhost (TCP instead of socket)&quot;}, {&quot;flag&quot;: &quot;-p 5432&quot;, &quot;description&quot;: &quot;Specify the port number&quot;}]}, {&quot;name&quot;: &quot;Execution Mode&quot;, &quot;options&quot;: [{&quot;flag&quot;: &quot;-c \&quot;VACUUM VERBOSE tablename;\&quot;&quot;, &quot;description&quot;: &quot;Run VACUUM with verbose output on a table&quot;}, {&quot;flag&quot;: &quot;-c \&quot;ANALYZE tablename;\&quot;&quot;, &quot;description&quot;: &quot;Update planner statistics for a table&quot;}, {&quot;flag&quot;: &quot;-c \&quot;SELECT * FROM pg_stat_activity WHERE state != &#39;idle&#39;;\&quot;&quot;, &quot;description&quot;: &quot;Show active queries&quot;}, {&quot;flag&quot;: &quot;-c \&quot;SELECT * FROM pg_stat_user_tables ORDER BY n_dead_tup DESC LIMIT 10;\&quot;&quot;, &quot;description&quot;: &quot;Show tables with most dead tuples&quot;}]}, {&quot;name&quot;: &quot;Output Format&quot;, &quot;options&quot;: [{&quot;flag&quot;: &quot;-x&quot;, &quot;description&quot;: &quot;Expanded (vertical) output for wide rows&quot;}, {&quot;flag&quot;: &quot;--csv&quot;, &quot;description&quot;: &quot;CSV output for scripting&quot;}, {&quot;flag&quot;: &quot;-t&quot;, &quot;description&quot;: &quot;Tuples only (no headers or footers)&quot;}]}]}"><noscript><p><strong>PostgreSQL Admin Command Builder</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="wal-management">WAL Management<a class="headerlink" href="#wal-management" title="Permanent link">&para;</a></h2>
<p>The <strong>Write-Ahead Log</strong> (WAL) is PostgreSQL's mechanism for ensuring data durability and crash recovery. The core principle: before any change is written to the actual data files, it is first written to the WAL. If PostgreSQL crashes, it replays the WAL on startup to recover any changes that were committed but not yet flushed to the data files.</p>
<h3 id="how-wal-works">How WAL Works<a class="headerlink" href="#how-wal-works" title="Permanent link">&para;</a></h3>
<p>Every transaction that modifies data generates WAL records. These records are written sequentially to files in the <code>pg_wal/</code> directory (called <code>pg_xlog/</code> before PostgreSQL 10). The sequence of events:</p>
<ol>
<li>Transaction modifies data in shared buffers (memory)</li>
<li>WAL records describing the changes are written to WAL buffers</li>
<li>At commit, WAL buffers are flushed to WAL files on disk (<code>fsync</code>)</li>
<li>The commit is acknowledged to the client</li>
<li>Later, the background writer or checkpointer writes the actual data pages to disk</li>
</ol>
<p>Because WAL writes are sequential (append-only) and data file writes are random, this design converts expensive random I/O into cheap sequential I/O for the critical commit path. The actual data pages are written asynchronously in the background.</p>
<h3 id="wal_level-settings">wal_level Settings<a class="headerlink" href="#wal_level-settings" title="Permanent link">&para;</a></h3>
<p>The <code>wal_level</code> parameter controls how much information is written to WAL:</p>
<table>
<thead>
<tr>
<th>Level</th>
<th>What it includes</th>
<th>Use case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>minimal</code></td>
<td>Only enough for crash recovery</td>
<td>Standalone server with no replication or archiving</td>
</tr>
<tr>
<td><code>replica</code></td>
<td>Adds data needed for WAL archiving and replication</td>
<td>Default since PostgreSQL 10; required for standby servers</td>
</tr>
<tr>
<td><code>logical</code></td>
<td>Adds data for logical decoding</td>
<td>Required for logical replication, change data capture</td>
</tr>
</tbody>
</table>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1"># postgresql.conf</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="na">wal_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">replica</span><span class="w">    </span><span class="c1"># The safe default for most deployments</span>
</span></code></pre></div>
<p>Changing <code>wal_level</code> requires a server restart.</p>
<h3 id="wal-archiving">WAL Archiving<a class="headerlink" href="#wal-archiving" title="Permanent link">&para;</a></h3>
<p><strong>WAL archiving</strong> copies completed WAL files to a safe location before they are recycled. Combined with a base backup, archived WAL files enable <strong>point-in-time recovery</strong> (PITR) - restoring a database to any moment in time.</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1"># postgresql.conf</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="na">archive_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">on</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="na">archive_command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;cp %p /var/lib/postgresql/wal_archive/%f&#39;</span>
</span></code></pre></div>
<p>The <code>%p</code> placeholder is the full path to the WAL file being archived. <code>%f</code> is just the filename. The <code>archive_command</code> must return exit code 0 on success - PostgreSQL will retry on failure and will not recycle a WAL file until it has been successfully archived.</p>
<p>For production systems, use a more robust archive command that copies to remote storage:</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1"># Archive to S3</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="na">archive_command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;aws s3 cp %p s3://my-wal-archive/%f&#39;</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="c1"># Archive with pgBackRest</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="na">archive_command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;pgbackrest --stanza=mydb archive-push %p&#39;</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="c1"># Archive with Barman</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="na">archive_command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;barman-wal-archive backup-server mydb %p&#39;</span>
</span></code></pre></div>
<h3 id="wal-directory-management">WAL Directory Management<a class="headerlink" href="#wal-directory-management" title="Permanent link">&para;</a></h3>
<p>WAL files are 16 MB each by default. Under heavy write load, the <code>pg_wal/</code> directory can grow significantly. Key parameters:</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># Soft target for total WAL size (checkpoints try to stay under this)</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="na">max_wal_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1GB</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c1"># Minimum WAL to retain (even if not needed for recovery)</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="na">min_wal_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">80MB</span>
</span></code></pre></div>
<p>Monitor WAL directory size:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1">-- Current WAL LSN (Log Sequence Number) position</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">pg_current_wal_lsn</span><span class="p">();</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="c1">-- Size of pg_wal directory</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">pg_size_pretty</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="k">size</span><span class="p">))</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_ls_waldir</span><span class="p">();</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="c1">-- Number of WAL files</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="k">SELECT</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_ls_waldir</span><span class="p">();</span>
</span></code></pre></div>
<div class="admonition danger">
<p class="admonition-title">Never manually delete files from pg_wal</p>
<p>If <code>pg_wal/</code> is filling your disk, do not delete WAL files by hand. This can cause data loss or prevent crash recovery. Instead, investigate why WAL is accumulating: a failed <code>archive_command</code>, a replication slot preventing WAL recycling, or <code>max_wal_size</code> set too low. Fix the root cause, and PostgreSQL will recycle old WAL files automatically.</p>
</div>
<h3 id="wal-and-replication-slots">WAL and Replication Slots<a class="headerlink" href="#wal-and-replication-slots" title="Permanent link">&para;</a></h3>
<p><strong>Replication slots</strong> prevent PostgreSQL from recycling WAL files that a standby server or logical consumer still needs. Without slots, a slow standby might fall behind and find that the WAL it needs has been recycled - breaking replication.</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1">-- Create a physical replication slot</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">pg_create_physical_replication_slot</span><span class="p">(</span><span class="s1">&#39;standby1&#39;</span><span class="p">);</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="c1">-- View replication slots and their WAL retention</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="k">SELECT</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">    </span><span class="n">slot_name</span><span class="p">,</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="w">    </span><span class="n">slot_type</span><span class="p">,</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="w">    </span><span class="n">active</span><span class="p">,</span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="w">    </span><span class="n">pg_size_pretty</span><span class="p">(</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="w">        </span><span class="n">pg_wal_lsn_diff</span><span class="p">(</span><span class="n">pg_current_wal_lsn</span><span class="p">(),</span><span class="w"> </span><span class="n">restart_lsn</span><span class="p">)</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">retained_wal</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="k">FROM</span><span class="w"> </span><span class="n">pg_replication_slots</span><span class="p">;</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a><span class="c1">-- Drop a slot that&#39;s no longer needed (releases retained WAL)</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">pg_drop_replication_slot</span><span class="p">(</span><span class="s1">&#39;standby1&#39;</span><span class="p">);</span>
</span></code></pre></div>
<p>An inactive replication slot is one of the most common causes of <code>pg_wal/</code> growing unbounded. If a standby is decommissioned without dropping its slot, WAL accumulates indefinitely.</p>
<hr />
<h2 id="putting-it-together-diagnosing-bloat">Putting It Together: Diagnosing Bloat<a class="headerlink" href="#putting-it-together-diagnosing-bloat" title="Permanent link">&para;</a></h2>
<p>The topics in this guide are interconnected. Dead tuples accumulate because of MVCC. VACUUM cleans them up. <code>pg_stat_user_tables</code> tells you whether VACUUM is keeping up. Long-running transactions (visible in <code>pg_stat_activity</code>) prevent VACUUM from reclaiming tuples. <code>pg_stat_statements</code> reveals the queries causing the most churn. Understanding these relationships is the core of PostgreSQL administration.</p>
<div class="interactive-exercise" data-config="{&quot;title&quot;: &quot;Diagnose Table Bloat and Plan a VACUUM Strategy&quot;, &quot;difficulty&quot;: &quot;intermediate&quot;, &quot;scenario&quot;: &quot;You are investigating performance degradation on a production PostgreSQL 16 server. The application team reports that queries on the `orders` table are getting slower over time.\n\nYou have access to the following information:\n\n- The `orders` table has 8 million live rows\n- `pg_stat_user_tables` shows 3.2 million dead tuples for `orders`\n- `last_autovacuum` for `orders` was 6 hours ago\n- `pg_stat_activity` shows one connection in `idle in transaction` state that has been open for 14 hours\n- The table&#39;s `autovacuum_vacuum_scale_factor` is the default 0.2\n- The application performs approximately 50,000 updates per hour on this table\n\nBased on this information:\n\n1. Calculate the autovacuum trigger threshold for this table with the default settings\n2. Explain why the 3.2 million dead tuples have not been cleaned up despite autovacuum running 6 hours ago\n3. Write the SQL to identify and terminate the problematic idle-in-transaction connection\n4. Write the SQL to set more aggressive autovacuum parameters for this table\n5. Describe what steps you would take, in order, to resolve this situation\n&quot;, &quot;hints&quot;: [&quot;The autovacuum threshold formula is: threshold + (scale_factor * n_live_tup)&quot;, &quot;VACUUM can only remove dead tuples that are no longer visible to ANY active transaction&quot;, &quot;Check the xact_start column in pg_stat_activity for long-running transactions&quot;, &quot;Per-table storage parameters override the global autovacuum settings&quot;], &quot;solution&quot;: &quot;```sql\n-- 1. Calculate the autovacuum threshold:\n--    50 + (0.2 * 8,000,000) = 1,600,050 dead tuples\n--    Autovacuum triggers when dead tuples exceed ~1.6 million\n\n-- 2. The 14-hour idle-in-transaction connection is the problem.\n--    Its transaction&#39;s snapshot prevents VACUUM from removing any\n--    dead tuples created after that transaction started. Even though\n--    autovacuum ran 6 hours ago, it could not reclaim tuples that\n--    might still be visible to the old transaction. The dead tuples\n--    keep accumulating from the 50,000 updates/hour.\n\n-- 3. Find and terminate the problematic connection:\nSELECT pid, usename, state,\n       now() - xact_start AS transaction_age,\n       left(query, 80) AS last_query\nFROM pg_stat_activity\nWHERE state = &#39;idle in transaction&#39;\n    AND now() - xact_start > interval &#39;1 hour&#39;;\n\n-- Terminate the specific connection (replace PID with actual value):\nSELECT pg_terminate_backend(<pid>);\n\n-- 4. Set aggressive autovacuum for the orders table:\nALTER TABLE orders SET (\n    autovacuum_vacuum_scale_factor = 0.01,\n    autovacuum_analyze_scale_factor = 0.005,\n    autovacuum_vacuum_threshold = 1000,\n    autovacuum_vacuum_cost_delay = 2\n);\n-- New threshold: 1000 + (0.01 * 8,000,000) = 81,000 dead tuples\n\n-- 5. Resolution steps in order:\n--    a. Terminate the idle-in-transaction connection\n--    b. Run VACUUM VERBOSE orders to immediately clean up dead tuples\n--    c. Run ANALYZE orders to refresh planner statistics\n--    d. Set per-table autovacuum parameters (as shown above)\n--    e. Configure idle_in_transaction_session_timeout in postgresql.conf\n--       to prevent this from happening again:\n--       idle_in_transaction_session_timeout = &#39;30min&#39;\n--    f. Monitor with:\nSELECT n_dead_tup, last_autovacuum\nFROM pg_stat_user_tables\nWHERE relname = &#39;orders&#39;;\n```&quot;}"><noscript><p><strong>Diagnose Table Bloat and Plan a VACUUM Strategy</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="further-reading">Further Reading<a class="headerlink" href="#further-reading" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://www.postgresql.org/docs/current/user-manag.html">PostgreSQL Documentation: Database Roles</a> - official reference for role creation, membership, and privilege management</li>
<li><a href="https://www.postgresql.org/docs/current/routine-vacuuming.html">PostgreSQL Documentation: Routine Vacuuming</a> - comprehensive coverage of VACUUM, autovacuum, and transaction ID wraparound prevention</li>
<li><a href="https://www.postgresql.org/docs/current/monitoring-stats.html">PostgreSQL Documentation: Monitoring Database Activity</a> - full reference for all <code>pg_stat_*</code> views and what each column means</li>
<li><a href="https://www.postgresql.org/docs/current/wal.html">PostgreSQL Documentation: Write-Ahead Logging</a> - WAL internals, configuration, and reliability guarantees</li>
<li><a href="https://www.postgresql.org/docs/current/pgstatstatements.html">pg_stat_statements Documentation</a> - setup, configuration, and query performance analysis</li>
<li><a href="https://wiki.postgresql.org/wiki/Don%27t_Do_This">PostgreSQL Wiki: Don't Do This</a> - common PostgreSQL anti-patterns and mistakes to avoid</li>
</ul>
<hr />
<p><strong>Previous:</strong> <a href="../postgresql-fundamentals/">PostgreSQL Fundamentals</a> | <strong>Next:</strong> <a href="../postgresql-advanced/">PostgreSQL Advanced Features</a> | <a href="../">Back to Index</a></p>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve by <a href="https://github.com/ringo380/guides/issues/new?template=content-improvement.yml&title=[Feedback]+PostgreSQL%20Administration" target="_blank" rel="noopener">opening an issue</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>

<!-- SPDX-License-Identifier: MIT | Copyright (c) 2025-2026 Robworks Software LLC -->
<!-- Giscus comments - GitHub Discussions-backed -->

  <h2 id="__comments">Comments</h2>

  <script
    src="https://giscus.app/client.js"
    data-repo="ringo380/guides"
    data-repo-id="R_kgDOM3QMrQ"
    data-category="General"
    data-category-id="DIC_kwDOM3QMrc4C2qV9"
    data-mapping="pathname"
    data-strict="1"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>

                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025-2026 Robworks Software LLC
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ringo380" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/robworks" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://bsky.app/profile/lessoncraft.bsky.social" target="_blank" rel="noopener" title="bsky.app" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M407.8 294.7c-3.3-.4-6.7-.8-10-1.3 3.4.4 6.7.9 10 1.3M288 227.1c-26.1-50.7-97.1-145.2-163.1-191.8C61.6-9.4 37.5-1.7 21.6 5.5 3.3 13.8 0 41.9 0 58.4S9.1 194 15 213.9c19.5 65.7 89.1 87.9 153.2 80.7 3.3-.5 6.6-.9 10-1.4-3.3.5-6.6 1-10 1.4-93.9 14-177.3 48.2-67.9 169.9C220.6 589.1 265.1 437.8 288 361.1c22.9 76.7 49.2 222.5 185.6 103.4 102.4-103.4 28.1-156-65.8-169.9-3.3-.4-6.7-.8-10-1.3 3.4.4 6.7.9 10 1.3 64.1 7.1 133.6-15.1 153.2-80.7C566.9 194 576 75 576 58.4s-3.3-44.7-21.6-52.9c-15.8-7.1-40-14.9-103.2 29.8C385.1 81.9 314.1 176.4 288 227.1"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://mastodon.social/@runbook" target="_blank" rel="noopener me" title="mastodon.social" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M433 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54-.6-4.6-.9-9.3-.9-13.9 85.6 20.9 158.7 9.1 178.7 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6V190.1c0-49.7-64-51.6-64 6.9v62.5H201V197c0-58.5-64-56.6-64-6.9v114.2H90.3c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://threads.net/@robworks_software" target="_blank" rel="noopener" title="threads.net" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M331.5 235.7c2.2.9 4.2 1.9 6.3 2.8 29.2 14.1 50.6 35.2 61.8 61.4 15.7 36.5 17.2 95.8-30.3 143.2-36.2 36.2-80.3 52.5-142.6 53h-.3c-70.2-.5-124.1-24.1-160.4-70.2-32.3-41-48.9-98.1-49.5-169.6v-.5c.5-71.5 17.1-128.6 49.4-169.6 36.3-46.1 90.3-69.7 160.5-70.2h.3c70.3.5 124.9 24 162.3 69.9 18.4 22.7 32 50 40.6 81.7l-40.4 10.8c-7.1-25.8-17.8-47.8-32.2-65.4-29.2-35.8-73-54.2-130.5-54.6-57 .5-100.1 18.8-128.2 54.4C72.1 146.1 58.5 194.3 58 256c.5 61.7 14.1 109.9 40.3 143.3 28 35.6 71.2 53.9 128.2 54.4 51.4-.4 85.4-12.6 113.7-40.9 32.3-32.2 31.7-71.8 21.4-95.9-6.1-14.2-17.1-26-31.9-34.9-3.7 26.9-11.8 48.3-24.7 64.8-17.1 21.8-41.4 33.6-72.7 35.3-23.6 1.3-46.3-4.4-63.9-16-20.8-13.8-33-34.8-34.3-59.3-2.5-48.3 35.7-83 95.2-86.4 21.1-1.2 40.9-.3 59.2 2.8-2.4-14.8-7.3-26.6-14.6-35.2-10-11.7-25.6-17.7-46.2-17.8h-.7c-16.6 0-39 4.6-53.3 26.3l-34.4-23.6c19.2-29.1 50.3-45.1 87.8-45.1h.8c62.6.4 99.9 39.5 103.7 107.7l-.2.2zm-156 68.8c1.3 25.1 28.4 36.8 54.6 35.3 25.6-1.4 54.6-11.4 59.5-73.2-13.2-2.9-27.8-4.4-43.4-4.4-4.8 0-9.6.1-14.4.4-42.9 2.4-57.2 23.2-56.2 41.8z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



  

<h4>Cookie consent</h4>
<p>We use cookies to recognize repeat visits and measure engagement with guides. With your consent, you help us improve the content.</p>
<input class="md-toggle" type="checkbox" id="__settings" checked>
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
      
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.tracking", "navigation.indexes", "search.suggest", "search.highlight", "content.code.copy", "content.action.edit"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../assets/javascripts/interactive.js"></script>
      
        <script src="../../assets/javascripts/giscus-theme.js"></script>
      
        <script src="../../assets/javascripts/lightbox.js"></script>
      
        <script src="../../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>