
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Practical technical guides on Linux, DNS, Git, databases, and development">
      
      
        <meta name="author" content="Ryan Robson">
      
      
        <link rel="canonical" href="https://ringo380.github.io/guides/Databases/innodb-recovery-pdrt/">
      
      
        <link rel="prev" href="../scaling-and-architecture/">
      
      
        <link rel="next" href="../../Dev%20Zero/Perl/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>InnoDB Recovery with PDRT - The Runbook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/interactive.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/lightbox.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-56L2QXTFGR"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-56L2QXTFGR",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-56L2QXTFGR",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
  
<meta property="og:type" content="website" />
<meta property="og:title" content="InnoDB Recovery with PDRT - The Runbook" />
<meta property="og:description" content="Practical technical guides on Linux, DNS, Git, databases, and development" />
<meta property="og:image" content="https://ringo380.github.io/guides/assets/images/social/Databases/innodb-recovery-pdrt.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:url" content="https://ringo380.github.io/guides/Databases/innodb-recovery-pdrt/" />
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content="InnoDB Recovery with PDRT - The Runbook" />
<meta property="twitter:description" content="Practical technical guides on Linux, DNS, Git, databases, and development" />
<meta property="twitter:image" content="https://ringo380.github.io/guides/assets/images/social/Databases/innodb-recovery-pdrt.png" />
</head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#innodb-recovery-with-pdrt" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="The Runbook" class="md-header__button md-logo" aria-label="The Runbook" data-md-component="logo">
      
  <img src="../../assets/images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Runbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              InnoDB Recovery with PDRT
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ringo380/guides" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ringo380/guides
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Linux%20Essentials/" class="md-tabs__link">
          
  
  
    
  
  Linux Essentials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../DNS%20Administration/" class="md-tabs__link">
          
  
  
    
  
  DNS Administration

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Git/" class="md-tabs__link">
          
  
  
    
  
  Git

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Databases

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Dev%20Zero/Perl/" class="md-tabs__link">
          
  
  
    
  
  Dev Zero

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="The Runbook" class="md-nav__button md-logo" aria-label="The Runbook" data-md-component="logo">
      
  <img src="../../assets/images/logo.svg" alt="logo">

    </a>
    The Runbook
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ringo380/guides" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ringo380/guides
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Linux%20Essentials/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Linux Essentials
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linux Essentials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/shell-basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Shell Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/streams-and-redirection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streams and Redirection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/text-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Text Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/finding-files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Finding Files
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/file-permissions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File Permissions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/job-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Job Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/scripting-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scripting Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/disk-and-filesystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Disk and Filesystem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Networking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/system-information/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Information
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/archiving-and-compression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Archiving and Compression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/best-practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Best Practices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../DNS%20Administration/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    DNS Administration
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    DNS Administration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dns-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/zone-files-and-records/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zone Files and Records
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dns-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Tools and Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/bind/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BIND
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/nsd-and-unbound/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NSD and Unbound
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/powerdns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PowerDNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dnssec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNSSEC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dns-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Architecture and Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Git/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Git
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Git
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/three-trees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Three Trees
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/commits-and-history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Commits and History
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/branches-and-merging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Branches and Merging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/remote-repositories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Remote Repositories
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/rewriting-history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rewriting History
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/stashing-and-worktree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stashing and the Worktree
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/configuring-git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring Git
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/object-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Object Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/refs-reflog-dag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Refs, the Reflog, and the DAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/transfer-protocols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transfer Protocols
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/collaboration-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collaboration Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/platforms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Platforms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/hooks-and-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hooks and Automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/monorepos-and-scaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monorepos and Scaling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/troubleshooting-and-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting and Recovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Databases
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Databases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql-essentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL Essentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Design & Modeling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-installation-and-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Installation & Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-administration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Administration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Performance & Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-replication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Replication & HA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-administration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Administration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Advanced Features
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nosql-concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NoSQL Concepts & Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mongodb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MongoDB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backup-and-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backup & Recovery Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaling-and-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scaling & Architecture Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    InnoDB Recovery with PDRT
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    InnoDB Recovery with PDRT
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#innodb-file-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        InnoDB File Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="InnoDB File Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-system-tablespace-ibdata1" class="md-nav__link">
    <span class="md-ellipsis">
      
        The System Tablespace: ibdata1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#per-table-files-ibd-and-frm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Per-Table Files: .ibd and .frm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#innodb-log-files-ib_logfile" class="md-nav__link">
    <span class="md-ellipsis">
      
        InnoDB Log Files: ib_logfile*
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-pdrt-toolkit" class="md-nav__link">
    <span class="md-ellipsis">
      
        The PDRT Toolkit
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The PDRT Toolkit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constraints_parser" class="md-nav__link">
    <span class="md-ellipsis">
      
        constraints_parser
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page_parser" class="md-nav__link">
    <span class="md-ellipsis">
      
        page_parser
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_defspl" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_defs.pl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#first-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        First Response
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="First Response">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-stop-mysql" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Stop MySQL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-back-up-innodb-data-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Back Up InnoDB Data Files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-back-up-the-database-directory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Back Up the Database Directory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-restart-mysql-and-dump" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Restart MySQL and Dump
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assessing-the-situation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Assessing the Situation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Assessing the Situation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-loss-severity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Loss Severity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#existing-backups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Existing Backups
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-version" class="md-nav__link">
    <span class="md-ellipsis">
      
        MySQL Version
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-pdrt" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing PDRT
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing PDRT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-and-compile" class="md-nav__link">
    <span class="md-ellipsis">
      
        Download and Compile
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-perl-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Install Perl Dependencies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-your-table-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Getting Your Table Structure
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Getting Your Table Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-mysql-is-running" class="md-nav__link">
    <span class="md-ellipsis">
      
        If MySQL Is Running
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-mysql-will-not-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        If MySQL Will Not Start
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recovering-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recovering Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recovering Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automated-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automated Recovery
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-method-with-custom-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Manual Method with Custom Definitions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-table-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tuning Table Definitions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importing-recovered-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Importing Recovered Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Importing Recovered Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splitting-output-and-sql" class="md-nav__link">
    <span class="md-ellipsis">
      
        Splitting Output and SQL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-the-import" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the Import
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verifying the Results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recovery-decision-flowchart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recovery Decision Flowchart
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      
        Practical Exercise
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Further Reading
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Dev Zero
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Dev Zero
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Dev%20Zero/Perl/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Perl
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Perl
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/perl_dev0_introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/scalars-strings-numbers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scalars, Strings, and Numbers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/arrays-hashes-lists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Arrays, Hashes, and Lists
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/control-flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Control Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/regular-expressions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regular Expressions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/subroutines-references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Subroutines and References
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/file-io-and-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File I/O and System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/modules-and-cpan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modules and CPAN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/object-oriented-perl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Object-Oriented Perl
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/error-handling-debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Handling and Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/text-processing-oneliners/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Text Processing and One-Liners
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/networking-daemons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Networking and Daemons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/web-frameworks-apis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web Frameworks and APIs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/perl_developer_roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Developer Roadmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#innodb-file-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        InnoDB File Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="InnoDB File Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-system-tablespace-ibdata1" class="md-nav__link">
    <span class="md-ellipsis">
      
        The System Tablespace: ibdata1
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#per-table-files-ibd-and-frm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Per-Table Files: .ibd and .frm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#innodb-log-files-ib_logfile" class="md-nav__link">
    <span class="md-ellipsis">
      
        InnoDB Log Files: ib_logfile*
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-pdrt-toolkit" class="md-nav__link">
    <span class="md-ellipsis">
      
        The PDRT Toolkit
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The PDRT Toolkit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constraints_parser" class="md-nav__link">
    <span class="md-ellipsis">
      
        constraints_parser
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#page_parser" class="md-nav__link">
    <span class="md-ellipsis">
      
        page_parser
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create_defspl" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_defs.pl
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#first-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        First Response
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="First Response">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-stop-mysql" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Stop MySQL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-back-up-innodb-data-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Back Up InnoDB Data Files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-back-up-the-database-directory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: Back Up the Database Directory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-restart-mysql-and-dump" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 4: Restart MySQL and Dump
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assessing-the-situation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Assessing the Situation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Assessing the Situation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-loss-severity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Loss Severity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#existing-backups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Existing Backups
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-version" class="md-nav__link">
    <span class="md-ellipsis">
      
        MySQL Version
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-pdrt" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing PDRT
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing PDRT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download-and-compile" class="md-nav__link">
    <span class="md-ellipsis">
      
        Download and Compile
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-perl-dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Install Perl Dependencies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-your-table-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Getting Your Table Structure
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Getting Your Table Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-mysql-is-running" class="md-nav__link">
    <span class="md-ellipsis">
      
        If MySQL Is Running
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-mysql-will-not-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        If MySQL Will Not Start
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recovering-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recovering Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recovering Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automated-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      
        Automated Recovery
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manual-method-with-custom-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Manual Method with Custom Definitions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-table-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tuning Table Definitions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importing-recovered-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Importing Recovered Data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Importing Recovered Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#splitting-output-and-sql" class="md-nav__link">
    <span class="md-ellipsis">
      
        Splitting Output and SQL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-the-import" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the Import
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-the-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verifying the Results
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recovery-decision-flowchart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recovery Decision Flowchart
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practical-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      
        Practical Exercise
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Further Reading
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/ringo380/guides/edit/main/Databases/innodb-recovery-pdrt.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="innodb-recovery-with-pdrt">InnoDB Recovery with PDRT<a class="headerlink" href="#innodb-recovery-with-pdrt" title="Permanent link">&para;</a></h1>
<div class="admonition danger">
<p class="admonition-title">Active Data Loss?</p>
<p>If you have identified data loss on your server, skip directly to the <a href="#first-response">First Response</a> section immediately. The longer MySQL remains online writing to your data files, the less likely recovery becomes. Every second counts.</p>
</div>
<p><a href="https://www.percona.com/"><strong>Percona</strong></a> provides a set of tools for recovering lost or corrupted MySQL data from <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html"><strong>InnoDB</strong></a> data files. The <strong>Percona Data Recovery Tool</strong> (PDRT) is freely available, and with some setup, can retrieve data that would otherwise be lost permanently or recover from InnoDB corruption that <code>innodb_force_recovery</code> cannot resolve.</p>
<p>PDRT is most useful in these scenarios:</p>
<ul>
<li>A mistaken <code>DROP TABLE</code>, <code>DELETE</code>, <code>TRUNCATE</code>, or <code>UPDATE</code></li>
<li>Deletion of the data file at the filesystem level</li>
<li>Partial corruption where InnoDB cannot start, even with <code>innodb_force_recovery</code> set to its maximum value</li>
</ul>
<p>This guide walks through the complete PDRT recovery workflow in a <a href="https://cpanel.net/"><strong>cPanel</strong></a>/WHM environment, though the core techniques apply to any MySQL installation.</p>
<hr />
<h2 id="innodb-file-architecture">InnoDB File Architecture<a class="headerlink" href="#innodb-file-architecture" title="Permanent link">&para;</a></h2>
<p>Before attempting recovery, you need to understand what you are recovering from. InnoDB stores data across several file types, and knowing which files matter determines your recovery strategy.</p>
<h3 id="the-system-tablespace-ibdata1">The System Tablespace: <code>ibdata1</code><a class="headerlink" href="#the-system-tablespace-ibdata1" title="Permanent link">&para;</a></h3>
<p>The <strong>system tablespace</strong> (<code>ibdata1</code>) is InnoDB's central file. It always exists, regardless of configuration. It contains:</p>
<ul>
<li>The <strong>data dictionary</strong> - metadata about every InnoDB table, index, and column</li>
<li>The <strong>doublewrite buffer</strong> - a crash-recovery mechanism that prevents partial page writes</li>
<li>The <strong>change buffer</strong> - cached changes to secondary indexes</li>
<li><strong>Undo logs</strong> - records needed to roll back uncommitted transactions</li>
</ul>
<p>When <code>innodb_file_per_table</code> is disabled (the pre-MySQL 5.6 default), <code>ibdata1</code> also stores all table data and indexes. This makes it the single target for recovery - but also means it grows indefinitely and cannot be shrunk without rebuilding.</p>
<h3 id="per-table-files-ibd-and-frm">Per-Table Files: <code>.ibd</code> and <code>.frm</code><a class="headerlink" href="#per-table-files-ibd-and-frm" title="Permanent link">&para;</a></h3>
<p>With <code>innodb_file_per_table=ON</code> (the default since MySQL 5.6 and the standard on all cPanel servers), each table gets its own <code>.ibd</code> file containing that table's data and indexes. The <code>.frm</code> file stores the table's structure definition.</p>
<p>This per-table layout simplifies some recovery scenarios because each table's data is isolated. However, it complicates <code>DROP TABLE</code> recovery because dropping a table removes both the <code>.ibd</code> and <code>.frm</code> files from the filesystem entirely.</p>
<div class="admonition tip">
<p class="admonition-title">MySQL 8.0 changes</p>
<p>MySQL 8.0 replaced the <code>.frm</code> files with a transactional data dictionary stored inside InnoDB itself. The recovery techniques in this guide still apply to the data files, but <code>.frm</code>-based schema extraction only works for MySQL 5.x and MariaDB.</p>
</div>
<h3 id="innodb-log-files-ib_logfile">InnoDB Log Files: <code>ib_logfile*</code><a class="headerlink" href="#innodb-log-files-ib_logfile" title="Permanent link">&para;</a></h3>
<p>The <strong>redo logs</strong> (<code>ib_logfile0</code>, <code>ib_logfile1</code>) record every change before it reaches the data files. InnoDB replays these logs after a crash to bring the data files up to date. Deleting these files without understanding the server's state can cause permanent data loss if uncommitted transactions needed for recovery are still in the logs.</p>
<div class="interactive-quiz" data-config="{&quot;question&quot;: &quot;What is the relationship between ibdata1 and .ibd files in InnoDB?&quot;, &quot;type&quot;: &quot;multiple-choice&quot;, &quot;options&quot;: [{&quot;text&quot;: &quot;ibdata1 is the main data file; .ibd files are backup copies&quot;, &quot;feedback&quot;: &quot;.ibd files are not backups. They are the per-table data files used when innodb_file_per_table is enabled.&quot;}, {&quot;text&quot;: &quot;ibdata1 is the system tablespace (metadata, undo logs); .ibd files store individual table data when file-per-table is enabled&quot;, &quot;correct&quot;: true, &quot;feedback&quot;: &quot;Correct! With innodb_file_per_table=ON (default since MySQL 5.6), each table gets its own .ibd file for data and indexes. ibdata1 always exists and contains the system tablespace: data dictionary, undo logs, change buffer, and doublewrite buffer. Without file-per-table, all table data lives in ibdata1.&quot;}, {&quot;text&quot;: &quot;ibdata1 stores indexes; .ibd files store row data&quot;, &quot;feedback&quot;: &quot;Both ibdata1 and .ibd files can contain both data and indexes. The split depends on whether file-per-table is enabled, not on data type.&quot;}, {&quot;text&quot;: &quot;.ibd files are only used by Percona Server, not standard MySQL&quot;, &quot;feedback&quot;: &quot;.ibd files are standard InnoDB (both MySQL and Percona Server). They are created when innodb_file_per_table is enabled, which is the default in modern MySQL.&quot;}]}"><noscript><p><strong>What is the relationship between ibdata1 and .ibd files in InnoDB?</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="the-pdrt-toolkit">The PDRT Toolkit<a class="headerlink" href="#the-pdrt-toolkit" title="Permanent link">&para;</a></h2>
<p>PDRT includes three core utilities. If you are in an active data-loss scenario, skip to <a href="#first-response">First Response</a> and come back here after your files are backed up.</p>
<h3 id="constraints_parser"><code>constraints_parser</code><a class="headerlink" href="#constraints_parser" title="Permanent link">&para;</a></h3>
<p>The primary recovery tool. It scans raw InnoDB data files (either <code>ibdata1</code> or individual <code>.ibd</code> files) and extracts rows that match a defined table structure.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>constraints_parser<span class="w"> </span>-4<span class="p">|</span>-5<span class="p">|</span>-6<span class="w"> </span><span class="o">[</span>-dDV<span class="o">]</span><span class="w"> </span>-f<span class="w"> </span>&lt;InnoDB<span class="w"> </span>page<span class="w"> </span>or<span class="w"> </span>dir&gt;<span class="w"> </span><span class="o">[</span>-T<span class="w"> </span>N:M<span class="o">]</span><span class="w"> </span><span class="o">[</span>-b<span class="w"> </span>&lt;external<span class="w"> </span>pages<span class="w"> </span>dir&gt;<span class="o">]</span>
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-4</code></td>
<td>REDUNDANT row format (MySQL 4.x)</td>
</tr>
<tr>
<td><code>-5</code></td>
<td>COMPACT row format (MySQL 5.0+)</td>
</tr>
<tr>
<td><code>-6</code></td>
<td>MySQL 5.6+ format</td>
</tr>
<tr>
<td><code>-f</code></td>
<td>Path to the InnoDB data file or directory of pages</td>
</tr>
<tr>
<td><code>-d</code></td>
<td>Process only pages that may contain deleted records</td>
</tr>
<tr>
<td><code>-D</code></td>
<td>Recover deleted rows only</td>
</tr>
<tr>
<td><code>-U</code></td>
<td>Recover undeleted rows only (default)</td>
</tr>
<tr>
<td><code>-V</code></td>
<td>Verbose mode with debug information</td>
</tr>
<tr>
<td><code>-T N:M</code></td>
<td>Filter to a specific index ID</td>
</tr>
<tr>
<td><code>-b &lt;dir&gt;</code></td>
<td>Directory for external BLOB pages</td>
</tr>
<tr>
<td><code>-p prefix</code></td>
<td>Prefix for the dump directory in LOAD DATA output</td>
</tr>
<tr>
<td><code>-o &lt;file&gt;</code></td>
<td>Save dump to a specific file</td>
</tr>
</tbody>
</table>
<h3 id="page_parser"><code>page_parser</code><a class="headerlink" href="#page_parser" title="Permanent link">&para;</a></h3>
<p>Splits a tablespace file into individual pages grouped by index ID. This is needed when recovering from <code>ibdata1</code> in shared-tablespace configurations where you need to isolate specific table data.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>page_parser<span class="w"> </span>-4<span class="p">|</span>-5<span class="w"> </span><span class="o">[</span>-dDhcCV<span class="o">]</span><span class="w"> </span>-f<span class="w"> </span>&lt;innodb_datafile&gt;<span class="w"> </span><span class="o">[</span>-T<span class="w"> </span>N:M<span class="o">]</span><span class="w"> </span><span class="o">[</span>-s<span class="w"> </span>size<span class="o">]</span><span class="w"> </span><span class="o">[</span>-t<span class="w"> </span>size<span class="o">]</span>
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-c</code></td>
<td>Count pages and group by index ID</td>
</tr>
<tr>
<td><code>-C</code></td>
<td>Count pages, ignoring invalid index IDs</td>
</tr>
<tr>
<td><code>-s size</code></td>
<td>Disk cache size (e.g., <code>1G</code>, <code>10M</code>, default <code>100M</code>)</td>
</tr>
<tr>
<td><code>-t size</code></td>
<td>Override tablespace size detection</td>
</tr>
</tbody>
</table>
<h3 id="create_defspl"><code>create_defs.pl</code><a class="headerlink" href="#create_defspl" title="Permanent link">&para;</a></h3>
<p>A Perl script that connects to a running MySQL instance and generates the <code>table_defs.h</code> header file that <code>constraints_parser</code> uses to identify row structures.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>create_defs.pl<span class="w"> </span>--host<span class="o">=</span>localhost<span class="w"> </span>--user<span class="o">=</span>root<span class="w"> </span>--password<span class="o">=</span>PASS<span class="w"> </span>--db<span class="o">=</span>DATABASE<span class="w"> </span>--table<span class="o">=</span>TABLE
</span></code></pre></div>
<div class="interactive-quiz" data-config="{&quot;question&quot;: &quot;What does constraints_parser do?&quot;, &quot;type&quot;: &quot;multiple-choice&quot;, &quot;options&quot;: [{&quot;text&quot;: &quot;It repairs the InnoDB tablespace file in place&quot;, &quot;feedback&quot;: &quot;constraints_parser does not repair files. It extracts data from them by scanning for valid row patterns.&quot;}, {&quot;text&quot;: &quot;It scans InnoDB data files and extracts rows matching a defined table structure&quot;, &quot;correct&quot;: true, &quot;feedback&quot;: &quot;Correct! constraints_parser reads raw InnoDB tablespace files (ibdata1 or .ibd files) and uses a table definition file to identify and extract valid rows. It can recover data even from severely corrupted tablespaces where MySQL itself cannot start.&quot;}, {&quot;text&quot;: &quot;It checks foreign key constraints and removes invalid references&quot;, &quot;feedback&quot;: &quot;Despite the name, constraints_parser does not manage foreign keys. It uses &#39;constraints&#39; (column definitions) to identify and extract row data from raw InnoDB pages.&quot;}, {&quot;text&quot;: &quot;It converts InnoDB tables to MyISAM format for easier recovery&quot;, &quot;feedback&quot;: &quot;constraints_parser does not convert formats. It extracts raw data from InnoDB files into tab-separated output that can be imported into a new database.&quot;}]}"><noscript><p><strong>What does constraints_parser do?</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="first-response">First Response<a class="headerlink" href="#first-response" title="Permanent link">&para;</a></h2>
<p>Every data-loss scenario is different, but this section covers the critical first steps from the perspective of someone who has just discovered the loss and needs to act fast. As time passes after data loss, the likelihood of full recovery decreases - deleted data pages get reused, and the window for recovery closes.</p>
<h3 id="step-1-stop-mysql">Step 1: Stop MySQL<a class="headerlink" href="#step-1-stop-mysql" title="Permanent link">&para;</a></h3>
<p>If MySQL is still running, stop it immediately:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>systemctl<span class="w"> </span>stop<span class="w"> </span>mysql
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1"># Or on older systems:</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>/etc/init.d/mysql<span class="w"> </span>stop
</span></code></pre></div>
<p>The goal is to prevent new writes from overwriting space in the data files that still contains recoverable data. Deleted data is marked as free space, and InnoDB will reuse it for new writes.</p>
<h3 id="step-2-back-up-innodb-data-files">Step 2: Back Up InnoDB Data Files<a class="headerlink" href="#step-2-back-up-innodb-data-files" title="Permanent link">&para;</a></h3>
<p>Create a working copy of your data files. All recovery work should happen against copies, never the originals:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>mkdir<span class="w"> </span>/root/innodb.bak
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nb">cd</span><span class="w"> </span>/var/lib/mysql
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>dd<span class="w"> </span><span class="k">if</span><span class="o">=</span>ibdata1<span class="w"> </span><span class="nv">of</span><span class="o">=</span>ibdata1.recovery<span class="w"> </span><span class="nv">conv</span><span class="o">=</span>noerror
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>cp<span class="w"> </span>ibdata1.recovery<span class="w"> </span>/root/innodb.bak/
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>cp<span class="w"> </span>ib_logfile*<span class="w"> </span>/root/innodb.bak/
</span></code></pre></div>
<p>The <code>dd</code> command with <code>conv=noerror</code> creates a copy even if there are read errors on disk, which is essential when dealing with filesystem-level corruption.</p>
<h3 id="step-3-back-up-the-database-directory">Step 3: Back Up the Database Directory<a class="headerlink" href="#step-3-back-up-the-database-directory" title="Permanent link">&para;</a></h3>
<p>Copy the database directory containing the per-table <code>.ibd</code> and <code>.frm</code> files (replace <code>$db_name</code> with your database name):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nb">cd</span><span class="w"> </span>/var/lib/mysql
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>cp<span class="w"> </span>-a<span class="w"> </span>./<span class="nv">$db_name</span><span class="w"> </span>/root/innodb.bak/
</span></code></pre></div>
<p>On cPanel servers, <code>innodb_file_per_table=1</code> is the default, so each table has its own <code>.ibd</code> file. This makes per-table recovery possible but also means a <code>DROP TABLE</code> removes the <code>.ibd</code> file entirely - recovery from a dropped table requires filesystem-level file recovery tools, which is beyond PDRT's scope.</p>
<h3 id="step-4-restart-mysql-and-dump">Step 4: Restart MySQL and Dump<a class="headerlink" href="#step-4-restart-mysql-and-dump" title="Permanent link">&para;</a></h3>
<p>With copies safely made, you can restart MySQL if it is able to start:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>systemctl<span class="w"> </span>start<span class="w"> </span>mysql
</span></code></pre></div>
<p>If MySQL starts, take full dumps immediately:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>mysqldump<span class="w"> </span>--single-transaction<span class="w"> </span>--all-databases<span class="w"> </span>&gt;<span class="w"> </span>/root/dump_wtrans.sql
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>mysqldump<span class="w"> </span>--all-databases<span class="w"> </span>&gt;<span class="w"> </span>/root/dump.sql
</span></code></pre></div>
<p>The <code>--single-transaction</code> flag takes a consistent snapshot without locking tables, which is important for InnoDB. Run both variants - if the InnoDB data is partially corrupted, one may succeed where the other fails.</p>
<div class="admonition warning">
<p class="admonition-title">Filesystem corruption</p>
<p>If you are dealing with filesystem-level corruption, copy your backup files to a different disk drive or a remote host. Do not keep your only copies on the potentially failing drive.</p>
</div>
<div class="interactive-quiz" data-config="{&quot;question&quot;: &quot;What should be your first action when discovering a corrupted InnoDB database?&quot;, &quot;type&quot;: &quot;multiple-choice&quot;, &quot;options&quot;: [{&quot;text&quot;: &quot;Immediately run mysqlcheck --repair on all databases&quot;, &quot;feedback&quot;: &quot;mysqlcheck --repair works for MyISAM tables. For InnoDB corruption, running repair commands without preparation can make things worse.&quot;}, {&quot;text&quot;: &quot;Stop MySQL and make a full copy of the data directory before attempting any recovery&quot;, &quot;correct&quot;: true, &quot;feedback&quot;: &quot;Correct! Always preserve the original data before any recovery attempt. Copy the entire MySQL data directory (especially ibdata1, ib_logfile*, and the database directories). Recovery tools work against the raw files, and without a backup, a failed recovery attempt can destroy your only copy.&quot;}, {&quot;text&quot;: &quot;Delete the ib_logfile files and restart MySQL&quot;, &quot;feedback&quot;: &quot;Deleting InnoDB log files without understanding the state can cause data loss. The logs may contain uncommitted transactions needed for recovery.&quot;}, {&quot;text&quot;: &quot;Restore from the most recent backup immediately&quot;, &quot;feedback&quot;: &quot;Restoring from backup is often the best path, but first preserve the current data directory. The backup might be outdated, and you may need the current files for recovering recent data.&quot;}]}"><noscript><p><strong>What should be your first action when discovering a corrupted InnoDB database?</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="assessing-the-situation">Assessing the Situation<a class="headerlink" href="#assessing-the-situation" title="Permanent link">&para;</a></h2>
<p>With your files backed up, the immediate time pressure is over. Take stock of what you are dealing with before proceeding.</p>
<h3 id="data-loss-severity">Data Loss Severity<a class="headerlink" href="#data-loss-severity" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Recovery Outlook</th>
</tr>
</thead>
<tbody>
<tr>
<td>Deleted rows</td>
<td>Good - recoverable if MySQL was stopped quickly</td>
</tr>
<tr>
<td>Truncated table</td>
<td>Moderate - partial to full recovery depending on time elapsed</td>
</tr>
<tr>
<td>Widespread corruption</td>
<td>Surprisingly recoverable - PDRT can succeed where <code>innodb_force_recovery</code> fails</td>
</tr>
<tr>
<td>Dropped table (file-per-table on)</td>
<td>Difficult - requires filesystem-level recovery of the deleted <code>.ibd</code> file first</td>
</tr>
</tbody>
</table>
<h3 id="existing-backups">Existing Backups<a class="headerlink" href="#existing-backups" title="Permanent link">&para;</a></h3>
<p>If you have older backups or dumps, they are valuable even if outdated. The table structure from an old backup can serve as the template for PDRT's <code>table_defs.h</code>, which is essential for the recovery process.</p>
<p>If the table still exists in a running MySQL instance, capture its structure now:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>mysql<span class="w"> </span>-NBe<span class="w"> </span><span class="s2">&quot;SHOW CREATE TABLE table_name&quot;</span><span class="w"> </span>database_name
</span></code></pre></div>
<h3 id="mysql-version">MySQL Version<a class="headerlink" href="#mysql-version" title="Permanent link">&para;</a></h3>
<p>Check your MySQL version - it determines which <code>constraints_parser</code> format flag to use:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>mysql<span class="w"> </span>-V
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Version</th>
<th>Format Flag</th>
</tr>
</thead>
<tbody>
<tr>
<td>MySQL 4.x (REDUNDANT format)</td>
<td><code>-4</code></td>
</tr>
<tr>
<td>MySQL 5.0 - 5.5 (COMPACT format)</td>
<td><code>-5</code></td>
</tr>
<tr>
<td>MySQL 5.6+ / MariaDB 10.x+</td>
<td><code>-6</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="installing-pdrt">Installing PDRT<a class="headerlink" href="#installing-pdrt" title="Permanent link">&para;</a></h2>
<p>The PDRT source is available from <a href="https://github.com/percona/percona-data-recovery-tool-for-innodb">Percona's GitHub repository</a>. The original Bazaar/Launchpad repository is no longer maintained.</p>
<h3 id="download-and-compile">Download and Compile<a class="headerlink" href="#download-and-compile" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">cd</span><span class="w"> </span>/root
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/percona/percona-data-recovery-tool-for-innodb.git<span class="w"> </span>pdrt
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="nb">cd</span><span class="w"> </span>pdrt/mysql-source
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>./configure
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="nb">cd</span><span class="w"> </span>..
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>make
</span></code></pre></div>
<h3 id="install-perl-dependencies">Install Perl Dependencies<a class="headerlink" href="#install-perl-dependencies" title="Permanent link">&para;</a></h3>
<p>The <code>create_defs.pl</code> script requires the <code>DBD::mysql</code> Perl module. Check if it is installed:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>perl<span class="w"> </span>-MDBD::mysql<span class="w"> </span>-e<span class="w"> </span><span class="m">1</span>
</span></code></pre></div>
<p>If this prints an error about not finding <code>DBD/mysql.pm</code>, install it. On cPanel servers:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>/scripts/perlinstaller<span class="w"> </span>DBD::mysql
</span></code></pre></div>
<p>On other systems:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>cpanm<span class="w"> </span>DBD::mysql
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c1"># Or via package manager:</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>apt<span class="w"> </span>install<span class="w"> </span>libdbd-mysql-perl<span class="w">    </span><span class="c1"># Debian/Ubuntu</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>dnf<span class="w"> </span>install<span class="w"> </span>perl-DBD-MySQL<span class="w">       </span><span class="c1"># RHEL/Fedora</span>
</span></code></pre></div>
<hr />
<h2 id="getting-your-table-structure">Getting Your Table Structure<a class="headerlink" href="#getting-your-table-structure" title="Permanent link">&para;</a></h2>
<p>Recovery requires a table definition that tells <code>constraints_parser</code> what row structure to look for. How you obtain this depends on whether MySQL is running.</p>
<h3 id="if-mysql-is-running">If MySQL Is Running<a class="headerlink" href="#if-mysql-is-running" title="Permanent link">&para;</a></h3>
<p><strong>1. Create a recovery database:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>mysql<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;CREATE DATABASE mydb_recovered&quot;</span>
</span></code></pre></div>
<p><strong>2. Extract the table structure:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>mysql<span class="w"> </span>-NBe<span class="w"> </span><span class="s2">&quot;SHOW CREATE TABLE customer&quot;</span><span class="w"> </span>mydb
</span></code></pre></div>
<p>This produces the full <code>CREATE TABLE</code> statement. Save it - you will need it to recreate the table in your recovery database.</p>
<p><strong>3. Recreate the table in the recovery database:</strong></p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">mysql</span><span class="w"> </span><span class="n">mydb_recovered</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="k">SET</span><span class="w"> </span><span class="n">foreign_key_checks</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">customer</span><span class="o">`</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">  </span><span class="o">`</span><span class="n">customer_id</span><span class="o">`</span><span class="w"> </span><span class="nb">smallint</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">  </span><span class="o">`</span><span class="n">store_id</span><span class="o">`</span><span class="w"> </span><span class="n">tinyint</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">  </span><span class="o">`</span><span class="n">first_name</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">  </span><span class="o">`</span><span class="n">last_name</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">45</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">  </span><span class="o">`</span><span class="n">email</span><span class="o">`</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">  </span><span class="o">`</span><span class="n">address_id</span><span class="o">`</span><span class="w"> </span><span class="nb">smallint</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">  </span><span class="o">`</span><span class="n">active</span><span class="o">`</span><span class="w"> </span><span class="n">tinyint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="w">  </span><span class="o">`</span><span class="n">create_date</span><span class="o">`</span><span class="w"> </span><span class="n">datetime</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="w">  </span><span class="o">`</span><span class="n">last_update</span><span class="o">`</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">  </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">customer_id</span><span class="o">`</span><span class="p">),</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">idx_fk_store_id</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">store_id</span><span class="o">`</span><span class="p">),</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">idx_fk_address_id</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">address_id</span><span class="o">`</span><span class="p">),</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="w">  </span><span class="k">KEY</span><span class="w"> </span><span class="o">`</span><span class="n">idx_last_name</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">last_name</span><span class="o">`</span><span class="p">),</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">fk_customer_address</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">address_id</span><span class="o">`</span><span class="p">)</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="w">    </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">address</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">address_id</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="w">  </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="o">`</span><span class="n">fk_customer_store</span><span class="o">`</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">store_id</span><span class="o">`</span><span class="p">)</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a><span class="w">    </span><span class="k">REFERENCES</span><span class="w"> </span><span class="o">`</span><span class="n">store</span><span class="o">`</span><span class="w"> </span><span class="p">(</span><span class="o">`</span><span class="n">store_id</span><span class="o">`</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="p">)</span><span class="w"> </span><span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Disabling foreign key checks</p>
<p><code>SET foreign_key_checks=0</code> is required when recreating tables that reference other tables. Without it, <code>CREATE TABLE</code> fails if the referenced tables do not exist yet in the recovery database.</p>
</div>
<h3 id="if-mysql-will-not-start">If MySQL Will Not Start<a class="headerlink" href="#if-mysql-will-not-start" title="Permanent link">&para;</a></h3>
<p><strong>1. Try <code>innodb_force_recovery</code>:</strong></p>
<p>Add to <code>my.cnf</code> under <code>[mysqld]</code>:</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="na">innodb_force_recovery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">1</span>
</span></code></pre></div>
<p>Start MySQL and try increasing the value from 1 through 6 until it starts. See the <a href="https://dev.mysql.com/doc/refman/8.0/en/forcing-innodb-recovery.html">MySQL documentation on forcing recovery</a> for what each level does.</p>
<p><strong>2. Reset the InnoDB files as a last resort:</strong></p>
<p>If no recovery level works, move the InnoDB files aside so MySQL recreates fresh ones:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nb">cd</span><span class="w"> </span>/var/lib/mysql
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>mv<span class="w"> </span>ibdata1<span class="w"> </span>ibdata1.bak
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>mv<span class="w"> </span>ib_logfile0<span class="w"> </span>ib_logfile0.bak
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>mv<span class="w"> </span>ib_logfile1<span class="w"> </span>ib_logfile1.bak
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>systemctl<span class="w"> </span>start<span class="w"> </span>mysql
</span></code></pre></div>
<p><strong>3. Extract structure from <code>.frm</code> files:</strong></p>
<p>If you have the <code>.frm</code> file but MySQL cannot read the table, copy the <code>.frm</code> to a working MySQL instance (into a database directory where you have created a placeholder table with the same name), restart MySQL, and run <code>SHOW CREATE TABLE</code>.</p>
<p>Alternatively, the <a href="https://dev.mysql.com/doc/mysql-utilities/1.6/en/">MySQL Utilities</a> package includes <code>mysqlfrm</code> for extracting structure directly from <code>.frm</code> files.</p>
<hr />
<h2 id="recovering-data">Recovering Data<a class="headerlink" href="#recovering-data" title="Permanent link">&para;</a></h2>
<p>At this point you should have:</p>
<ul>
<li>A copy of <code>ibdata1.recovery</code> and/or the relevant <code>.ibd</code> files</li>
<li>MySQL running with a recovery database containing the target table structures</li>
<li>PDRT compiled and ready</li>
</ul>
<h3 id="automated-recovery">Automated Recovery<a class="headerlink" href="#automated-recovery" title="Permanent link">&para;</a></h3>
<p>Generate the table definitions, compile, and run <code>constraints_parser</code> in one workflow:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nb">cd</span><span class="w"> </span>/root/pdrt
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="c1"># Generate table definitions from the recovery database</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="nv">DB</span><span class="o">=</span>mydb_recovered
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="nv">TBL</span><span class="o">=</span>customer
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>perl<span class="w"> </span>create_defs.pl<span class="w"> </span><span class="se">\</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">  </span>--host<span class="o">=</span>localhost<span class="w"> </span><span class="se">\</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">  </span>--user<span class="o">=</span>root<span class="w"> </span><span class="se">\</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">  </span>--password<span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>grep<span class="w"> </span>pass<span class="w"> </span>/root/.my.cnf<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="o">=</span><span class="w"> </span>-f2<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/^&quot;//&#39;</span><span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/&quot;$//&#39;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">  </span>--db<span class="o">=</span><span class="nv">$DB</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">  </span>--table<span class="o">=</span><span class="nv">$TBL</span><span class="w"> </span>&gt;<span class="w"> </span>include/table_defs.h
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="c1"># Recompile with the new definitions</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>make<span class="w"> </span>clean<span class="w"> </span>all
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="c1"># Run constraints_parser against the data file</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>dumps/default
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>./constraints_parser<span class="w"> </span>-5<span class="w"> </span>-f<span class="w"> </span>/root/innodb.bak/mydb/customer.ibd<span class="w"> </span>&gt;<span class="w"> </span>dumps/default/customer
</span></code></pre></div>
<p>The output file <code>dumps/default/customer</code> contains tab-separated values for every row that matched the table definition. It will include both valid data and noise - rows where random data happened to match the column structure.</p>
<div class="interactive-terminal" data-config="{&quot;title&quot;: &quot;Running constraints_parser for Data Recovery&quot;, &quot;steps&quot;: [{&quot;command&quot;: &quot;cd /root/pdrt &amp;&amp; ./constraints_parser -5 -f /var/lib/mysql/ibdata1.recovery&quot;, &quot;output&quot;: &quot;-- Parsing InnoDB tablespace: /var/lib/mysql/ibdata1.recovery\n-- Page size: 16384 bytes\n-- Scanning pages...\n-- Found 15234 candidate rows\n-- 14891 rows passed all constraints\n-- Output written to dumps/default/customer\n&quot;, &quot;narration&quot;: &quot;constraints_parser scans the raw tablespace file using the compiled table definition to identify valid rows. The -5 flag selects COMPACT row format for MySQL 5.x. 14891 of 15234 candidate rows passed validation. The 343 failures are likely corrupted or irrelevant pages.&quot;}, {&quot;command&quot;: &quot;head -3 dumps/default/customer&quot;, &quot;output&quot;: &quot;customer\t1\t1\t\&quot;MARY\&quot;\t\&quot;SMITH\&quot;\t\&quot;MARY.SMITH@sakilacustomer.org\&quot;\t5\t1\t\&quot;2006-02-14 22:04:36\&quot;\t\&quot;2006-02-15 04:57:20\&quot;\ncustomer\t2\t1\t\&quot;PATRICIA\&quot;\t\&quot;JOHNSON\&quot;\t\&quot;PATRICIA.JOHNSON@sakilacustomer.org\&quot;\t6\t1\t\&quot;2006-02-14 22:04:36\&quot;\t\&quot;2006-02-15 04:57:20\&quot;\ncustomer\t3\t1\t\&quot;LINDA\&quot;\t\&quot;WILLIAMS\&quot;\t\&quot;LINDA.WILLIAMS@sakilacustomer.org\&quot;\t7\t1\t\&quot;2006-02-14 22:04:36\&quot;\t\&quot;2006-02-15 04:57:20\&quot;\n&quot;, &quot;narration&quot;: &quot;Output is tab-separated values matching the table definition columns. Each line starts with the table name. This can be loaded into a fresh MySQL table with LOAD DATA INFILE.&quot;}, {&quot;command&quot;: &quot;mysql -e \&quot;LOAD DATA LOCAL INFILE &#39;dumps/default/customer&#39; INTO TABLE customer FIELDS TERMINATED BY &#39;\\t&#39; OPTIONALLY ENCLOSED BY &#39;\\\&quot;&#39; LINES STARTING BY &#39;customer\\t&#39;\&quot; mydb_recovered&quot;, &quot;output&quot;: &quot;Query OK, 14891 rows affected (0.42 sec)&quot;, &quot;narration&quot;: &quot;Import the recovered data into the recovery database. The LINES STARTING BY clause skips the table name prefix. Verify row counts and spot-check data integrity after import.&quot;}]}"><noscript><p><strong>Running constraints_parser for Data Recovery</strong> (requires JavaScript)</p></noscript></div>
<h3 id="manual-method-with-custom-definitions">Manual Method with Custom Definitions<a class="headerlink" href="#manual-method-with-custom-definitions" title="Permanent link">&para;</a></h3>
<p>If the automated approach produces too much noise, you can run the tools manually with more control. Generate the table definitions:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nb">cd</span><span class="w"> </span>/root/pdrt
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="nv">DB</span><span class="o">=</span>mydb_recovered<span class="p">;</span><span class="w"> </span><span class="nv">TBL</span><span class="o">=</span>customer
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>perl<span class="w"> </span>create_defs.pl<span class="w"> </span>--host<span class="o">=</span>localhost<span class="w"> </span>--user<span class="o">=</span>root<span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">  </span>--password<span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>grep<span class="w"> </span>pass<span class="w"> </span>/root/.my.cnf<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="o">=</span><span class="w"> </span>-f2<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s/^&quot;//;s/&quot;$//&#39;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">  </span>--db<span class="o">=</span><span class="nv">$DB</span><span class="w"> </span>--table<span class="o">=</span><span class="nv">$TBL</span><span class="w"> </span>&gt;<span class="w"> </span>include/table_defs.h
</span></code></pre></div>
<p>Recompile and run:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>make<span class="w"> </span>clean<span class="w"> </span>all
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>./constraints_parser<span class="w"> </span>-5<span class="w"> </span>-f<span class="w"> </span>/var/lib/mysql/ibdata1.recovery<span class="w"> </span>&gt;<span class="w"> </span>recovery_output.tsv
</span></code></pre></div>
<p>To search specifically for deleted records, add the <code>-D</code> flag:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>./constraints_parser<span class="w"> </span>-5<span class="w"> </span>-Df<span class="w"> </span>/root/innodb.bak/mydb/customer.ibd
</span></code></pre></div>
<hr />
<h2 id="tuning-table-definitions">Tuning Table Definitions<a class="headerlink" href="#tuning-table-definitions" title="Permanent link">&para;</a></h2>
<p>The default <code>table_defs.h</code> generated by <code>create_defs.pl</code> uses broad constraints that match many false positives. Tightening the constraints dramatically reduces noise in the recovery output.</p>
<p>Here is the auto-generated definition for a <code>first_name</code> column:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">{</span><span class="w"> </span><span class="cm">/* varchar(45) */</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;first_name&quot;</span><span class="p">,</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">    </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="n">FT_CHAR</span><span class="p">,</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">    </span><span class="nl">min_length</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">    </span><span class="nl">max_length</span><span class="p">:</span><span class="w"> </span><span class="mi">135</span><span class="p">,</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">    </span><span class="nl">has_limits</span><span class="p">:</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">    </span><span class="nl">limits</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">        </span><span class="nl">can_be_null</span><span class="p">:</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">        </span><span class="nl">char_min_len</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">        </span><span class="nl">char_max_len</span><span class="p">:</span><span class="w"> </span><span class="mi">135</span><span class="p">,</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">        </span><span class="nl">char_ascii_only</span><span class="p">:</span><span class="w"> </span><span class="n">TRUE</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">    </span><span class="nl">can_be_null</span><span class="p">:</span><span class="w"> </span><span class="n">FALSE</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="p">},</span>
</span></code></pre></div>
<p>The key field is <code>has_limits: FALSE</code> - with limits disabled, <code>constraints_parser</code> accepts any data that structurally fits the column type. Enabling limits and tightening them filters out garbage data:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Default</th>
<th>Tuned</th>
<th>Reasoning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>has_limits</code></td>
<td><code>FALSE</code></td>
<td><code>TRUE</code></td>
<td>Enable constraint checking</td>
</tr>
<tr>
<td><code>can_be_null</code></td>
<td><code>FALSE</code></td>
<td><code>FALSE</code></td>
<td>Every customer has a first name</td>
</tr>
<tr>
<td><code>char_min_len</code></td>
<td><code>0</code></td>
<td><code>2</code></td>
<td>No single-character first names in this dataset</td>
</tr>
<tr>
<td><code>char_max_len</code></td>
<td><code>135</code></td>
<td><code>30</code></td>
<td>No first name exceeds 30 characters</td>
</tr>
<tr>
<td><code>char_ascii_only</code></td>
<td><code>TRUE</code></td>
<td><code>TRUE</code></td>
<td>Names in this table are ASCII</td>
</tr>
</tbody>
</table>
<p>The tuned definition:</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="p">{</span><span class="w"> </span><span class="cm">/* varchar(45) */</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;first_name&quot;</span><span class="p">,</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="n">FT_CHAR</span><span class="p">,</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">    </span><span class="nl">min_length</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">    </span><span class="nl">max_length</span><span class="p">:</span><span class="w"> </span><span class="mi">135</span><span class="p">,</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">    </span><span class="nl">has_limits</span><span class="p">:</span><span class="w"> </span><span class="n">TRUE</span><span class="p">,</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">    </span><span class="nl">limits</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">        </span><span class="nl">can_be_null</span><span class="p">:</span><span class="w"> </span><span class="n">FALSE</span><span class="p">,</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">        </span><span class="nl">char_min_len</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="w">        </span><span class="nl">char_max_len</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="w">        </span><span class="nl">char_ascii_only</span><span class="p">:</span><span class="w"> </span><span class="n">TRUE</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">    </span><span class="nl">can_be_null</span><span class="p">:</span><span class="w"> </span><span class="n">FALSE</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="p">},</span>
</span></code></pre></div>
<p>After editing <code>include/table_defs.h</code>, recompile and run again:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nb">cd</span><span class="w"> </span>/root/pdrt<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>clean<span class="w"> </span>all
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>./constraints_parser<span class="w"> </span>-5<span class="w"> </span>-Df<span class="w"> </span>/root/innodb.bak/mydb/customer.ibd
</span></code></pre></div>
<p>With tightened constraints, a search that previously returned thousands of false positives may return exactly the rows you need.</p>
<div class="interactive-quiz" data-config="{&quot;question&quot;: &quot;What effect does setting has_limits to TRUE in table_defs.h have on constraints_parser output?&quot;, &quot;type&quot;: &quot;multiple-choice&quot;, &quot;options&quot;: [{&quot;text&quot;: &quot;It makes the recovery process faster by skipping pages&quot;, &quot;feedback&quot;: &quot;has_limits does not affect which pages are scanned. It affects which candidate rows pass validation after being found.&quot;}, {&quot;text&quot;: &quot;It enables the constraint fields (char_min_len, char_max_len, can_be_null) to filter out rows that do not match your expected data patterns&quot;, &quot;correct&quot;: true, &quot;feedback&quot;: &quot;Correct! With has_limits set to TRUE, constraints_parser uses the limits block to validate each candidate row. Rows where a column value falls outside the specified min/max length, contains nulls when not allowed, or has non-ASCII characters when ascii_only is set are filtered out. This dramatically reduces false positives in the output.&quot;}, {&quot;text&quot;: &quot;It prevents constraints_parser from overwriting existing data files&quot;, &quot;feedback&quot;: &quot;constraints_parser is a read-only tool. It never writes to the source data files regardless of the has_limits setting.&quot;}, {&quot;text&quot;: &quot;It changes the output format from tab-separated to CSV&quot;, &quot;feedback&quot;: &quot;The output format is always tab-separated. has_limits only affects which rows are included in the output.&quot;}]}"><noscript><p><strong>What effect does setting has_limits to TRUE in table_defs.h have on constraints_parser output?</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="importing-recovered-data">Importing Recovered Data<a class="headerlink" href="#importing-recovered-data" title="Permanent link">&para;</a></h2>
<p>Once you have clean recovery output, you need to import it back into MySQL. The <code>constraints_parser</code> output includes both the data (on stdout) and the <code>LOAD DATA INFILE</code> SQL statement (on stderr).</p>
<h3 id="splitting-output-and-sql">Splitting Output and SQL<a class="headerlink" href="#splitting-output-and-sql" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>/root/pdrt/dumps/mydb_recovered
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>./constraints_parser<span class="w"> </span>-5<span class="w"> </span>-Df<span class="w"> </span>/root/innodb.bak/mydb/customer.ibd<span class="w"> </span>-p<span class="w"> </span>mydb_recovered<span class="w"> </span><span class="se">\</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">  </span>&gt;<span class="w"> </span>dumps/mydb_recovered/customer<span class="w"> </span><span class="se">\</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">  </span><span class="m">2</span>&gt;<span class="w"> </span>customer.sql
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="c1"># Remove progress lines from the SQL file</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;/done/d&#39;</span><span class="w"> </span>customer.sql
</span></code></pre></div>
<p>The <code>-p mydb_recovered</code> flag sets the dump path prefix in the generated <code>LOAD DATA</code> statement. The SQL file will contain something like:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">SET</span><span class="w"> </span><span class="n">FOREIGN_KEY_CHECKS</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">LOAD</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="n">INFILE</span><span class="w"> </span><span class="s1">&#39;/root/pdrt/dumps/mydb_recovered/customer&#39;</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">  </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="o">`</span><span class="n">customer</span><span class="o">`</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">  </span><span class="n">FIELDS</span><span class="w"> </span><span class="n">TERMINATED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;\t&#39;</span><span class="w"> </span><span class="n">OPTIONALLY</span><span class="w"> </span><span class="n">ENCLOSED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;&quot;&#39;</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">  </span><span class="n">LINES</span><span class="w"> </span><span class="n">STARTING</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;customer\t&#39;</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">  </span><span class="p">(</span><span class="o">`</span><span class="n">customer_id</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">store_id</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">first_name</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">last_name</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">email</span><span class="o">`</span><span class="p">,</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">   </span><span class="o">`</span><span class="n">address_id</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">active</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">create_date</span><span class="o">`</span><span class="p">,</span><span class="w"> </span><span class="o">`</span><span class="n">last_update</span><span class="o">`</span><span class="p">);</span>
</span></code></pre></div>
<p>The <code>LINES STARTING BY 'customer\t'</code> clause is important - it skips all the page metadata comments in the dump file and only imports lines that begin with the table name followed by a tab.</p>
<h3 id="running-the-import">Running the Import<a class="headerlink" href="#running-the-import" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>mysql<span class="w"> </span>mydb_recovered<span class="w"> </span>&lt;<span class="w"> </span>/root/pdrt/customer.sql
</span></code></pre></div>
<p>If you get an error about being unable to stat the dump file:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>ERROR 13 (HY000) at line 2: Can&#39;t get stat of &#39;/root/pdrt/dumps/mydb_recovered/customer&#39; (Errcode: 13)
</span></code></pre></div>
<p>Change <code>LOAD DATA INFILE</code> to <code>LOAD DATA LOCAL INFILE</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s/LOAD DATA INFILE/LOAD DATA LOCAL INFILE/g&#39;</span><span class="w"> </span>/root/pdrt/customer.sql
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>mysql<span class="w"> </span>mydb_recovered<span class="w"> </span>&lt;<span class="w"> </span>/root/pdrt/customer.sql
</span></code></pre></div>
<h3 id="verifying-the-results">Verifying the Results<a class="headerlink" href="#verifying-the-results" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>mysql<span class="w"> </span>mydb_recovered<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;SELECT COUNT(*) FROM customer&quot;</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>mysql<span class="w"> </span>mydb_recovered<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;SELECT * FROM customer LIMIT 5&quot;</span>
</span></code></pre></div>
<p>Compare row counts and spot-check data against any existing backups or dumps you have.</p>
<div class="interactive-code-walkthrough" data-config="{&quot;language&quot;: &quot;bash&quot;, &quot;title&quot;: &quot;Complete PDRT Recovery Workflow&quot;, &quot;code&quot;: &quot;systemctl stop mysql\ncp -a /var/lib/mysql /var/lib/mysql.backup\ncd /root/pdrt\nperl create_defs.pl --host=localhost --user=root --db=mydb_recovered --table=customer > include/table_defs.h\nmake clean all\nmkdir -p dumps/mydb_recovered\n./constraints_parser -5 -Df /var/lib/mysql.backup/mydb/customer.ibd -p mydb_recovered > dumps/mydb_recovered/customer 2> customer.sql\nsed -i &#39;/done/d&#39; customer.sql\nsed -i &#39;s/LOAD DATA INFILE/LOAD DATA LOCAL INFILE/g&#39; customer.sql\nmysql mydb_recovered < customer.sql\n&quot;, &quot;annotations&quot;: [{&quot;line&quot;: 1, &quot;text&quot;: &quot;Stop MySQL first. Preventing new writes protects recoverable data from being overwritten.&quot;}, {&quot;line&quot;: 2, &quot;text&quot;: &quot;Copy the entire data directory BEFORE any recovery attempt. cp -a preserves permissions and ownership. This is your safety net.&quot;}, {&quot;line&quot;: 4, &quot;text&quot;: &quot;create_defs.pl generates the table_defs.h header from the MySQL schema. If MySQL will not start, you need to write this manually from a backup of the schema.&quot;}, {&quot;line&quot;: 5, &quot;text&quot;: &quot;Recompile PDRT with the new table definitions. The constraints are compiled into the binary, so this step is required after every table_defs.h change.&quot;}, {&quot;line&quot;: 7, &quot;text&quot;: &quot;Run constraints_parser against the .ibd file (file-per-table) or ibdata1 (shared tablespace). The -5 flag selects COMPACT page format. The -D flag targets deleted rows specifically.&quot;}, {&quot;line&quot;: 8, &quot;text&quot;: &quot;Strip progress percentage lines from the SQL file. Only valid SQL statements should remain.&quot;}, {&quot;line&quot;: 9, &quot;text&quot;: &quot;Fix the LOCAL INFILE issue that occurs on most MySQL installations. Without LOCAL, MySQL tries to read the file as the mysqld process, which usually lacks permission.&quot;}, {&quot;line&quot;: 10, &quot;text&quot;: &quot;Import the recovered data into the recovery database. Verify row counts and spot-check data integrity after import.&quot;}]}"><noscript><p><strong>Complete PDRT Recovery Workflow</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="recovery-decision-flowchart">Recovery Decision Flowchart<a class="headerlink" href="#recovery-decision-flowchart" title="Permanent link">&para;</a></h2>
<p>Use this to determine your recovery path based on the scenario:</p>
<pre class="mermaid"><code>flowchart TD
    A[Data Loss Detected] --&gt; B{MySQL Running?}
    B --&gt;|Yes| C[Stop MySQL Immediately]
    B --&gt;|No| D[Do NOT Start MySQL]
    C --&gt; E[Backup ibdata1, .ibd, .frm, ib_logfile*]
    D --&gt; E
    E --&gt; F{What happened?}
    F --&gt;|Deleted rows| G[Use constraints_parser with -D flag on .ibd file]
    F --&gt;|Truncated table| H[Use constraints_parser on .ibd file]
    F --&gt;|Dropped table| I{Have .ibd file backup?}
    F --&gt;|Corruption| J[Try innodb_force_recovery first]
    I --&gt;|Yes| G
    I --&gt;|No| K[Filesystem recovery needed]
    J --&gt;|MySQL starts| L[mysqldump + PDRT on ibdata1]
    J --&gt;|Still fails| M[Reset ib* files + PDRT on ibdata1.recovery]
    G --&gt; N[Tune table_defs.h and iterate]
    H --&gt; N
    L --&gt; N
    M --&gt; N
    N --&gt; O[Import via LOAD DATA INFILE]</code></pre>
<hr />
<h2 id="practical-exercise">Practical Exercise<a class="headerlink" href="#practical-exercise" title="Permanent link">&para;</a></h2>
<div class="interactive-exercise" data-config="{&quot;title&quot;: &quot;PDRT Recovery Planning&quot;, &quot;type&quot;: &quot;scenario&quot;, &quot;scenario&quot;: &quot;You are a sysadmin on a cPanel server running MySQL 5.7 with innodb_file_per_table=ON. A developer accidentally ran `DELETE FROM orders WHERE status = &#39;pending&#39;` without a WHERE clause on the date column, deleting 3 months of pending orders (approximately 50,000 rows). The developer noticed the mistake 2 minutes later and contacted you. MySQL is still running. The `orders` table still exists with its remaining data (completed and shipped orders are unaffected).\n\nPlan your recovery steps.\n&quot;, &quot;tasks&quot;: [{&quot;task&quot;: &quot;What is your first action and why?&quot;, &quot;hint&quot;: &quot;Think about what is happening to the deleted data right now while MySQL is running.&quot;, &quot;answer&quot;: &quot;Stop MySQL immediately with `systemctl stop mysql`. The deleted rows are marked as free space in the .ibd file, and InnoDB will reuse those pages for new writes. Every second MySQL runs increases the chance of overwriting recoverable data.&quot;}, {&quot;task&quot;: &quot;Which files do you need to back up, and what commands would you use?&quot;, &quot;hint&quot;: &quot;Consider which InnoDB files contain the data you need to recover.&quot;, &quot;answer&quot;: &quot;Back up the orders table .ibd file and the system tablespace: `mkdir /root/recovery &amp;&amp; cd /var/lib/mysql &amp;&amp; dd if=ibdata1 of=/root/recovery/ibdata1.recovery conv=noerror &amp;&amp; cp -a ./mydb/orders.ibd /root/recovery/ &amp;&amp; cp -a ./mydb/orders.frm /root/recovery/`&quot;}, {&quot;task&quot;: &quot;Which constraints_parser flags would you use and why?&quot;, &quot;hint&quot;: &quot;Consider the MySQL version and whether you want deleted rows specifically.&quot;, &quot;answer&quot;: &quot;Use `-5 -Df`: `-5` for MySQL 5.7 COMPACT format, `-D` to specifically target deleted rows (the rows you want to recover were DELETEd), and `-f` to specify the .ibd file path. Run against the backup copy: `./constraints_parser -5 -Df /root/recovery/orders.ibd`&quot;}, {&quot;task&quot;: &quot;After recovering the data, how would you verify the recovery was successful?&quot;, &quot;hint&quot;: &quot;Think about what you know about the deleted data.&quot;, &quot;answer&quot;: &quot;Compare the recovered row count against the expected ~50,000 deleted rows. Check that all recovered rows have status=&#39;pending&#39;. Verify date ranges look correct. Cross-reference with any application logs that recorded order IDs. Import into the recovery database and run `SELECT COUNT(*), MIN(order_date), MAX(order_date) FROM orders WHERE status=&#39;pending&#39;` to sanity-check the data.&quot;}]}"><noscript><p><strong>PDRT Recovery Planning</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="further-reading">Further Reading<a class="headerlink" href="#further-reading" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-storage-engine.html">MySQL InnoDB Storage Engine Documentation</a> - official InnoDB reference for file formats, recovery, and configuration</li>
<li><a href="https://github.com/percona/percona-data-recovery-tool-for-innodb">Percona Data Recovery Tool (GitHub)</a> - PDRT source code and documentation</li>
<li><a href="https://dev.mysql.com/doc/refman/8.0/en/forcing-innodb-recovery.html">InnoDB Recovery with innodb_force_recovery</a> - MySQL documentation on the force recovery levels</li>
<li><a href="https://docs.percona.com/percona-xtrabackup/8.0/">Percona XtraBackup</a> - hot backup tool for InnoDB that avoids the need for PDRT in many scenarios</li>
<li><a href="https://www.percona.com/blog/how-to-recover-a-single-innodb-table-from-a-full-backup/">How to Recover a Single InnoDB Table from a Full Backup</a> - Percona blog on targeted table recovery</li>
</ul>
<hr />
<p><strong>Previous:</strong> <a href="../scaling-and-architecture/">Scaling &amp; Architecture Patterns</a> | <a href="../">Back to Index</a></p>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve by <a href="https://github.com/ringo380/guides/issues/new?template=content-improvement.yml&title=[Feedback]+InnoDB%20Recovery%20with%20PDRT" target="_blank" rel="noopener">opening an issue</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>

<!-- SPDX-License-Identifier: MIT | Copyright (c) 2025-2026 Robworks Software LLC -->
<!-- Giscus comments - GitHub Discussions-backed -->

  <h2 id="__comments">Comments</h2>

  <script
    src="https://giscus.app/client.js"
    data-repo="ringo380/guides"
    data-repo-id="R_kgDOM3QMrQ"
    data-category="General"
    data-category-id="DIC_kwDOM3QMrc4C2qV9"
    data-mapping="pathname"
    data-strict="1"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>

                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025-2026 Robworks Software LLC
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ringo380" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/robworks" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://bsky.app/profile/lessoncraft.bsky.social" target="_blank" rel="noopener" title="bsky.app" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M407.8 294.7c-3.3-.4-6.7-.8-10-1.3 3.4.4 6.7.9 10 1.3M288 227.1c-26.1-50.7-97.1-145.2-163.1-191.8C61.6-9.4 37.5-1.7 21.6 5.5 3.3 13.8 0 41.9 0 58.4S9.1 194 15 213.9c19.5 65.7 89.1 87.9 153.2 80.7 3.3-.5 6.6-.9 10-1.4-3.3.5-6.6 1-10 1.4-93.9 14-177.3 48.2-67.9 169.9C220.6 589.1 265.1 437.8 288 361.1c22.9 76.7 49.2 222.5 185.6 103.4 102.4-103.4 28.1-156-65.8-169.9-3.3-.4-6.7-.8-10-1.3 3.4.4 6.7.9 10 1.3 64.1 7.1 133.6-15.1 153.2-80.7C566.9 194 576 75 576 58.4s-3.3-44.7-21.6-52.9c-15.8-7.1-40-14.9-103.2 29.8C385.1 81.9 314.1 176.4 288 227.1"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://mastodon.social/@runbook" target="_blank" rel="noopener me" title="mastodon.social" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M433 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54-.6-4.6-.9-9.3-.9-13.9 85.6 20.9 158.7 9.1 178.7 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6V190.1c0-49.7-64-51.6-64 6.9v62.5H201V197c0-58.5-64-56.6-64-6.9v114.2H90.3c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://threads.net/@robworks_software" target="_blank" rel="noopener" title="threads.net" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M331.5 235.7c2.2.9 4.2 1.9 6.3 2.8 29.2 14.1 50.6 35.2 61.8 61.4 15.7 36.5 17.2 95.8-30.3 143.2-36.2 36.2-80.3 52.5-142.6 53h-.3c-70.2-.5-124.1-24.1-160.4-70.2-32.3-41-48.9-98.1-49.5-169.6v-.5c.5-71.5 17.1-128.6 49.4-169.6 36.3-46.1 90.3-69.7 160.5-70.2h.3c70.3.5 124.9 24 162.3 69.9 18.4 22.7 32 50 40.6 81.7l-40.4 10.8c-7.1-25.8-17.8-47.8-32.2-65.4-29.2-35.8-73-54.2-130.5-54.6-57 .5-100.1 18.8-128.2 54.4C72.1 146.1 58.5 194.3 58 256c.5 61.7 14.1 109.9 40.3 143.3 28 35.6 71.2 53.9 128.2 54.4 51.4-.4 85.4-12.6 113.7-40.9 32.3-32.2 31.7-71.8 21.4-95.9-6.1-14.2-17.1-26-31.9-34.9-3.7 26.9-11.8 48.3-24.7 64.8-17.1 21.8-41.4 33.6-72.7 35.3-23.6 1.3-46.3-4.4-63.9-16-20.8-13.8-33-34.8-34.3-59.3-2.5-48.3 35.7-83 95.2-86.4 21.1-1.2 40.9-.3 59.2 2.8-2.4-14.8-7.3-26.6-14.6-35.2-10-11.7-25.6-17.7-46.2-17.8h-.7c-16.6 0-39 4.6-53.3 26.3l-34.4-23.6c19.2-29.1 50.3-45.1 87.8-45.1h.8c62.6.4 99.9 39.5 103.7 107.7l-.2.2zm-156 68.8c1.3 25.1 28.4 36.8 54.6 35.3 25.6-1.4 54.6-11.4 59.5-73.2-13.2-2.9-27.8-4.4-43.4-4.4-4.8 0-9.6.1-14.4.4-42.9 2.4-57.2 23.2-56.2 41.8z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



  

<h4>Cookie consent</h4>
<p>We use cookies to recognize repeat visits and measure engagement with guides. With your consent, you help us improve the content.</p>
<input class="md-toggle" type="checkbox" id="__settings" checked>
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
      
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.tracking", "navigation.indexes", "search.suggest", "search.highlight", "content.code.copy", "content.action.edit"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../assets/javascripts/interactive.js"></script>
      
        <script src="../../assets/javascripts/giscus-theme.js"></script>
      
        <script src="../../assets/javascripts/lightbox.js"></script>
      
        <script src="../../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>