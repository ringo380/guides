
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Practical technical guides on Linux, DNS, Git, databases, and development">
      
      
        <meta name="author" content="Ryan Robson">
      
      
        <link rel="canonical" href="https://ringo380.github.io/guides/Databases/database-security/">
      
      
        <link rel="prev" href="../backup-and-recovery/">
      
      
        <link rel="next" href="../scaling-and-architecture/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Database Security - The Runbook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/interactive.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/lightbox.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-56L2QXTFGR"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-56L2QXTFGR",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-56L2QXTFGR",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
  
<meta property="og:type" content="website" />
<meta property="og:title" content="Database Security - The Runbook" />
<meta property="og:description" content="Practical technical guides on Linux, DNS, Git, databases, and development" />
<meta property="og:image" content="https://ringo380.github.io/guides/assets/images/social/Databases/database-security.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:url" content="https://ringo380.github.io/guides/Databases/database-security/" />
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content="Database Security - The Runbook" />
<meta property="twitter:description" content="Practical technical guides on Linux, DNS, Git, databases, and development" />
<meta property="twitter:image" content="https://ringo380.github.io/guides/assets/images/social/Databases/database-security.png" />
</head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#database-security" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="The Runbook" class="md-header__button md-logo" aria-label="The Runbook" data-md-component="logo">
      
  <img src="../../assets/images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The Runbook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Database Security
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ringo380/guides" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ringo380/guides
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Linux%20Essentials/" class="md-tabs__link">
          
  
  
    
  
  Linux Essentials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../DNS%20Administration/" class="md-tabs__link">
          
  
  
    
  
  DNS Administration

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Git/" class="md-tabs__link">
          
  
  
    
  
  Git

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Databases

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Dev%20Zero/Perl/" class="md-tabs__link">
          
  
  
    
  
  Dev Zero

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="The Runbook" class="md-nav__button md-logo" aria-label="The Runbook" data-md-component="logo">
      
  <img src="../../assets/images/logo.svg" alt="logo">

    </a>
    The Runbook
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ringo380/guides" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ringo380/guides
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Linux%20Essentials/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Linux Essentials
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linux Essentials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/shell-basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Shell Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/streams-and-redirection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streams and Redirection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/text-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Text Processing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/finding-files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Finding Files
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/file-permissions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File Permissions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/job-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Job Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/scripting-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scripting Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/disk-and-filesystem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Disk and Filesystem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Networking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/system-information/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System Information
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/archiving-and-compression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Archiving and Compression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linux%20Essentials/best-practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Best Practices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../DNS%20Administration/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    DNS Administration
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    DNS Administration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dns-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/zone-files-and-records/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Zone Files and Records
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dns-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Tools and Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/bind/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BIND
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/nsd-and-unbound/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NSD and Unbound
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/powerdns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PowerDNS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dnssec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNSSEC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DNS%20Administration/dns-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Architecture and Operations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Git/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Git
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Git
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/three-trees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Three Trees
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/commits-and-history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Commits and History
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/branches-and-merging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Branches and Merging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/remote-repositories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Remote Repositories
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/rewriting-history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rewriting History
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/stashing-and-worktree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stashing and the Worktree
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/configuring-git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring Git
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/object-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Object Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/refs-reflog-dag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Refs, the Reflog, and the DAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/transfer-protocols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transfer Protocols
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/collaboration-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collaboration Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/platforms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Platforms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/hooks-and-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hooks and Automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/monorepos-and-scaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monorepos and Scaling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Git/troubleshooting-and-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting and Recovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Databases
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Databases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql-essentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL Essentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Design & Modeling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-installation-and-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Installation & Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-administration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Administration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Performance & Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mysql-replication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL Replication & HA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-administration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Administration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postgresql-advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL Advanced Features
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nosql-concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NoSQL Concepts & Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mongodb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MongoDB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../redis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backup-and-recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backup & Recovery Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Database Security
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Security
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#authentication-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Authentication Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#password-based-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        Password-Based Authentication
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-based-authentication-x509" class="md-nav__link">
    <span class="md-ellipsis">
      
        Certificate-Based Authentication (x509)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        LDAP Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerberosgssapi-and-pam" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kerberos/GSSAPI and PAM
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tlsssl-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        TLS/SSL Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TLS/SSL Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generating Certificates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-tls-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        MySQL TLS Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgresql-tls-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL TLS Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-encrypted-connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verifying Encrypted Connections
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encryption-at-rest" class="md-nav__link">
    <span class="md-ellipsis">
      
        Encryption at Rest
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Encryption at Rest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#transparent-data-encryption-tde" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transparent Data Encryption (TDE)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#column-level-encryption-with-pgcrypto" class="md-nav__link">
    <span class="md-ellipsis">
      
        Column-Level Encryption with pgcrypto
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filesystem-level-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      
        Filesystem-Level Encryption
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-injection-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      
        SQL Injection Prevention
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL Injection Prevention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-problem-string-concatenation" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Problem: String Concatenation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-solution-parameterized-queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Solution: Parameterized Queries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stored-procedures-as-a-defense-layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stored Procedures as a Defense Layer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#input-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Input Validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#orm-safety" class="md-nav__link">
    <span class="md-ellipsis">
      
        ORM Safety
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audit-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Audit Logging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Audit Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mysql-enterprise-audit" class="md-nav__link">
    <span class="md-ellipsis">
      
        MySQL Enterprise Audit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgresql-pgaudit" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL pgAudit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-to-log" class="md-nav__link">
    <span class="md-ellipsis">
      
        What to Log
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Log Management
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privilege-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      
        Privilege Hardening
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Privilege Hardening">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#separate-accounts-by-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Separate Accounts by Function
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-privilege-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      
        MySQL Privilege Hardening
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgresql-privilege-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL Privilege Hardening
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoiding-grant-all" class="md-nav__link">
    <span class="md-ellipsis">
      
        Avoiding GRANT ALL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-level-restrictions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Network-Level Restrictions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#owasp-database-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        OWASP Database Security
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OWASP Database Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#top-database-security-risks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Top Database Security Risks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Checklist
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercises" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exercises
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Further Reading
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaling-and-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scaling & Architecture Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../innodb-recovery-pdrt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    InnoDB Recovery with PDRT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Dev Zero
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Dev Zero
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Dev%20Zero/Perl/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Perl
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Perl
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/perl_dev0_introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/scalars-strings-numbers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scalars, Strings, and Numbers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/arrays-hashes-lists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Arrays, Hashes, and Lists
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/control-flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Control Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/regular-expressions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regular Expressions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/subroutines-references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Subroutines and References
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/file-io-and-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File I/O and System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/modules-and-cpan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modules and CPAN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/object-oriented-perl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Object-Oriented Perl
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/error-handling-debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Handling and Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/text-processing-oneliners/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Text Processing and One-Liners
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/networking-daemons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Networking and Daemons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/web-frameworks-apis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web Frameworks and APIs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Dev%20Zero/Perl/perl_developer_roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Developer Roadmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#authentication-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Authentication Methods
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#password-based-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        Password-Based Authentication
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-based-authentication-x509" class="md-nav__link">
    <span class="md-ellipsis">
      
        Certificate-Based Authentication (x509)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        LDAP Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerberosgssapi-and-pam" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kerberos/GSSAPI and PAM
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tlsssl-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        TLS/SSL Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TLS/SSL Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generating-certificates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generating Certificates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-tls-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        MySQL TLS Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgresql-tls-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL TLS Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verifying-encrypted-connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verifying Encrypted Connections
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encryption-at-rest" class="md-nav__link">
    <span class="md-ellipsis">
      
        Encryption at Rest
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Encryption at Rest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#transparent-data-encryption-tde" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transparent Data Encryption (TDE)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#column-level-encryption-with-pgcrypto" class="md-nav__link">
    <span class="md-ellipsis">
      
        Column-Level Encryption with pgcrypto
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filesystem-level-encryption" class="md-nav__link">
    <span class="md-ellipsis">
      
        Filesystem-Level Encryption
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-injection-prevention" class="md-nav__link">
    <span class="md-ellipsis">
      
        SQL Injection Prevention
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL Injection Prevention">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-problem-string-concatenation" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Problem: String Concatenation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-solution-parameterized-queries" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Solution: Parameterized Queries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stored-procedures-as-a-defense-layer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stored Procedures as a Defense Layer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#input-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Input Validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#orm-safety" class="md-nav__link">
    <span class="md-ellipsis">
      
        ORM Safety
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audit-logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Audit Logging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Audit Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mysql-enterprise-audit" class="md-nav__link">
    <span class="md-ellipsis">
      
        MySQL Enterprise Audit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgresql-pgaudit" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL pgAudit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-to-log" class="md-nav__link">
    <span class="md-ellipsis">
      
        What to Log
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Log Management
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privilege-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      
        Privilege Hardening
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Privilege Hardening">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#separate-accounts-by-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Separate Accounts by Function
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-privilege-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      
        MySQL Privilege Hardening
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postgresql-privilege-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      
        PostgreSQL Privilege Hardening
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoiding-grant-all" class="md-nav__link">
    <span class="md-ellipsis">
      
        Avoiding GRANT ALL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-level-restrictions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Network-Level Restrictions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#owasp-database-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        OWASP Database Security
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OWASP Database Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#top-database-security-risks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Top Database Security Risks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Checklist
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercises" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exercises
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Further Reading
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/ringo380/guides/edit/main/Databases/database-security.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="database-security">Database Security<a class="headerlink" href="#database-security" title="Permanent link">&para;</a></h1>
<p>A database is only as secure as its weakest access path. Misconfigurations, default credentials, unencrypted connections, and injectable queries have been behind the majority of data breaches for decades. This guide covers the full security surface of production database systems - authentication, encryption, injection prevention, auditing, and privilege hardening - across both MySQL and PostgreSQL.</p>
<hr />
<h2 id="authentication-methods">Authentication Methods<a class="headerlink" href="#authentication-methods" title="Permanent link">&para;</a></h2>
<div class="diagram-container"><img src="../../assets/images/databases/security-layers.svg" alt="Database security layers showing network, authentication, authorization, and encryption as defense in depth"></div>

<p><strong>Authentication</strong> is the first gate. Every connection to your database must prove identity before it can do anything. Different methods vary in strength, complexity, and operational overhead.</p>
<h3 id="password-based-authentication">Password-Based Authentication<a class="headerlink" href="#password-based-authentication" title="Permanent link">&para;</a></h3>
<p>The most common method. Both MySQL and PostgreSQL support multiple password hashing plugins:</p>
<table>
<thead>
<tr>
<th>Plugin/Method</th>
<th>Database</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mysql_native_password</code></td>
<td>MySQL</td>
<td>SHA-1 based, legacy default pre-8.0</td>
</tr>
<tr>
<td><code>caching_sha2_password</code></td>
<td>MySQL</td>
<td>SHA-256 based, default in MySQL 8.0+</td>
</tr>
<tr>
<td><code>scram-sha-256</code></td>
<td>PostgreSQL</td>
<td>Salted challenge-response, default in PG 14+</td>
</tr>
<tr>
<td><code>md5</code></td>
<td>PostgreSQL</td>
<td>Legacy, still common but weaker</td>
</tr>
</tbody>
</table>
<p><strong>MySQL</strong> password plugin configuration:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1">-- Create a user with a specific auth plugin (MySQL 8.0+)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;app_user&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">caching_sha2_password</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;strong_random_passphrase&#39;</span><span class="p">;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1">-- Check which plugin a user is using</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">SELECT</span><span class="w"> </span><span class="k">user</span><span class="p">,</span><span class="w"> </span><span class="k">host</span><span class="p">,</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">mysql</span><span class="p">.</span><span class="k">user</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;app_user&#39;</span><span class="p">;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1">-- Change an existing user&#39;s plugin</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;legacy_user&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">  </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">caching_sha2_password</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;new_passphrase&#39;</span><span class="p">;</span>
</span></code></pre></div>
<p><strong>PostgreSQL</strong> password method configuration in <code>pg_hba.conf</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a># TYPE  DATABASE  USER       ADDRESS         METHOD
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>host    all       app_user   10.0.0.0/24     scram-sha-256
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>host    all       all        127.0.0.1/32    scram-sha-256
</span></code></pre></div>
<p>Set the default in <code>postgresql.conf</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>password_encryption = scram-sha-256
</span></code></pre></div>
<div class="admonition danger">
<p class="admonition-title">Avoid md5 and mysql_native_password in new deployments</p>
<p>Both use weak hashing algorithms. <code>mysql_native_password</code> stores SHA-1 hashes that are vulnerable to rainbow table attacks. PostgreSQL's <code>md5</code> method is similarly outdated. Use <code>caching_sha2_password</code> for MySQL and <code>scram-sha-256</code> for PostgreSQL.</p>
</div>
<h3 id="certificate-based-authentication-x509">Certificate-Based Authentication (x509)<a class="headerlink" href="#certificate-based-authentication-x509" title="Permanent link">&para;</a></h3>
<p>Instead of passwords, clients present a TLS certificate signed by a trusted Certificate Authority. The database verifies the certificate chain.</p>
<p><strong>MySQL x509 authentication:</strong></p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">-- Require a valid client certificate</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;secure_user&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">caching_sha2_password</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;passphrase&#39;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="n">REQUIRE</span><span class="w"> </span><span class="n">X509</span><span class="p">;</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c1">-- Require a specific certificate subject</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;strict_user&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span><span class="n">REQUIRE</span><span class="w"> </span><span class="n">SUBJECT</span><span class="w"> </span><span class="s1">&#39;/CN=app-server/O=MyCompany&#39;</span><span class="p">;</span>
</span></code></pre></div>
<p><strong>PostgreSQL certificate authentication</strong> in <code>pg_hba.conf</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a># Client must present a valid certificate signed by the server&#39;s root CA
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>hostssl   all   cert_user   10.0.0.0/24   cert   clientcert=verify-full
</span></code></pre></div>
<h3 id="ldap-integration">LDAP Integration<a class="headerlink" href="#ldap-integration" title="Permanent link">&para;</a></h3>
<p><strong>LDAP authentication</strong> delegates credential verification to a directory service like Active Directory or OpenLDAP. Users authenticate with their corporate credentials.</p>
<p><strong>MySQL LDAP plugin:</strong></p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1">-- Install the LDAP plugin (MySQL Enterprise)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">INSTALL</span><span class="w"> </span><span class="n">PLUGIN</span><span class="w"> </span><span class="n">authentication_ldap_simple</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span><span class="n">SONAME</span><span class="w"> </span><span class="s1">&#39;authentication_ldap_simple.so&#39;</span><span class="p">;</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1">-- Create a user that authenticates against LDAP</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;ldap_user&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">  </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">authentication_ldap_simple</span><span class="p">;</span>
</span></code></pre></div>
<p><strong>PostgreSQL LDAP</strong> in <code>pg_hba.conf</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>host  all  all  10.0.0.0/24  ldap
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>  ldapserver=ldap.company.com
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>  ldapbasedn=&quot;ou=People,dc=company,dc=com&quot;
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>  ldapsearchattribute=uid
</span></code></pre></div>
<h3 id="kerberosgssapi-and-pam">Kerberos/GSSAPI and PAM<a class="headerlink" href="#kerberosgssapi-and-pam" title="Permanent link">&para;</a></h3>
<p>For enterprise environments with existing Kerberos infrastructure:</p>
<ul>
<li><strong>Kerberos/GSSAPI</strong>: Both MySQL (with the <code>authentication_kerberos</code> plugin) and PostgreSQL (via the <code>gss</code> method in <code>pg_hba.conf</code>) support Kerberos tickets for single sign-on</li>
<li><strong>PAM</strong> (Pluggable Authentication Modules): Delegates authentication to the operating system's PAM stack, which can chain multiple authentication backends - LDAP, Kerberos, local files, MFA tokens</li>
</ul>
<p>PostgreSQL PAM configuration:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>host  all  all  10.0.0.0/24  pam  pamservice=postgresql
</span></code></pre></div>
<p>The corresponding PAM service file (<code>/etc/pam.d/postgresql</code>) defines the actual authentication chain.</p>
<div class="interactive-quiz" data-config="{&quot;question&quot;: &quot;Your company uses Active Directory for all employee credentials. Which authentication method avoids creating separate database passwords?&quot;, &quot;type&quot;: &quot;multiple-choice&quot;, &quot;options&quot;: [{&quot;text&quot;: &quot;LDAP authentication - it delegates credential checks to the directory service&quot;, &quot;correct&quot;: true, &quot;feedback&quot;: &quot;Correct! LDAP authentication forwards the username and password to your directory service (Active Directory, OpenLDAP) for verification. Users log in with their existing corporate credentials. No separate database passwords to manage, rotate, or forget.&quot;}, {&quot;text&quot;: &quot;caching_sha2_password - it caches credentials from Active Directory&quot;, &quot;correct&quot;: false, &quot;feedback&quot;: &quot;caching_sha2_password is a password hashing plugin, not an external authentication method. The &#39;caching&#39; refers to caching the SHA-256 hash computation, not credentials from another system. Users still need a separate database password.&quot;}, {&quot;text&quot;: &quot;x509 certificates - they are issued by Active Directory&quot;, &quot;correct&quot;: false, &quot;feedback&quot;: &quot;While Active Directory Certificate Services can issue x509 certificates, certificate-based authentication is a separate mechanism from AD password authentication. It requires deploying certificates to every client, which is a different operational model than password-based SSO.&quot;}, {&quot;text&quot;: &quot;scram-sha-256 - SCRAM stands for Salted Challenge Response Active-directory Mechanism&quot;, &quot;correct&quot;: false, &quot;feedback&quot;: &quot;SCRAM stands for Salted Challenge Response Authentication Mechanism. It is a self-contained password-based protocol that has no connection to Active Directory. Database passwords are stored and verified locally.&quot;}]}"><noscript><p><strong>Your company uses Active Directory for all employee credentials. Which authentication method avoids creating separate database passwords?</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="tlsssl-configuration">TLS/SSL Configuration<a class="headerlink" href="#tlsssl-configuration" title="Permanent link">&para;</a></h2>
<p>Authentication proves identity, but without encryption the credentials (and all subsequent data) travel in plaintext. <strong>TLS</strong> (Transport Layer Security, the successor to SSL) encrypts the connection between client and server.</p>
<h3 id="generating-certificates">Generating Certificates<a class="headerlink" href="#generating-certificates" title="Permanent link">&para;</a></h3>
<p>For production, use certificates from your organization's internal CA or a public CA. For testing, self-signed certificates work:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Generate a CA key and certificate</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>openssl<span class="w"> </span>genrsa<span class="w"> </span><span class="m">4096</span><span class="w"> </span>&gt;<span class="w"> </span>ca-key.pem
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-x509<span class="w"> </span>-nodes<span class="w"> </span>-days<span class="w"> </span><span class="m">3650</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span>-key<span class="w"> </span>ca-key.pem<span class="w"> </span>-out<span class="w"> </span>ca-cert.pem<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span>-subj<span class="w"> </span><span class="s2">&quot;/CN=MySQL-CA/O=MyCompany&quot;</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c1"># Generate the server key and certificate signing request</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>openssl<span class="w"> </span>genrsa<span class="w"> </span><span class="m">4096</span><span class="w"> </span>&gt;<span class="w"> </span>server-key.pem
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-key<span class="w"> </span>server-key.pem<span class="w"> </span>-out<span class="w"> </span>server-req.pem<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">  </span>-subj<span class="w"> </span><span class="s2">&quot;/CN=db-server.company.com&quot;</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="c1"># Sign the server certificate with the CA</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>openssl<span class="w"> </span>x509<span class="w"> </span>-req<span class="w"> </span>-in<span class="w"> </span>server-req.pem<span class="w"> </span>-days<span class="w"> </span><span class="m">3650</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">  </span>-CA<span class="w"> </span>ca-cert.pem<span class="w"> </span>-CAkey<span class="w"> </span>ca-key.pem<span class="w"> </span>-CAcreateserial<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">  </span>-out<span class="w"> </span>server-cert.pem
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="c1"># Generate client key and certificate (for x509 auth)</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>openssl<span class="w"> </span>genrsa<span class="w"> </span><span class="m">4096</span><span class="w"> </span>&gt;<span class="w"> </span>client-key.pem
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>openssl<span class="w"> </span>req<span class="w"> </span>-new<span class="w"> </span>-key<span class="w"> </span>client-key.pem<span class="w"> </span>-out<span class="w"> </span>client-req.pem<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">  </span>-subj<span class="w"> </span><span class="s2">&quot;/CN=app-server/O=MyCompany&quot;</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>openssl<span class="w"> </span>x509<span class="w"> </span>-req<span class="w"> </span>-in<span class="w"> </span>client-req.pem<span class="w"> </span>-days<span class="w"> </span><span class="m">3650</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">  </span>-CA<span class="w"> </span>ca-cert.pem<span class="w"> </span>-CAkey<span class="w"> </span>ca-key.pem<span class="w"> </span>-CAcreateserial<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">  </span>-out<span class="w"> </span>client-cert.pem
</span></code></pre></div>
<h3 id="mysql-tls-configuration">MySQL TLS Configuration<a class="headerlink" href="#mysql-tls-configuration" title="Permanent link">&para;</a></h3>
<p>In <code>my.cnf</code> (or <code>my.ini</code> on Windows):</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">[mysqld]</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c1"># Require all connections to use TLS</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="na">require_secure_transport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">ON</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="c1"># Certificate paths</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="na">ssl-ca</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s">/etc/mysql/ssl/ca-cert.pem</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="na">ssl-cert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/etc/mysql/ssl/server-cert.pem</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="na">ssl-key</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s">/etc/mysql/ssl/server-key.pem</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="c1"># Minimum TLS version</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="na">tls_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">TLSv1.2,TLSv1.3</span>
</span></code></pre></div>
<p>Verify the server's TLS status:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">SHOW</span><span class="w"> </span><span class="n">VARIABLES</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%ssl%&#39;</span><span class="p">;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c1">-- ssl_ca, ssl_cert, ssl_key should show your paths</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="k">SHOW</span><span class="w"> </span><span class="n">STATUS</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;Ssl_cipher&#39;</span><span class="p">;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c1">-- Should show a cipher name like TLS_AES_256_GCM_SHA384</span>
</span></code></pre></div>
<h3 id="postgresql-tls-configuration">PostgreSQL TLS Configuration<a class="headerlink" href="#postgresql-tls-configuration" title="Permanent link">&para;</a></h3>
<p>In <code>postgresql.conf</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>ssl = on
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>ssl_cert_file = &#39;/etc/postgresql/ssl/server-cert.pem&#39;
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>ssl_key_file  = &#39;/etc/postgresql/ssl/server-key.pem&#39;
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>ssl_ca_file   = &#39;/etc/postgresql/ssl/ca-cert.pem&#39;
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>ssl_min_protocol_version = &#39;TLSv1.2&#39;
</span></code></pre></div>
<p>In <code>pg_hba.conf</code>, use <code>hostssl</code> instead of <code>host</code> to require TLS:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a># Reject non-TLS connections from the network
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>hostssl   all   all   10.0.0.0/24   scram-sha-256
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>hostnossl all   all   10.0.0.0/24   reject
</span></code></pre></div>
<h3 id="verifying-encrypted-connections">Verifying Encrypted Connections<a class="headerlink" href="#verifying-encrypted-connections" title="Permanent link">&para;</a></h3>
<p><strong>MySQL client verification:</strong></p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1">-- Check your current connection</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="k">SHOW</span><span class="w"> </span><span class="n">STATUS</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;Ssl_cipher&#39;</span><span class="p">;</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1">-- Non-empty = encrypted</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">performance_schema</span><span class="p">.</span><span class="n">session_status</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">variable_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Ssl_version&#39;</span><span class="p">;</span>
</span></code></pre></div>
<p><strong>PostgreSQL client verification:</strong></p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1">-- In psql</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="err">\</span><span class="n">conninfo</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1">-- Should show &quot;SSL connection (protocol: TLSv1.3, cipher: ...)&quot;</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">ssl</span><span class="p">,</span><span class="w"> </span><span class="k">version</span><span class="p">,</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_stat_ssl</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pg_backend_pid</span><span class="p">();</span>
</span></code></pre></div>
<div class="interactive-terminal" data-config="{&quot;title&quot;: &quot;Configuring and Verifying MySQL TLS&quot;, &quot;steps&quot;: [{&quot;command&quot;: &quot;ls /etc/mysql/ssl/&quot;, &quot;output&quot;: &quot;ca-cert.pem   ca-key.pem   server-cert.pem   server-key.pem\n&quot;, &quot;narration&quot;: &quot;Confirm the certificate files are in place. In production, these come from your organization&#39;s CA. The server needs the CA cert, server cert, and server key.&quot;}, {&quot;command&quot;: &quot;sudo cat /etc/mysql/my.cnf | grep -A6 &#39;\\[mysqld\\]&#39;&quot;, &quot;output&quot;: &quot;[mysqld]\nrequire_secure_transport = ON\nssl-ca   = /etc/mysql/ssl/ca-cert.pem\nssl-cert = /etc/mysql/ssl/server-cert.pem\nssl-key  = /etc/mysql/ssl/server-key.pem\ntls_version = TLSv1.2,TLSv1.3\n&quot;, &quot;narration&quot;: &quot;The mysqld section enables require_secure_transport, which rejects any unencrypted connection attempt. tls_version restricts to TLS 1.2 and 1.3 only.&quot;}, {&quot;command&quot;: &quot;sudo systemctl restart mysql&quot;, &quot;output&quot;: &quot;&quot;, &quot;narration&quot;: &quot;Restart MySQL to apply the TLS configuration changes.&quot;}, {&quot;command&quot;: &quot;mysql -u root -p -e \&quot;SHOW VARIABLES LIKE &#39;require_secure_transport&#39;;\&quot;&quot;, &quot;output&quot;: &quot;+---------------------------+-------+\n| Variable_name             | Value |\n+---------------------------+-------+\n| require_secure_transport  | ON    |\n+---------------------------+-------+\n&quot;, &quot;narration&quot;: &quot;Verify that require_secure_transport is enabled. Any connection attempt without TLS will be rejected.&quot;}, {&quot;command&quot;: &quot;mysql -u root -p -e \&quot;SHOW STATUS LIKE &#39;Ssl_cipher&#39;;\&quot;&quot;, &quot;output&quot;: &quot;+---------------+------------------------+\n| Variable_name | Value                  |\n+---------------+------------------------+\n| Ssl_cipher    | TLS_AES_256_GCM_SHA384 |\n+---------------+------------------------+\n&quot;, &quot;narration&quot;: &quot;A non-empty Ssl_cipher confirms the current connection is encrypted. TLS_AES_256_GCM_SHA384 is a strong cipher suite from TLS 1.3.&quot;}, {&quot;command&quot;: &quot;mysql -u app_user -p --ssl-mode=DISABLED -h 10.0.0.5 2>&amp;1&quot;, &quot;output&quot;: &quot;ERROR 3159 (HY000): Connections using insecure transport are prohibited\nwhile --require_secure_transport=ON.\n&quot;, &quot;narration&quot;: &quot;Attempting to connect without TLS is rejected immediately. This proves the server enforces encryption for all connections.&quot;}]}"><noscript><p><strong>Configuring and Verifying MySQL TLS</strong> (requires JavaScript)</p></noscript></div>
<div class="interactive-quiz" data-config="{&quot;question&quot;: &quot;In PostgreSQL, what is the difference between &#39;host&#39; and &#39;hostssl&#39; entries in pg_hba.conf?&quot;, &quot;type&quot;: &quot;multiple-choice&quot;, &quot;options&quot;: [{&quot;text&quot;: &quot;&#39;host&#39; matches TCP/IP connections regardless of TLS; &#39;hostssl&#39; matches only TLS-encrypted connections&quot;, &quot;correct&quot;: true, &quot;feedback&quot;: &quot;Correct! &#39;host&#39; matches any TCP/IP connection, whether encrypted or not. &#39;hostssl&#39; matches only connections that use TLS. To enforce encryption, use &#39;hostssl&#39; for allowed connections and &#39;hostnossl ... reject&#39; to explicitly deny unencrypted ones.&quot;}, {&quot;text&quot;: &quot;&#39;host&#39; is for local connections; &#39;hostssl&#39; is for remote connections&quot;, &quot;correct&quot;: false, &quot;feedback&quot;: &quot;Both &#39;host&#39; and &#39;hostssl&#39; are for TCP/IP (network) connections. Local Unix socket connections use the &#39;local&#39; type. The distinction is about encryption, not network location.&quot;}, {&quot;text&quot;: &quot;&#39;hostssl&#39; enables TLS on the server; &#39;host&#39; disables it&quot;, &quot;correct&quot;: false, &quot;feedback&quot;: &quot;pg_hba.conf controls authentication rules, not server-level TLS settings. TLS is enabled in postgresql.conf with ssl = on. The pg_hba.conf entries then filter which connections require TLS.&quot;}, {&quot;text&quot;: &quot;They are aliases - both require TLS when ssl = on in postgresql.conf&quot;, &quot;correct&quot;: false, &quot;feedback&quot;: &quot;They are not aliases. Even with ssl = on, a &#39;host&#39; entry allows both encrypted and unencrypted connections. Only &#39;hostssl&#39; enforces that the connection must be encrypted.&quot;}]}"><noscript><p><strong>In PostgreSQL, what is the difference between 'host' and 'hostssl' entries in pg_hba.conf?</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="encryption-at-rest">Encryption at Rest<a class="headerlink" href="#encryption-at-rest" title="Permanent link">&para;</a></h2>
<p>TLS protects data in transit. <strong>Encryption at rest</strong> protects data stored on disk - against stolen drives, unauthorized filesystem access, or compromised backups.</p>
<h3 id="transparent-data-encryption-tde">Transparent Data Encryption (TDE)<a class="headerlink" href="#transparent-data-encryption-tde" title="Permanent link">&para;</a></h3>
<p><strong>TDE</strong> encrypts data files at the storage engine level. The database handles encryption and decryption transparently - applications need no changes.</p>
<p><strong>MySQL Enterprise TDE</strong> (InnoDB tablespace encryption):</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1">-- Install the keyring plugin (required for TDE)</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="c1">-- In my.cnf:</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="c1">-- early-plugin-load = keyring_file.so</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1">-- keyring_file_data = /var/lib/mysql-keyring/keyring</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="c1">-- Encrypt a tablespace</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="n">ENCRYPTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Y&#39;</span><span class="p">;</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="c1">-- Encrypt the system tablespace</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="k">ALTER</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">mysql</span><span class="p">.</span><span class="n">innodb_system</span><span class="w"> </span><span class="n">ENCRYPTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Y&#39;</span><span class="p">;</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="c1">-- Verify encryption status</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">encryption</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="k">FROM</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">innodb_tablespaces</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">encryption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Y&#39;</span><span class="p">;</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Key management is the hard part</p>
<p>TDE is only as secure as the encryption keys. Storing the keyring file on the same disk as the database defeats the purpose - a stolen disk includes both the encrypted data and the key. Use a dedicated <strong>Key Management Service</strong> (KMS) like HashiCorp Vault, AWS KMS, or Azure Key Vault in production.</p>
</div>
<h3 id="column-level-encryption-with-pgcrypto">Column-Level Encryption with pgcrypto<a class="headerlink" href="#column-level-encryption-with-pgcrypto" title="Permanent link">&para;</a></h3>
<p>PostgreSQL does not have built-in TDE in the community edition, but the <a href="https://www.postgresql.org/docs/current/pgcrypto.html"><strong>pgcrypto</strong></a> extension provides column-level encryption:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1">-- Enable pgcrypto</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">pgcrypto</span><span class="p">;</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c1">-- Encrypt sensitive columns using symmetric encryption (AES-256)</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">ssn_encrypted</span><span class="p">)</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">  </span><span class="s1">&#39;Jane Smith&#39;</span><span class="p">,</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">  </span><span class="n">pgp_sym_encrypt</span><span class="p">(</span><span class="s1">&#39;123-45-6789&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;encryption-key-from-app&#39;</span><span class="p">)</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="p">);</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="c1">-- Decrypt when reading</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">pgp_sym_decrypt</span><span class="p">(</span><span class="n">ssn_encrypted</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;encryption-key-from-app&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ssn</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="k">FROM</span><span class="w"> </span><span class="n">customers</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="p">;</span>
</span></code></pre></div>
<p>The encryption key should come from the application or a KMS - never hardcode it in SQL or store it in the database.</p>
<h3 id="filesystem-level-encryption">Filesystem-Level Encryption<a class="headerlink" href="#filesystem-level-encryption" title="Permanent link">&para;</a></h3>
<p>An alternative to database-level encryption is encrypting the entire filesystem or block device:</p>
<ul>
<li><strong>LUKS/dm-crypt</strong> (Linux): Encrypts block devices. The database writes normally; the kernel encrypts and decrypts transparently</li>
<li><strong>BitLocker</strong> (Windows): Full-disk encryption for Windows Server</li>
<li><strong>AWS EBS Encryption</strong> / <strong>Azure Disk Encryption</strong>: Cloud provider managed encryption for virtual disks</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Example: LUKS encryption for a database volume</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>sudo<span class="w"> </span>cryptsetup<span class="w"> </span>luksFormat<span class="w"> </span>/dev/sdb1
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>sudo<span class="w"> </span>cryptsetup<span class="w"> </span>luksOpen<span class="w"> </span>/dev/sdb1<span class="w"> </span>db_encrypted
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>sudo<span class="w"> </span>mkfs.ext4<span class="w"> </span>/dev/mapper/db_encrypted
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>sudo<span class="w"> </span>mount<span class="w"> </span>/dev/mapper/db_encrypted<span class="w"> </span>/var/lib/mysql
</span></code></pre></div>
<p>Filesystem encryption protects against physical theft but not against a compromised OS or database process - if the system is running, the filesystem is mounted and decrypted.</p>
<hr />
<h2 id="sql-injection-prevention">SQL Injection Prevention<a class="headerlink" href="#sql-injection-prevention" title="Permanent link">&para;</a></h2>
<p><strong>SQL injection</strong> remains the most exploited database vulnerability year after year. It occurs when user input is concatenated directly into SQL strings, allowing an attacker to modify the query's logic.</p>
<h3 id="the-problem-string-concatenation">The Problem: String Concatenation<a class="headerlink" href="#the-problem-string-concatenation" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># VULNERABLE - never do this</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM users WHERE username = &#39;&quot;</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c1"># If username = &quot;admin&#39; OR &#39;1&#39;=&#39;1&quot; the query becomes:</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c1"># SELECT * FROM users WHERE username = &#39;admin&#39; OR &#39;1&#39;=&#39;1&#39;</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c1"># This returns ALL users</span>
</span></code></pre></div>
<h3 id="the-solution-parameterized-queries">The Solution: Parameterized Queries<a class="headerlink" href="#the-solution-parameterized-queries" title="Permanent link">&para;</a></h3>
<p><strong>Parameterized queries</strong> (also called prepared statements) separate the SQL structure from the data. The database engine treats parameters as literal values, never as SQL syntax.</p>
<div class="interactive-code-walkthrough" data-config="{&quot;title&quot;: &quot;Parameterized Queries: Safe vs Unsafe Patterns&quot;, &quot;description&quot;: &quot;Side-by-side comparison of injectable and safe query patterns across Python, JavaScript, and Java.&quot;, &quot;code&quot;: &quot;# ---- Python (mysql-connector / psycopg2) ----\n\n# UNSAFE - string concatenation\nquery = \&quot;SELECT * FROM users WHERE email = &#39;\&quot; + email + \&quot;&#39;\&quot;\ncursor.execute(query)\n\n# SAFE - parameterized query\nquery = \&quot;SELECT * FROM users WHERE email = %s\&quot;\ncursor.execute(query, (email,))\n\n# ---- JavaScript / Node.js (mysql2) ----\n\n// UNSAFE - template literal interpolation\nconst query = `SELECT * FROM orders WHERE user_id = ${userId}`;\nconnection.query(query);\n\n// SAFE - placeholder parameter\nconst query = \&quot;SELECT * FROM orders WHERE user_id = ?\&quot;;\nconnection.execute(query, [userId]);\n\n# ---- Java (JDBC) ----\n\n// UNSAFE - string concatenation\nString query = \&quot;SELECT * FROM products WHERE name = &#39;\&quot; + name + \&quot;&#39;\&quot;;\nStatement stmt = conn.createStatement();\nResultSet rs = stmt.executeQuery(query);\n\n// SAFE - PreparedStatement\nString query = \&quot;SELECT * FROM products WHERE name = ?\&quot;;\nPreparedStatement pstmt = conn.prepareStatement(query);\npstmt.setString(1, name);\nResultSet rs = pstmt.executeQuery();\n&quot;, &quot;language&quot;: &quot;python&quot;, &quot;annotations&quot;: [{&quot;line&quot;: 4, &quot;text&quot;: &quot;VULNERABLE. The email variable is spliced directly into the SQL string. An attacker can terminate the string and inject arbitrary SQL: &#39; OR 1=1; DROP TABLE users; --&quot;}, {&quot;line&quot;: 8, &quot;text&quot;: &quot;SAFE. The %s placeholder is not string formatting - the database driver sends the query structure and the parameter value separately. The database engine never parses the parameter as SQL.&quot;}, {&quot;line&quot;: 14, &quot;text&quot;: &quot;VULNERABLE. JavaScript template literals make this look clean, but the userId value is still interpolated into the SQL string. An input like &#39;1 OR 1=1&#39; changes the query logic.&quot;}, {&quot;line&quot;: 18, &quot;text&quot;: &quot;SAFE. The ? placeholder tells mysql2 to send this as a parameterized query. The userId value is bound separately and treated as a literal value by the database.&quot;}, {&quot;line&quot;: 24, &quot;text&quot;: &quot;VULNERABLE. Java&#39;s Statement.executeQuery sends the entire concatenated string to the database. The name variable can contain SQL that alters the query.&quot;}, {&quot;line&quot;: 29, &quot;text&quot;: &quot;SAFE. PreparedStatement separates the query template from parameters. pstmt.setString(1, name) binds the first parameter as a string literal, regardless of its content.&quot;}]}"><noscript><p><strong>Parameterized Queries: Safe vs Unsafe Patterns</strong> (requires JavaScript)</p></noscript></div>
<h3 id="stored-procedures-as-a-defense-layer">Stored Procedures as a Defense Layer<a class="headerlink" href="#stored-procedures-as-a-defense-layer" title="Permanent link">&para;</a></h3>
<p>Stored procedures provide an additional layer of protection by encapsulating SQL logic on the server:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1">-- MySQL stored procedure</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="k">DELIMITER</span><span class="w"> </span><span class="o">//</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">PROCEDURE</span><span class="w"> </span><span class="n">get_user_by_email</span><span class="p">(</span><span class="k">IN</span><span class="w"> </span><span class="n">p_email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">))</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="k">BEGIN</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">  </span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">created_at</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">  </span><span class="k">WHERE</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_email</span><span class="p">;</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="k">END</span><span class="w"> </span><span class="o">//</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="k">DELIMITER</span><span class="w"> </span><span class="p">;</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="c1">-- Call from application</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="k">CALL</span><span class="w"> </span><span class="n">get_user_by_email</span><span class="p">(</span><span class="s1">&#39;user@example.com&#39;</span><span class="p">);</span>
</span></code></pre></div>
<p>The application only calls the procedure with parameters - it never constructs raw SQL. The procedure controls exactly which columns are returned and which tables are accessed.</p>
<h3 id="input-validation">Input Validation<a class="headerlink" href="#input-validation" title="Permanent link">&para;</a></h3>
<p>Parameterized queries are the primary defense. Input validation is a secondary layer:</p>
<ul>
<li><strong>Allowlist validation</strong>: If a field should be an integer, cast it to an integer before use</li>
<li><strong>Length limits</strong>: Reject inputs exceeding expected lengths</li>
<li><strong>Character restrictions</strong>: Email fields should match email patterns</li>
<li><strong>Reject known attack patterns</strong>: While not sufficient alone, blocking inputs containing <code>'; --</code> or <code>UNION SELECT</code> adds depth</li>
</ul>
<h3 id="orm-safety">ORM Safety<a class="headerlink" href="#orm-safety" title="Permanent link">&para;</a></h3>
<p>Object-Relational Mappers (ORMs) like SQLAlchemy, Django ORM, Sequelize, and Hibernate use parameterized queries internally. They are generally safe, but watch for escape hatches:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1"># Django ORM - safe by default</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="n">user_email</span><span class="p">)</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c1"># Django raw query - safe if parameterized</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE email = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">user_email</span><span class="p">])</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="c1"># Django raw query - UNSAFE if concatenated</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE email = &#39;&quot;</span> <span class="o">+</span> <span class="n">user_email</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
</span></code></pre></div>
<div class="admonition danger">
<p class="admonition-title">ORMs don't make you immune</p>
<p>Every ORM provides a way to execute raw SQL. When you use it, you are responsible for parameterization. Code review should flag any raw SQL that concatenates user input.</p>
</div>
<hr />
<h2 id="audit-logging">Audit Logging<a class="headerlink" href="#audit-logging" title="Permanent link">&para;</a></h2>
<p>You cannot protect what you cannot observe. <strong>Audit logging</strong> records who did what, when, and from where - essential for compliance (PCI DSS, HIPAA, SOX), incident investigation, and detecting unauthorized access.</p>
<h3 id="mysql-enterprise-audit">MySQL Enterprise Audit<a class="headerlink" href="#mysql-enterprise-audit" title="Permanent link">&para;</a></h3>
<p>The <a href="https://dev.mysql.com/doc/refman/8.0/en/audit-log.html"><strong>MySQL Enterprise Audit</strong></a> plugin provides comprehensive logging:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1">-- Install the audit plugin</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">INSTALL</span><span class="w"> </span><span class="n">PLUGIN</span><span class="w"> </span><span class="n">audit_log</span><span class="w"> </span><span class="n">SONAME</span><span class="w"> </span><span class="s1">&#39;audit_log.so&#39;</span><span class="p">;</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c1">-- Configure in my.cnf</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="c1">-- [mysqld]</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="c1">-- audit-log-format = JSON</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c1">-- audit-log-policy = ALL</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="c1">-- audit-log-file = /var/log/mysql/audit.log</span>
</span></code></pre></div>
<p>For the community edition, the general query log provides basic auditing:</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">[mysqld]</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="na">general_log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">ON</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="na">general_log_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/var/log/mysql/general.log</span>
</span></code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Performance impact of general_log</p>
<p>The general query log records every single query and causes significant I/O overhead. Use it for short-term debugging or auditing, not as a permanent audit solution on high-traffic systems. The Enterprise Audit plugin has filtering capabilities that reduce overhead.</p>
</div>
<h3 id="postgresql-pgaudit">PostgreSQL pgAudit<a class="headerlink" href="#postgresql-pgaudit" title="Permanent link">&para;</a></h3>
<p><a href="https://www.pgaudit.org/"><strong>pgAudit</strong></a> is the standard auditing extension for PostgreSQL:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1">-- Enable in postgresql.conf:</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="c1">-- shared_preload_libraries = &#39;pgaudit&#39;</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="c1">-- pgaudit.log = &#39;ddl, role, write&#39;</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="c1">-- Per-database override</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">production</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">pgaudit</span><span class="p">.</span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">;</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="c1">-- Per-role override (audit everything the admin role does)</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">dba</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">pgaudit</span><span class="p">.</span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;all&#39;</span><span class="p">;</span>
</span></code></pre></div>
<p>pgAudit log classes:</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>What it logs</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>read</code></td>
<td>SELECT, COPY FROM</td>
</tr>
<tr>
<td><code>write</code></td>
<td>INSERT, UPDATE, DELETE, TRUNCATE</td>
</tr>
<tr>
<td><code>function</code></td>
<td>Function calls</td>
</tr>
<tr>
<td><code>role</code></td>
<td>GRANT, REVOKE, CREATE/ALTER/DROP ROLE</td>
</tr>
<tr>
<td><code>ddl</code></td>
<td>CREATE, ALTER, DROP (tables, indexes, etc.)</td>
</tr>
<tr>
<td><code>misc</code></td>
<td>DISCARD, FETCH, CHECKPOINT</td>
</tr>
<tr>
<td><code>all</code></td>
<td>Everything above</td>
</tr>
</tbody>
</table>
<h3 id="what-to-log">What to Log<a class="headerlink" href="#what-to-log" title="Permanent link">&para;</a></h3>
<p>At minimum, audit these events:</p>
<ul>
<li><strong>Authentication events</strong>: Successful and failed login attempts (track brute-force patterns)</li>
<li><strong>DDL changes</strong>: Schema modifications (CREATE, ALTER, DROP) - who changed the table structure?</li>
<li><strong>DML on sensitive tables</strong>: INSERT, UPDATE, DELETE on tables containing PII, financial data, or credentials</li>
<li><strong>Privilege changes</strong>: GRANT, REVOKE, CREATE ROLE, ALTER USER</li>
<li><strong>Administrative actions</strong>: Configuration changes, backup operations, replication setup</li>
</ul>
<h3 id="log-management">Log Management<a class="headerlink" href="#log-management" title="Permanent link">&para;</a></h3>
<p>Raw audit logs are useless if nobody reviews them:</p>
<ul>
<li><strong>Centralize</strong>: Ship logs to a SIEM (Splunk, Elasticsearch, Datadog) for search and alerting</li>
<li><strong>Protect</strong>: Audit logs should be write-only for the database process, stored on separate storage, and backed up independently</li>
<li><strong>Retain</strong>: Define retention policies based on compliance requirements (PCI DSS requires 1 year, HIPAA requires 6 years)</li>
<li><strong>Alert</strong>: Set up automated alerts for suspicious patterns - failed login spikes, after-hours DDL, mass data exports</li>
</ul>
<div class="interactive-quiz" data-config="{&quot;question&quot;: &quot;You need to audit all schema changes and privilege modifications in PostgreSQL, but you want to minimize performance impact. Which pgaudit.log setting is most appropriate?&quot;, &quot;type&quot;: &quot;multiple-choice&quot;, &quot;options&quot;: [{&quot;text&quot;: &quot;pgaudit.log = &#39;ddl, role&#39;&quot;, &quot;correct&quot;: true, &quot;feedback&quot;: &quot;Correct! The &#39;ddl&#39; class captures CREATE, ALTER, and DROP statements (schema changes), and &#39;role&#39; captures GRANT, REVOKE, and role modifications. These are relatively infrequent operations, so the performance impact is minimal while still capturing the most security-critical changes.&quot;}, {&quot;text&quot;: &quot;pgaudit.log = &#39;all&#39;&quot;, &quot;correct&quot;: false, &quot;feedback&quot;: &quot;Logging everything includes every SELECT, INSERT, UPDATE, and DELETE. On a busy system, this generates massive log volume and measurable I/O overhead. Reserve &#39;all&#39; for specific roles or databases where full auditing is required by regulation.&quot;}, {&quot;text&quot;: &quot;pgaudit.log = &#39;write&#39;&quot;, &quot;correct&quot;: false, &quot;feedback&quot;: &quot;The &#39;write&#39; class captures INSERT, UPDATE, DELETE, and TRUNCATE - data modification. This misses DDL (schema changes) and role/privilege changes, which were the stated requirements.&quot;}, {&quot;text&quot;: &quot;pgaudit.log = &#39;misc&#39;&quot;, &quot;correct&quot;: false, &quot;feedback&quot;: &quot;The &#39;misc&#39; class captures DISCARD, FETCH, CHECKPOINT, and similar operational commands. It does not include DDL or role changes.&quot;}]}"><noscript><p><strong>You need to audit all schema changes and privilege modifications in PostgreSQL, but you want to minimize performance impact. Which pgaudit.log setting is most appropriate?</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="privilege-hardening">Privilege Hardening<a class="headerlink" href="#privilege-hardening" title="Permanent link">&para;</a></h2>
<p>Even authenticated users should only have access to what they need. <strong>Privilege hardening</strong> applies the principle of least privilege: every account gets the minimum permissions required for its function.</p>
<h3 id="separate-accounts-by-function">Separate Accounts by Function<a class="headerlink" href="#separate-accounts-by-function" title="Permanent link">&para;</a></h3>
<p>Never use a single account for everything. Create purpose-specific accounts:</p>
<table>
<thead>
<tr>
<th>Account</th>
<th>Purpose</th>
<th>Typical Privileges</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>app_read</code></td>
<td>Application read queries</td>
<td>SELECT on specific tables</td>
</tr>
<tr>
<td><code>app_write</code></td>
<td>Application write operations</td>
<td>SELECT, INSERT, UPDATE, DELETE on specific tables</td>
</tr>
<tr>
<td><code>admin</code></td>
<td>DBA administration</td>
<td>Full privileges (used interactively, never by applications)</td>
</tr>
<tr>
<td><code>backup_user</code></td>
<td>Backup operations</td>
<td>SELECT, LOCK TABLES, SHOW VIEW, RELOAD, REPLICATION CLIENT</td>
</tr>
<tr>
<td><code>monitor_user</code></td>
<td>Monitoring/metrics</td>
<td>SELECT on <code>performance_schema</code>, <code>information_schema</code></td>
</tr>
<tr>
<td><code>migration_user</code></td>
<td>Schema migrations</td>
<td>CREATE, ALTER, DROP, INDEX on application database</td>
</tr>
</tbody>
</table>
<h3 id="mysql-privilege-hardening">MySQL Privilege Hardening<a class="headerlink" href="#mysql-privilege-hardening" title="Permanent link">&para;</a></h3>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1">-- Create a read-only application account</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;app_read&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">  </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">caching_sha2_password</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;read_passphrase&#39;</span><span class="p">;</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">myapp</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;app_read&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="c1">-- Create a write account with limited DML</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;app_write&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">  </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">caching_sha2_password</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;write_passphrase&#39;</span><span class="p">;</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="p">,</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">myapp</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;app_write&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="c1">-- Monitoring account</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;monitor&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="w">  </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">caching_sha2_password</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;monitor_passphrase&#39;</span><span class="p">;</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">performance_schema</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;monitor&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="k">GRANT</span><span class="w"> </span><span class="n">PROCESS</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;monitor&#39;</span><span class="o">@</span><span class="s1">&#39;10.0.0.%&#39;</span><span class="p">;</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="c1">-- Review existing privileges - look for overly broad grants</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">grantee</span><span class="p">,</span><span class="w"> </span><span class="n">privilege_type</span><span class="p">,</span><span class="w"> </span><span class="n">table_schema</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="k">FROM</span><span class="w"> </span><span class="n">information_schema</span><span class="p">.</span><span class="n">schema_privileges</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">grantee</span><span class="p">;</span>
</span></code></pre></div>
<h3 id="postgresql-privilege-hardening">PostgreSQL Privilege Hardening<a class="headerlink" href="#postgresql-privilege-hardening" title="Permanent link">&para;</a></h3>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1">-- Revoke default public schema access (critical in PostgreSQL)</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="k">REVOKE</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">PUBLIC</span><span class="p">;</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="k">REVOKE</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">PUBLIC</span><span class="p">;</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="c1">-- Grant schema usage explicitly</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">USAGE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_read</span><span class="p">;</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">USAGE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_write</span><span class="p">;</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="c1">-- Read-only role</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">app_read</span><span class="w"> </span><span class="n">LOGIN</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">&#39;read_passphrase&#39;</span><span class="p">;</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_read</span><span class="p">;</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="w">  </span><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_read</span><span class="p">;</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="c1">-- Write role</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">app_write</span><span class="w"> </span><span class="n">LOGIN</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">&#39;write_passphrase&#39;</span><span class="p">;</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="p">,</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_write</span><span class="p">;</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">USAGE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="n">SEQUENCES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_write</span><span class="p">;</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="w">  </span><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="p">,</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">TABLES</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_write</span><span class="p">;</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="k">public</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="w">  </span><span class="k">GRANT</span><span class="w"> </span><span class="k">USAGE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">SEQUENCES</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">app_write</span><span class="p">;</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">ALTER DEFAULT PRIVILEGES matters</p>
<p><code>GRANT SELECT ON ALL TABLES</code> only applies to tables that exist right now. When new tables are created later, the role will not have access. <code>ALTER DEFAULT PRIVILEGES</code> sets the permissions that future tables inherit automatically.</p>
</div>
<h3 id="avoiding-grant-all">Avoiding GRANT ALL<a class="headerlink" href="#avoiding-grant-all" title="Permanent link">&para;</a></h3>
<p><code>GRANT ALL PRIVILEGES</code> gives everything - SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, ALTER, INDEX, and more. For application accounts, this is almost always too broad:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1">-- WRONG - application doesn&#39;t need DROP, ALTER, CREATE</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">PRIVILEGES</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">myapp</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;app_user&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span><span class="p">;</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c1">-- RIGHT - only what the application actually uses</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="p">,</span><span class="w"> </span><span class="k">INSERT</span><span class="p">,</span><span class="w"> </span><span class="k">UPDATE</span><span class="p">,</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">myapp</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;app_user&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span><span class="p">;</span>
</span></code></pre></div>
<p>If an application account is compromised, <code>GRANT ALL</code> means the attacker can drop tables, alter schema, and read data from every table. Scoped grants limit the blast radius.</p>
<h3 id="network-level-restrictions">Network-Level Restrictions<a class="headerlink" href="#network-level-restrictions" title="Permanent link">&para;</a></h3>
<p>Database ports should never be exposed to the public internet:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1"># MySQL - bind only to internal interface (my.cnf)</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="c1"># bind-address = 10.0.0.5</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="c1"># PostgreSQL - listen only on internal interface (postgresql.conf)</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="c1"># listen_addresses = &#39;10.0.0.5&#39;</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="c1"># Firewall rules (iptables example)</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">3306</span><span class="w"> </span>-s<span class="w"> </span><span class="m">10</span>.0.0.0/24<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">3306</span><span class="w"> </span>-j<span class="w"> </span>DROP
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">5432</span><span class="w"> </span>-s<span class="w"> </span><span class="m">10</span>.0.0.0/24<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">5432</span><span class="w"> </span>-j<span class="w"> </span>DROP
</span></code></pre></div>
<p>Combine network restrictions with MySQL's host-based user system (<code>'user'@'10.0.0.%'</code>) and PostgreSQL's <code>pg_hba.conf</code> address matching for defense in depth.</p>
<hr />
<h2 id="owasp-database-security">OWASP Database Security<a class="headerlink" href="#owasp-database-security" title="Permanent link">&para;</a></h2>
<p>The <a href="https://owasp.org/"><strong>OWASP</strong></a> (Open Worldwide Application Security Project) identifies recurring patterns in database breaches. These are the risks that consistently appear in real-world incidents:</p>
<h3 id="top-database-security-risks">Top Database Security Risks<a class="headerlink" href="#top-database-security-risks" title="Permanent link">&para;</a></h3>
<p><strong>1. SQL Injection</strong> - The most exploited vulnerability. Parameterized queries eliminate it entirely, yet it persists because legacy code, raw query escape hatches, and dynamic SQL construction remain common.</p>
<p><strong>2. Excessive Privileges</strong> - Application accounts with DBA-level access. When the application is compromised, the attacker inherits every privilege the account has. The principle of least privilege directly counters this.</p>
<p><strong>3. Unpatched Databases</strong> - Known vulnerabilities with published CVEs remain exploitable until patched. Establish a patching cadence: critical CVEs within 72 hours, regular patches monthly.</p>
<p><strong>4. Default Credentials</strong> - MySQL historically created accounts with no password. PostgreSQL's <code>trust</code> authentication in <code>pg_hba.conf</code> allows passwordless connections. Every default credential must be changed or removed before production deployment.</p>
<p><strong>5. Exposed Backups</strong> - Database dumps stored in world-readable locations, uploaded to unsecured S3 buckets, or left in web-accessible directories. Encrypt backups and restrict access.</p>
<p><strong>6. Unnecessary Features Enabled</strong> - File loading (<code>LOAD DATA LOCAL INFILE</code> in MySQL), external program execution (<code>COPY ... PROGRAM</code> in PostgreSQL), and unused stored procedures increase the attack surface. Disable what you do not use.</p>
<p><strong>7. Insecure Transport</strong> - Unencrypted connections between application and database. TLS is non-negotiable in production.</p>
<h3 id="security-checklist">Security Checklist<a class="headerlink" href="#security-checklist" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Check</th>
<th>MySQL</th>
<th>PostgreSQL</th>
</tr>
</thead>
<tbody>
<tr>
<td>Strong auth plugin</td>
<td><code>caching_sha2_password</code></td>
<td><code>scram-sha-256</code></td>
</tr>
<tr>
<td>TLS enforced</td>
<td><code>require_secure_transport = ON</code></td>
<td><code>hostssl</code> + <code>hostnossl reject</code></td>
</tr>
<tr>
<td>No default/empty passwords</td>
<td>Check <code>mysql.user</code></td>
<td>Check <code>pg_hba.conf</code> for <code>trust</code></td>
</tr>
<tr>
<td>Least privilege accounts</td>
<td>Review <code>SHOW GRANTS</code></td>
<td>Review <code>\du</code> and <code>\dp</code></td>
</tr>
<tr>
<td>Audit logging</td>
<td>Enterprise Audit or general_log</td>
<td>pgAudit extension</td>
</tr>
<tr>
<td>Network restricted</td>
<td><code>bind-address</code> + firewall</td>
<td><code>listen_addresses</code> + firewall</td>
</tr>
<tr>
<td>Backups encrypted</td>
<td>Encrypt dump files</td>
<td>Encrypt dump files</td>
</tr>
<tr>
<td>Patches current</td>
<td><code>SELECT VERSION()</code></td>
<td><code>SELECT version()</code></td>
</tr>
<tr>
<td>File loading disabled</td>
<td><code>local_infile = OFF</code></td>
<td>Restrict <code>COPY ... PROGRAM</code></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="exercises">Exercises<a class="headerlink" href="#exercises" title="Permanent link">&para;</a></h2>
<div class="interactive-exercise" data-config="{&quot;title&quot;: &quot;Database Security Audit&quot;, &quot;difficulty&quot;: &quot;intermediate&quot;, &quot;scenario&quot;: &quot;You have inherited a PostgreSQL 15 database server that has been running in production for two years with minimal security review. Perform a security audit by checking and fixing each of these areas:\n\n1. Check the authentication methods in pg_hba.conf - identify any entries using &#39;trust&#39; or &#39;md5&#39;\n2. Verify that TLS is enabled and enforced for all remote connections\n3. Review all database roles - identify accounts with SUPERUSER or CREATEDB privileges that should not have them\n4. Check if the public schema has default access revoked\n5. Verify pgAudit is installed and configured to log DDL and role changes\n6. Check that the database is not listening on all interfaces (0.0.0.0)\n7. Write the remediation SQL/config for each issue found\n&quot;, &quot;hints&quot;: [&quot;Check pg_hba.conf for &#39;trust&#39; and &#39;md5&#39; entries - replace with &#39;scram-sha-256&#39;&quot;, &quot;Run SELECT rolname, rolsuper, rolcreatedb, rolcreaterole FROM pg_roles to review privileges&quot;, &quot;Check listen_addresses in postgresql.conf - it should be a specific IP, not &#39;*&#39; or &#39;0.0.0.0&#39;&quot;, &quot;Use REVOKE ALL ON SCHEMA public FROM PUBLIC to remove default access&quot;, &quot;Verify pgAudit: SELECT * FROM pg_available_extensions WHERE name = &#39;pgaudit&#39;&quot;], &quot;solution&quot;: &quot;```sql\n-- Step 1: Fix authentication methods\n-- In pg_hba.conf, change:\n--   host all all 0.0.0.0/0 trust      -->  DELETE this line\n--   host all all 10.0.0.0/24 md5       -->  hostssl all all 10.0.0.0/24 scram-sha-256\n-- Ensure password_encryption = scram-sha-256 in postgresql.conf\n\n-- Step 2: Verify TLS\n-- In postgresql.conf:\n--   ssl = on\n--   ssl_cert_file = &#39;/etc/postgresql/ssl/server-cert.pem&#39;\n--   ssl_key_file = &#39;/etc/postgresql/ssl/server-key.pem&#39;\n--   ssl_min_protocol_version = &#39;TLSv1.2&#39;\n-- In pg_hba.conf, use hostssl instead of host\n\n-- Step 3: Review and fix roles\nSELECT rolname, rolsuper, rolcreatedb, rolcreaterole\nFROM pg_roles WHERE rolsuper OR rolcreatedb OR rolcreaterole;\n-- Remove unnecessary privileges:\nALTER ROLE app_user NOSUPERUSER NOCREATEDB NOCREATEROLE;\nALTER ROLE backup_user NOSUPERUSER NOCREATEDB;\n\n-- Step 4: Revoke public schema access\nREVOKE ALL ON SCHEMA public FROM PUBLIC;\nREVOKE ALL ON ALL TABLES IN SCHEMA public FROM PUBLIC;\n-- Then grant explicitly to roles that need it:\nGRANT USAGE ON SCHEMA public TO app_read;\nGRANT USAGE ON SCHEMA public TO app_write;\n\n-- Step 5: Enable pgAudit\n-- In postgresql.conf:\n--   shared_preload_libraries = &#39;pgaudit&#39;\n--   pgaudit.log = &#39;ddl, role&#39;\nCREATE EXTENSION IF NOT EXISTS pgaudit;\n\n-- Step 6: Restrict listen address\n-- In postgresql.conf:\n--   listen_addresses = &#39;10.0.0.5&#39;   -- specific internal IP\n-- NOT: listen_addresses = &#39;*&#39;\n\n-- Step 7: Reload configuration\nSELECT pg_reload_conf();\n```&quot;}"><noscript><p><strong>Database Security Audit</strong> (requires JavaScript)</p></noscript></div>
<hr />
<h2 id="further-reading">Further Reading<a class="headerlink" href="#further-reading" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://dev.mysql.com/doc/refman/8.0/en/security.html">MySQL Security Guide</a> - official MySQL security documentation covering authentication, encryption, and access control</li>
<li><a href="https://www.postgresql.org/docs/current/auth-pg-hba-conf.html">PostgreSQL Client Authentication (pg_hba.conf)</a> - comprehensive reference for PostgreSQL authentication configuration</li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">OWASP SQL Injection Prevention Cheat Sheet</a> - parameterized query patterns for every major language</li>
<li><a href="https://www.pgaudit.org/">pgAudit Documentation</a> - PostgreSQL audit logging extension setup and configuration</li>
<li><a href="https://www.cisecurity.org/benchmark">CIS Benchmarks for MySQL and PostgreSQL</a> - industry-standard hardening checklists from the Center for Internet Security</li>
</ul>
<hr />
<p><strong>Previous:</strong> <a href="../backup-and-recovery/">Backup &amp; Recovery Strategies</a> | <strong>Next:</strong> <a href="../scaling-and-architecture/">Scaling &amp; Architecture Patterns</a> | <a href="../">Back to Index</a></p>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback! Help us improve by <a href="https://github.com/ringo380/guides/issues/new?template=content-improvement.yml&title=[Feedback]+Database%20Security" target="_blank" rel="noopener">opening an issue</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>

<!-- SPDX-License-Identifier: MIT | Copyright (c) 2025-2026 Robworks Software LLC -->
<!-- Giscus comments - GitHub Discussions-backed -->

  <h2 id="__comments">Comments</h2>

  <script
    src="https://giscus.app/client.js"
    data-repo="ringo380/guides"
    data-repo-id="R_kgDOM3QMrQ"
    data-category="General"
    data-category-id="DIC_kwDOM3QMrc4C2qV9"
    data-mapping="pathname"
    data-strict="1"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>

                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025-2026 Robworks Software LLC
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ringo380" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/robworks" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://bsky.app/profile/lessoncraft.bsky.social" target="_blank" rel="noopener" title="bsky.app" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M407.8 294.7c-3.3-.4-6.7-.8-10-1.3 3.4.4 6.7.9 10 1.3M288 227.1c-26.1-50.7-97.1-145.2-163.1-191.8C61.6-9.4 37.5-1.7 21.6 5.5 3.3 13.8 0 41.9 0 58.4S9.1 194 15 213.9c19.5 65.7 89.1 87.9 153.2 80.7 3.3-.5 6.6-.9 10-1.4-3.3.5-6.6 1-10 1.4-93.9 14-177.3 48.2-67.9 169.9C220.6 589.1 265.1 437.8 288 361.1c22.9 76.7 49.2 222.5 185.6 103.4 102.4-103.4 28.1-156-65.8-169.9-3.3-.4-6.7-.8-10-1.3 3.4.4 6.7.9 10 1.3 64.1 7.1 133.6-15.1 153.2-80.7C566.9 194 576 75 576 58.4s-3.3-44.7-21.6-52.9c-15.8-7.1-40-14.9-103.2 29.8C385.1 81.9 314.1 176.4 288 227.1"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://mastodon.social/@runbook" target="_blank" rel="noopener me" title="mastodon.social" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M433 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54-.6-4.6-.9-9.3-.9-13.9 85.6 20.9 158.7 9.1 178.7 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6V190.1c0-49.7-64-51.6-64 6.9v62.5H201V197c0-58.5-64-56.6-64-6.9v114.2H90.3c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://threads.net/@robworks_software" target="_blank" rel="noopener" title="threads.net" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M331.5 235.7c2.2.9 4.2 1.9 6.3 2.8 29.2 14.1 50.6 35.2 61.8 61.4 15.7 36.5 17.2 95.8-30.3 143.2-36.2 36.2-80.3 52.5-142.6 53h-.3c-70.2-.5-124.1-24.1-160.4-70.2-32.3-41-48.9-98.1-49.5-169.6v-.5c.5-71.5 17.1-128.6 49.4-169.6 36.3-46.1 90.3-69.7 160.5-70.2h.3c70.3.5 124.9 24 162.3 69.9 18.4 22.7 32 50 40.6 81.7l-40.4 10.8c-7.1-25.8-17.8-47.8-32.2-65.4-29.2-35.8-73-54.2-130.5-54.6-57 .5-100.1 18.8-128.2 54.4C72.1 146.1 58.5 194.3 58 256c.5 61.7 14.1 109.9 40.3 143.3 28 35.6 71.2 53.9 128.2 54.4 51.4-.4 85.4-12.6 113.7-40.9 32.3-32.2 31.7-71.8 21.4-95.9-6.1-14.2-17.1-26-31.9-34.9-3.7 26.9-11.8 48.3-24.7 64.8-17.1 21.8-41.4 33.6-72.7 35.3-23.6 1.3-46.3-4.4-63.9-16-20.8-13.8-33-34.8-34.3-59.3-2.5-48.3 35.7-83 95.2-86.4 21.1-1.2 40.9-.3 59.2 2.8-2.4-14.8-7.3-26.6-14.6-35.2-10-11.7-25.6-17.7-46.2-17.8h-.7c-16.6 0-39 4.6-53.3 26.3l-34.4-23.6c19.2-29.1 50.3-45.1 87.8-45.1h.8c62.6.4 99.9 39.5 103.7 107.7l-.2.2zm-156 68.8c1.3 25.1 28.4 36.8 54.6 35.3 25.6-1.4 54.6-11.4 59.5-73.2-13.2-2.9-27.8-4.4-43.4-4.4-4.8 0-9.6.1-14.4.4-42.9 2.4-57.2 23.2-56.2 41.8z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



  

<h4>Cookie consent</h4>
<p>We use cookies to recognize repeat visits and measure engagement with guides. With your consent, you help us improve the content.</p>
<input class="md-toggle" type="checkbox" id="__settings" checked>
<div class="md-consent__settings">
  <ul class="task-list">
    
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
      
        
  
  
    
    
      
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.top", "navigation.instant", "navigation.tracking", "navigation.indexes", "search.suggest", "search.highlight", "content.code.copy", "content.action.edit"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../assets/javascripts/interactive.js"></script>
      
        <script src="../../assets/javascripts/giscus-theme.js"></script>
      
        <script src="../../assets/javascripts/lightbox.js"></script>
      
        <script src="../../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>