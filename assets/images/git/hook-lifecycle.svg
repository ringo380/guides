<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 450 620" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <marker id="arrow-light" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="#9e9e9e"/>
    </marker>
    <marker id="arrow-dark" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 3.5 L 0 7 z" fill="#666"/>
    </marker>
  </defs>
  <style>
    .title { font-size: 11px; font-weight: 600; fill: #1a1a1a; }
    .label { font-size: 10px; fill: #555; }
    .code { font-size: 10px; fill: #1a1a1a; font-family: "SFMono-Regular", "Consolas", "Liberation Mono", monospace; }
    .box { fill: #f5f5f5; stroke: #ccc; stroke-width: 1; rx: 8; }
    .box-accent { fill: #f5f5f5; stroke: #009485; stroke-width: 1.5; rx: 8; }
    .box-abort { fill: #f5f5f5; stroke: #d32f2f; stroke-width: 1.5; rx: 8; }
    .diamond { fill: #f5f5f5; stroke: #ccc; stroke-width: 1; }
    .connector { stroke: #9e9e9e; stroke-width: 1.2; fill: none; marker-end: url(#arrow-light); }
    .connector-abort { stroke: #9e9e9e; stroke-width: 1; fill: none; stroke-dasharray: 4,3; marker-end: url(#arrow-light); }
    .heading { font-size: 13px; font-weight: 700; fill: #009485; }
    .abort-text { font-size: 10px; font-weight: 600; fill: #d32f2f; }

    @media (prefers-color-scheme: dark) {
      .title { fill: #e0e0e0; }
      .label { fill: #aaa; }
      .code { fill: #e0e0e0; }
      .box { fill: rgba(255,255,255,0.07); stroke: rgba(255,255,255,0.15); }
      .box-accent { fill: rgba(255,255,255,0.07); stroke: #4db6ac; }
      .box-abort { fill: rgba(255,255,255,0.07); stroke: #ef5350; }
      .diamond { fill: rgba(255,255,255,0.07); stroke: rgba(255,255,255,0.15); }
      .connector { stroke: #666; marker-end: url(#arrow-dark); }
      .connector-abort { stroke: #666; marker-end: url(#arrow-dark); }
      .heading { fill: #4db6ac; }
      .abort-text { fill: #ef5350; }
    }
  </style>

  <!-- Main heading -->
  <text x="170" y="22" text-anchor="middle" class="heading">Git Commit Hook Lifecycle</text>

  <!-- ===== LAYOUT =====
    Main flow center: x=170
    Abort branch center: x=370
    Vertical spacing: boxes ~34px tall, diamonds ~56px, gaps ~16-20px
  -->

  <!-- ===== Step 1: git commit (entry point, accent) ===== -->
  <rect x="110" y="40" width="120" height="34" class="box-accent"/>
  <text x="170" y="62" text-anchor="middle" class="code">git commit</text>

  <!-- Arrow down to pre-commit -->
  <line x1="170" y1="74" x2="170" y2="92" class="connector"/>

  <!-- ===== Step 2: pre-commit hook ===== -->
  <rect x="95" y="92" width="150" height="34" class="box"/>
  <text x="170" y="106" text-anchor="middle" class="label">Hook:</text>
  <text x="170" y="119" text-anchor="middle" class="code">pre-commit</text>

  <!-- Arrow down to diamond 1 -->
  <line x1="170" y1="126" x2="170" y2="146" class="connector"/>

  <!-- ===== Diamond 1: exits non-zero? ===== -->
  <polygon points="170,146 240,174 170,202 100,174" class="diamond"/>
  <text x="170" y="171" text-anchor="middle" class="label">exit</text>
  <text x="170" y="183" text-anchor="middle" class="label">non-zero?</text>

  <!-- YES branch right to Aborted -->
  <line x1="240" y1="174" x2="310" y2="174" class="connector-abort"/>
  <text x="268" y="167" text-anchor="middle" class="label">Yes</text>

  <!-- Aborted box 1 -->
  <rect x="310" y="158" width="90" height="32" class="box-abort"/>
  <text x="355" y="178" text-anchor="middle" class="abort-text">Aborted</text>

  <!-- NO branch down -->
  <line x1="170" y1="202" x2="170" y2="222" class="connector"/>
  <text x="158" y="215" text-anchor="end" class="label">No</text>

  <!-- ===== Step 3: prepare-commit-msg hook ===== -->
  <rect x="75" y="222" width="190" height="34" class="box"/>
  <text x="170" y="236" text-anchor="middle" class="label">Hook:</text>
  <text x="170" y="249" text-anchor="middle" class="code">prepare-commit-msg</text>

  <!-- Arrow down to editor -->
  <line x1="170" y1="256" x2="170" y2="276" class="connector"/>

  <!-- ===== Step 4: Editor opens / user edits / editor closes ===== -->
  <rect x="95" y="276" width="150" height="50" class="box"/>
  <text x="170" y="293" text-anchor="middle" class="title">Editor Opens</text>
  <text x="170" y="307" text-anchor="middle" class="label">User edits message</text>
  <text x="170" y="321" text-anchor="middle" class="title">Editor Closes</text>

  <!-- Arrow down to commit-msg -->
  <line x1="170" y1="326" x2="170" y2="346" class="connector"/>

  <!-- ===== Step 5: commit-msg hook ===== -->
  <rect x="95" y="346" width="150" height="34" class="box"/>
  <text x="170" y="360" text-anchor="middle" class="label">Hook:</text>
  <text x="170" y="373" text-anchor="middle" class="code">commit-msg</text>

  <!-- Arrow down to diamond 2 -->
  <line x1="170" y1="380" x2="170" y2="400" class="connector"/>

  <!-- ===== Diamond 2: exits non-zero? ===== -->
  <polygon points="170,400 240,428 170,456 100,428" class="diamond"/>
  <text x="170" y="425" text-anchor="middle" class="label">exit</text>
  <text x="170" y="437" text-anchor="middle" class="label">non-zero?</text>

  <!-- YES branch right to Aborted -->
  <line x1="240" y1="428" x2="310" y2="428" class="connector-abort"/>
  <text x="268" y="421" text-anchor="middle" class="label">Yes</text>

  <!-- Aborted box 2 -->
  <rect x="310" y="412" width="90" height="32" class="box-abort"/>
  <text x="355" y="432" text-anchor="middle" class="abort-text">Aborted</text>

  <!-- NO branch down -->
  <line x1="170" y1="456" x2="170" y2="476" class="connector"/>
  <text x="158" y="469" text-anchor="end" class="label">No</text>

  <!-- ===== Step 6: Commit created (accent) ===== -->
  <rect x="100" y="476" width="140" height="34" class="box-accent"/>
  <text x="170" y="498" text-anchor="middle" class="title">Commit Created</text>

  <!-- Arrow down to post-commit -->
  <line x1="170" y1="510" x2="170" y2="530" class="connector"/>

  <!-- ===== Step 7: post-commit hook ===== -->
  <rect x="95" y="530" width="150" height="34" class="box"/>
  <text x="170" y="544" text-anchor="middle" class="label">Hook:</text>
  <text x="170" y="557" text-anchor="middle" class="code">post-commit</text>

  <!-- Annotation: notification only -->
  <text x="170" y="580" text-anchor="middle" class="label">Notification only (cannot abort)</text>

  <!-- Legend line -->
  <line x1="30" y1="600" x2="420" y2="600" stroke="#ccc" stroke-width="0.5" stroke-dasharray="4,3"/>
  <text x="225" y="614" text-anchor="middle" class="label">Dashed arrows indicate abort paths on hook failure</text>
</svg>